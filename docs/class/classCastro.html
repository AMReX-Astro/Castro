

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Class Castro &mdash; Castro  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=2e394b92" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=eaa7b67c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class CoutRedirection" href="classCoutRedirection.html" />
    <link rel="prev" title="Class list" href="../classlist.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="../index.html" class="icon icon-home">
            Castro
              <img src="../_static/castro_logo_hot_200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="../class/classCastro.html">main</a> | <a href="../dev/class/classCastro.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Castro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mpi_plus_x.html">Running Options: CPUs and GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu.html">GPU Programming Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problem_setups.html">Distributed Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timestepping.html">Timestepping and Retries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_a_problem.html">Setting Up Your Own Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">Outputting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Castro reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hse.html">Hydrostatic Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EOS.html">Equation of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reactions.html">Reactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhd.html">MHD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diffusion.html">Thermal Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sponge.html">Sponge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ConvertCheckpoint.html">Checkpoint Embiggener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../self_consistent_field.html">Self-Consistent Field Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development Best Practices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../filelist.html">File list</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../classlist.html">Class list</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Class Castro</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46Castro"><code class="docutils literal notranslate"><span class="pre">Castro</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6CastroEv"><code class="docutils literal notranslate"><span class="pre">Castro()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6CastroERN5amrex3AmrEiRKN5amrex8GeometryERKN5amrex8BoxArrayERKN5amrex19DistributionMappingEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">Castro()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6CastroD0Ev"><code class="docutils literal notranslate"><span class="pre">~Castro()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6CastroERK6Castro"><code class="docutils literal notranslate"><span class="pre">Castro()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6CastroERR6Castro"><code class="docutils literal notranslate"><span class="pre">Castro()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6CastroaSERK6Castro"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6CastroaSERR6Castro"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro7restartERN5amrex3AmrER7istreamb"><code class="docutils literal notranslate"><span class="pre">restart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro23set_state_in_checkpointERN5amrex6VectorIiEE"><code class="docutils literal notranslate"><span class="pre">set_state_in_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro10checkPointERKNSt6stringERNSt7ostreamEN5amrex5VisMF3HowEb"><code class="docutils literal notranslate"><span class="pre">checkPoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK6Castro15thePlotFileTypeEv"><code class="docutils literal notranslate"><span class="pre">thePlotFileType()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro16setPlotVariablesEv"><code class="docutils literal notranslate"><span class="pre">setPlotVariables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13writePlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"><code class="docutils literal notranslate"><span class="pre">writePlotFile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18writeSmallPlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"><code class="docutils literal notranslate"><span class="pre">writeSmallPlotFile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14plotFileOutputERKNSt6stringER7ostreamN5amrex5VisMF3HowEKi"><code class="docutils literal notranslate"><span class="pre">plotFileOutput()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12writeJobInfoERKNSt6stringEKN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">writeJobInfo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro8initDataEv"><code class="docutils literal notranslate"><span class="pre">initData()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14init_particlesEv"><code class="docutils literal notranslate"><span class="pre">init_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18ParticleCheckPointERKNSt6stringE"><code class="docutils literal notranslate"><span class="pre">ParticleCheckPoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro16ParticlePlotFileERKNSt6stringE"><code class="docutils literal notranslate"><span class="pre">ParticlePlotFile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro19ParticlePostRestartERKNSt6stringE"><code class="docutils literal notranslate"><span class="pre">ParticlePostRestart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14ParticleDeriveERKNSt6stringEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">ParticleDerive()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18TimestampParticlesEi"><code class="docutils literal notranslate"><span class="pre">TimestampParticles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro17advance_particlesEiN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">advance_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12MAESTRO_initEv"><code class="docutils literal notranslate"><span class="pre">MAESTRO_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro4AreaEv"><code class="docutils literal notranslate"><span class="pre">Area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro4AreaEi"><code class="docutils literal notranslate"><span class="pre">Area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6VolumeEv"><code class="docutils literal notranslate"><span class="pre">Volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6FluxesEi"><code class="docutils literal notranslate"><span class="pre">Fluxes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12setTimeLevelEN5amrex4RealEN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">setTimeLevel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro4initERN5amrex8AmrLevelE"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro4initEv"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12okToContinueEv"><code class="docutils literal notranslate"><span class="pre">okToContinue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro7advanceEN5amrex4RealEN5amrex4RealEii"><code class="docutils literal notranslate"><span class="pre">advance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14do_advance_ctuEN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">do_advance_ctu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14do_advance_sdcEN5amrex4RealEN5amrex4RealEii"><code class="docutils literal notranslate"><span class="pre">do_advance_sdc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro19save_data_for_retryEv"><code class="docutils literal notranslate"><span class="pre">save_data_for_retry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro17retry_advance_ctuEN5amrex4RealERK14advance_status"><code class="docutils literal notranslate"><span class="pre">retry_advance_ctu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro20subcycle_advance_ctuEN5amrex4RealEN5amrex4RealEii"><code class="docutils literal notranslate"><span class="pre">subcycle_advance_ctu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18initialize_advanceEN5amrex4RealEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">initialize_advance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro16finalize_advanceEv"><code class="docutils literal notranslate"><span class="pre">finalize_advance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro21initialize_do_advanceEN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">initialize_do_advance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro19finalize_do_advanceEN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">finalize_do_advance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11estTimeStepEi"><code class="docutils literal notranslate"><span class="pre">estTimeStep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro15initialTimeStepEv"><code class="docutils literal notranslate"><span class="pre">initialTimeStep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro16computeInitialDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">computeInitialDt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12computeNewDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">computeNewDt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12allocOldDataEv"><code class="docutils literal notranslate"><span class="pre">allocOldData()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13removeOldDataEv"><code class="docutils literal notranslate"><span class="pre">removeOldData()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro21do_energy_diagnosticsEv"><code class="docutils literal notranslate"><span class="pre">do_energy_diagnostics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13post_timestepEi"><code class="docutils literal notranslate"><span class="pre">post_timestep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18postCoarseTimeStepEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">postCoarseTimeStep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11post_regridEii"><code class="docutils literal notranslate"><span class="pre">post_regrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12post_restartEv"><code class="docutils literal notranslate"><span class="pre">post_restart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro9post_initEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14scf_relaxationEv"><code class="docutils literal notranslate"><span class="pre">scf_relaxation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13do_hscf_solveEv"><code class="docutils literal notranslate"><span class="pre">do_hscf_solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18post_grown_restartEv"><code class="docutils literal notranslate"><span class="pre">post_grown_restart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro8errorEstERN5amrex11TagBoxArrayEiiN5amrex4RealEii"><code class="docutils literal notranslate"><span class="pre">errorEst()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro18apply_problem_tagsERN5amrex11TagBoxArrayEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">apply_problem_tags()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro26apply_tagging_restrictionsERN5amrex11TagBoxArrayEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">apply_tagging_restrictions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">derive()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealERN5amrex8MultiFabEi"><code class="docutils literal notranslate"><span class="pre">derive()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro20final_radiation_callERN5amrex8MultiFabEii"><code class="docutils literal notranslate"><span class="pre">final_radiation_call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro21reset_internal_energyERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEi"><code class="docutils literal notranslate"><span class="pre">reset_internal_energy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11check_div_BERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">check_div_B()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11computeTempERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">computeTemp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro23create_source_correctorEv"><code class="docutils literal notranslate"><span class="pre">create_source_corrector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro22swap_state_time_levelsEKN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">swap_state_time_levels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro9volWgtSumERK8MultiFabibb"><code class="docutils literal notranslate"><span class="pre">volWgtSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro9volWgtSumERKNSt6stringEN5amrex4RealEbb"><code class="docutils literal notranslate"><span class="pre">volWgtSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro9locWgtSumERK8MultiFabiib"><code class="docutils literal notranslate"><span class="pre">locWgtSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro9locWgtSumERKNSt6stringEN5amrex4RealEib"><code class="docutils literal notranslate"><span class="pre">locWgtSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13volProductSumERK8MultiFabRK8MultiFabiib"><code class="docutils literal notranslate"><span class="pre">volProductSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13volProductSumERKNSt6stringERKNSt6stringEN5amrex4RealEb"><code class="docutils literal notranslate"><span class="pre">volProductSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13locSquaredSumERKNSt6stringEN5amrex4RealEib"><code class="docutils literal notranslate"><span class="pre">locSquaredSum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro8gwstrainE4RealR4RealR4RealR4RealR4RealR4RealR4Realb"><code class="docutils literal notranslate"><span class="pre">gwstrain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro12expand_stateERN5amrex8MultiFabEN5amrex4RealEi"><code class="docutils literal notranslate"><span class="pre">expand_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro8getLevelEi"><code class="docutils literal notranslate"><span class="pre">getLevel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro15FluxRegCrseInitEv"><code class="docutils literal notranslate"><span class="pre">FluxRegCrseInit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14FluxRegFineAddEv"><code class="docutils literal notranslate"><span class="pre">FluxRegFineAdd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro6refluxEiib"><code class="docutils literal notranslate"><span class="pre">reflux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14writeBuildInfoEv"><code class="docutils literal notranslate"><span class="pre">writeBuildInfo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13variableSetUpEv"><code class="docutils literal notranslate"><span class="pre">variableSetUp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro10ErrorSetUpEv"><code class="docutils literal notranslate"><span class="pre">ErrorSetUp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro15variableCleanUpEv"><code class="docutils literal notranslate"><span class="pre">variableCleanUp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro20read_particle_paramsEv"><code class="docutils literal notranslate"><span class="pre">read_particle_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro13check_for_nanERKN5amrex8MultiFabEi"><code class="docutils literal notranslate"><span class="pre">check_for_nan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro23problem_post_simulationERN5amrex6VectorINSt10unique_ptrI8AmrLevelEEEE"><code class="docutils literal notranslate"><span class="pre">problem_post_simulation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro21reset_internal_energyERKN5amrex3BoxEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEE"><code class="docutils literal notranslate"><span class="pre">reset_internal_energy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14add_magnetic_eERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">add_magnetic_e()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro16using_point_massEv"><code class="docutils literal notranslate"><span class="pre">using_point_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro14get_point_massEv"><code class="docutils literal notranslate"><span class="pre">get_point_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11extern_initEv"><code class="docutils literal notranslate"><span class="pre">extern_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro11read_paramsEv"><code class="docutils literal notranslate"><span class="pre">read_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N6Castro17normalize_speciesERN5amrex8MultiFabEi"><code class="docutils literal notranslate"><span class="pre">normalize_species()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="classCoutRedirection.html">Class CoutRedirection</a></li>
<li class="toctree-l2"><a class="reference internal" href="classDiffusion.html">Class Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="classGradPhiPhysBCFunct.html">Class GradPhiPhysBCFunct</a></li>
<li class="toctree-l2"><a class="reference internal" href="classGravity.html">Class Gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="classHypreABec.html">Class HypreABec</a></li>
<li class="toctree-l2"><a class="reference internal" href="classHypreExtMultiABec.html">Class HypreExtMultiABec</a></li>
<li class="toctree-l2"><a class="reference internal" href="classMGRadBndry.html">Class MGRadBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classMGRadBndryBld.html">Class MGRadBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classNGBndry.html">Class NGBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classNGBndryBld.html">Class NGBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadBndry.html">Class RadBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadBndryBld.html">Class RadBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadSolve.html">Class RadSolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadiation.html">Class Radiation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Castro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../classlist.html">Class list</a></li>
      <li class="breadcrumb-item active">Class Castro</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/class/classCastro.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="class-castro">
<h1>Class Castro<a class="headerlink" href="#class-castro" title="Link to this heading"></a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv46Castro">
<span id="_CPPv36Castro"></span><span id="_CPPv26Castro"></span><span id="Castro"></span><span class="target" id="classCastro"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Castro</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AmrLevel</span></span><a class="headerlink" href="#_CPPv46Castro" title="Link to this definition"></a><br /></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">AmrLevel</span></code>-derived class for hyperbolic conservation equations for stellar media </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6CastroEv">
<span id="_CPPv3N6Castro6CastroEv"></span><span id="_CPPv2N6Castro6CastroEv"></span><span id="Castro::Castro"></span><span class="target" id="classCastro_1a9c79680fab84078c27f994f3a38d7faf"></span><span class="sig-name descname"><span class="n"><span class="pre">Castro</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro6CastroEv" title="Link to this definition"></a><br /></dt>
<dd><p>Default constructor. Builds invalid object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6CastroERN5amrex3AmrEiRKN5amrex8GeometryERKN5amrex8BoxArrayERKN5amrex19DistributionMappingEN5amrex4RealE">
<span id="_CPPv3N6Castro6CastroERN5amrex3AmrEiRKN5amrex8GeometryERKN5amrex8BoxArrayERKN5amrex19DistributionMappingEN5amrex4RealE"></span><span id="_CPPv2N6Castro6CastroERN5amrex3AmrEiRKN5amrex8GeometryERKN5amrex8BoxArrayERKN5amrex19DistributionMappingEN5amrex4RealE"></span><span id="Castro::Castro__amrex::AmrR.i.amrex::GeometryCR.amrex::BoxArrayCR.amrex::DistributionMappingCR.amrex::Real"></span><span class="target" id="classCastro_1a0ddfa390331ac71027a24b4c2ae6c355"></span><span class="sig-name descname"><span class="n"><span class="pre">Castro</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Amr</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">papa</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Geometry</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">level_geom</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BoxArray</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bl</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistributionMapping</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dm</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro6CastroERN5amrex3AmrEiRKN5amrex8GeometryERKN5amrex8BoxArrayERKN5amrex19DistributionMappingEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>The basic constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>papa</strong> – parent <code class="docutils literal notranslate"><span class="pre">amrex::Amr</span></code> object </p></li>
<li><p><strong>lev</strong> – which level are we on </p></li>
<li><p><strong>level_geom</strong> – level geometry </p></li>
<li><p><strong>bl</strong> – <code class="docutils literal notranslate"><span class="pre">BoxArray</span></code> object </p></li>
<li><p><strong>dm</strong> – the mapping </p></li>
<li><p><strong>time</strong> – current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6CastroD0Ev">
<span id="_CPPv3N6CastroD0Ev"></span><span id="_CPPv2N6CastroD0Ev"></span><span id="Castro::~Castro"></span><span class="target" id="classCastro_1a19ae65fcb340bcd110779b202466f8d5"></span><span class="sig-name descname"><span class="n"><span class="pre">~Castro</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6CastroD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>The destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6CastroERK6Castro">
<span id="_CPPv3N6Castro6CastroERK6Castro"></span><span id="_CPPv2N6Castro6CastroERK6Castro"></span><span id="Castro::Castro__CastroCR"></span><span class="target" id="classCastro_1ad73aa57d12384d7e62c6ab1ceff6ee18"></span><span class="sig-name descname"><span class="n"><span class="pre">Castro</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N6Castro6CastroERK6Castro" title="Castro::Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N6Castro6CastroERK6Castro" title="Link to this definition"></a><br /></dt>
<dd><p>Remove copy/move constructors/assignment operators. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6CastroERR6Castro">
<span id="_CPPv3N6Castro6CastroERR6Castro"></span><span id="_CPPv2N6Castro6CastroERR6Castro"></span><span id="Castro::Castro__CastroRR"></span><span class="target" id="classCastro_1a4880d1de0d68f1e4325e25965c8a4a0d"></span><span class="sig-name descname"><span class="n"><span class="pre">Castro</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N6Castro6CastroERR6Castro" title="Castro::Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N6Castro6CastroERR6Castro" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6CastroaSERK6Castro">
<span id="_CPPv3N6CastroaSERK6Castro"></span><span id="_CPPv2N6CastroaSERK6Castro"></span><span id="Castro::assign-operator__CastroCR"></span><span class="target" id="classCastro_1a185cab98b2824199d134de5edd3c3eec"></span><a class="reference internal" href="#_CPPv46Castro" title="Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv46Castro" title="Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N6CastroaSERK6Castro" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6CastroaSERR6Castro">
<span id="_CPPv3N6CastroaSERR6Castro"></span><span id="_CPPv2N6CastroaSERR6Castro"></span><span id="Castro::assign-operator__CastroRR"></span><span class="target" id="classCastro_1a731ed08e95d52d23f012c3846a3a02e8"></span><a class="reference internal" href="#_CPPv46Castro" title="Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv46Castro" title="Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N6CastroaSERR6Castro" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro7restartERN5amrex3AmrER7istreamb">
<span id="_CPPv3N6Castro7restartERN5amrex3AmrER7istreamb"></span><span id="_CPPv2N6Castro7restartERN5amrex3AmrER7istreamb"></span><span id="Castro::restart__amrex::AmrR.istreamR.b"></span><span class="target" id="classCastro_1afde904ee263a01f9002f6e84c63c1ed9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">restart</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Amr</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">papa</span></span>, <span class="n"><span class="pre">istream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">is</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bReadSpecial</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro7restartERN5amrex3AmrER7istreamb" title="Link to this definition"></a><br /></dt>
<dd><p>Restart from a checkpoint file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>papa</strong> – parent <code class="docutils literal notranslate"><span class="pre">amrex::Amr</span></code> object </p></li>
<li><p><strong>is</strong> – </p></li>
<li><p><strong>bReadSpecial</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro23set_state_in_checkpointERN5amrex6VectorIiEE">
<span id="_CPPv3N6Castro23set_state_in_checkpointERN5amrex6VectorIiEE"></span><span id="_CPPv2N6Castro23set_state_in_checkpointERN5amrex6VectorIiEE"></span><span id="Castro::set_state_in_checkpoint__amrex::Vector:i:R"></span><span class="target" id="classCastro_1a8db63ed0233c1af47be942416ecfe088"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_state_in_checkpoint</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state_in_checkpoint</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro23set_state_in_checkpointERN5amrex6VectorIiEE" title="Link to this definition"></a><br /></dt>
<dd><p>This is called only when we restart from an old checkpoint. Sets the Vector <code class="docutils literal notranslate"><span class="pre">state_in_checkpoint</span></code> depending on the input version and type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_in_checkpoint</strong> – Vector of integer flags describing the state </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro10checkPointERKNSt6stringERNSt7ostreamEN5amrex5VisMF3HowEb">
<span id="_CPPv3N6Castro10checkPointERKNSt6stringERNSt7ostreamEN5amrex5VisMF3HowEb"></span><span id="_CPPv2N6Castro10checkPointERKNSt6stringERNSt7ostreamEN5amrex5VisMF3HowEb"></span><span id="Castro::checkPoint__ssCR.osR.amrex::VisMF::How.b"></span><span class="target" id="classCastro_1a6bc36cdc28c5258ed83719bd7efcf6b5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">checkPoint</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ostream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">os</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VisMF</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">How</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">how</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dump_old</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro10checkPointERKNSt6stringERNSt7ostreamEN5amrex5VisMF3HowEb" title="Link to this definition"></a><br /></dt>
<dd><p>Call <code class="docutils literal notranslate"><span class="pre">amrex::AmrLevel::checkPoint</span></code> and then add radiation info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – Directory to store checkpoint in </p></li>
<li><p><strong>os</strong> – <code class="docutils literal notranslate"><span class="pre">std::ostream</span></code> object </p></li>
<li><p><strong>how</strong> – <code class="docutils literal notranslate"><span class="pre">V</span></code>isMF::How`` object </p></li>
<li><p><strong>dump_old</strong> – boolean </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK6Castro15thePlotFileTypeEv">
<span id="_CPPv3NK6Castro15thePlotFileTypeEv"></span><span id="_CPPv2NK6Castro15thePlotFileTypeEv"></span><span id="Castro::thePlotFileTypeC"></span><span class="target" id="classCastro_1a769c30ac59fb6f1a00c4efc1fc05d5d4"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">thePlotFileType</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4NK6Castro15thePlotFileTypeEv" title="Link to this definition"></a><br /></dt>
<dd><p>A string written as the first item in <a class="reference internal" href="../file/Castro_8H.html#classCastro_1aa7b2a3c525a91df0f291ffcfc8f93187"><span class="std std-ref">writePlotFile()</span></a> at level zero. It is so we can distinguish between different types of plot files. For <a class="reference internal" href="../file/Castro_8H.html#classCastro"><span class="std std-ref">Castro</span></a> it has the form: Castro-Vnnn </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro16setPlotVariablesEv">
<span id="_CPPv3N6Castro16setPlotVariablesEv"></span><span id="_CPPv2N6Castro16setPlotVariablesEv"></span><span id="Castro::setPlotVariables"></span><span class="target" id="classCastro_1ac49a49a0889275327fbd0b7644a55191"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setPlotVariables</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro16setPlotVariablesEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13writePlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE">
<span id="_CPPv3N6Castro13writePlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"></span><span id="_CPPv2N6Castro13writePlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"></span><span id="Castro::writePlotFile__ssCR.ostreamR.amrex::VisMF::How"></span><span class="target" id="classCastro_1aa7b2a3c525a91df0f291ffcfc8f93187"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">writePlotFile</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span>, <span class="n"><span class="pre">ostream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">os</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VisMF</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">How</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">how</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro13writePlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE" title="Link to this definition"></a><br /></dt>
<dd><p>Write a plotfile to specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – directory to write to </p></li>
<li><p><strong>os</strong> – output stream </p></li>
<li><p><strong>how</strong> – <code class="docutils literal notranslate"><span class="pre">VisMF::How</span></code> object </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18writeSmallPlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE">
<span id="_CPPv3N6Castro18writeSmallPlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"></span><span id="_CPPv2N6Castro18writeSmallPlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE"></span><span id="Castro::writeSmallPlotFile__ssCR.ostreamR.amrex::VisMF::How"></span><span class="target" id="classCastro_1aae697270707d93cd5969f278fc25ef64"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">writeSmallPlotFile</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span>, <span class="n"><span class="pre">ostream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">os</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VisMF</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">How</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">how</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro18writeSmallPlotFileERKNSt6stringER7ostreamN5amrex5VisMF3HowE" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – directory to write to </p></li>
<li><p><strong>os</strong> – output stream </p></li>
<li><p><strong>how</strong> – <code class="docutils literal notranslate"><span class="pre">VisMF::How</span></code> object </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14plotFileOutputERKNSt6stringER7ostreamN5amrex5VisMF3HowEKi">
<span id="_CPPv3N6Castro14plotFileOutputERKNSt6stringER7ostreamN5amrex5VisMF3HowEKi"></span><span id="_CPPv2N6Castro14plotFileOutputERKNSt6stringER7ostreamN5amrex5VisMF3HowEKi"></span><span id="Castro::plotFileOutput__ssCR.ostreamR.amrex::VisMF::How.iC"></span><span class="target" id="classCastro_1a0c7bc93d065c0ffd095a044b81db3cc3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">plotFileOutput</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span>, <span class="n"><span class="pre">ostream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">os</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">VisMF</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">How</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">how</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_small</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14plotFileOutputERKNSt6stringER7ostreamN5amrex5VisMF3HowEKi" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – directory to write to </p></li>
<li><p><strong>os</strong> – output stream </p></li>
<li><p><strong>how</strong> – <code class="docutils literal notranslate"><span class="pre">VisMF::How</span></code> object </p></li>
<li><p><strong>is_small</strong> – integer </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12writeJobInfoERKNSt6stringEKN5amrex4RealE">
<span id="_CPPv3N6Castro12writeJobInfoERKNSt6stringEKN5amrex4RealE"></span><span id="_CPPv2N6Castro12writeJobInfoERKNSt6stringEKN5amrex4RealE"></span><span id="Castro::writeJobInfo__ssCR.amrex::RealC"></span><span class="target" id="classCastro_1aed4b6196e9088051822157ddfc93b9df"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">writeJobInfo</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">io_time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro12writeJobInfoERKNSt6stringEKN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Write job info to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – directory to write to </p></li>
<li><p><strong>io_time</strong> – how long it took to generate the plotfile/checkpoint </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro8initDataEv">
<span id="_CPPv3N6Castro8initDataEv"></span><span id="_CPPv2N6Castro8initDataEv"></span><span id="Castro::initData"></span><span class="target" id="classCastro_1abb9e19c34193cf5908fde9f8f236a744"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initData</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro8initDataEv" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize grid data at problem start-up. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14init_particlesEv">
<span id="_CPPv3N6Castro14init_particlesEv"></span><span id="_CPPv2N6Castro14init_particlesEv"></span><span id="Castro::init_particles"></span><span class="target" id="classCastro_1ae1c0509b2f86cb07813ce8929da25896"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init_particles</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14init_particlesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize particle locations and velocities (and strengths if relevant) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18ParticleCheckPointERKNSt6stringE">
<span id="_CPPv3N6Castro18ParticleCheckPointERKNSt6stringE"></span><span id="_CPPv2N6Castro18ParticleCheckPointERKNSt6stringE"></span><span id="Castro::ParticleCheckPoint__ssCR"></span><span class="target" id="classCastro_1a9a7c8ff9c5272577babefae593a88ed1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticleCheckPoint</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro18ParticleCheckPointERKNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Write particles in checkpoint directories</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir</strong> – directory containing checkpoint </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro16ParticlePlotFileERKNSt6stringE">
<span id="_CPPv3N6Castro16ParticlePlotFileERKNSt6stringE"></span><span id="_CPPv2N6Castro16ParticlePlotFileERKNSt6stringE"></span><span id="Castro::ParticlePlotFile__ssCR"></span><span class="target" id="classCastro_1ac32db039fb8fb1e7ceff249976151b08"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticlePlotFile</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dir</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro16ParticlePlotFileERKNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Write particles in plotfile directories</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir</strong> – directory containing plotfile </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro19ParticlePostRestartERKNSt6stringE">
<span id="_CPPv3N6Castro19ParticlePostRestartERKNSt6stringE"></span><span id="_CPPv2N6Castro19ParticlePostRestartERKNSt6stringE"></span><span id="Castro::ParticlePostRestart__ssCR"></span><span class="target" id="classCastro_1a3eca1a0a43c47cfe4074b0d6661a085b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticlePostRestart</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">restart_file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro19ParticlePostRestartERKNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>How to initialize at restart</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>restart_file</strong> – path to restart file </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14ParticleDeriveERKNSt6stringEN5amrex4RealEi">
<span id="_CPPv3N6Castro14ParticleDeriveERKNSt6stringEN5amrex4RealEi"></span><span id="_CPPv2N6Castro14ParticleDeriveERKNSt6stringEN5amrex4RealEi"></span><span id="Castro::ParticleDerive__ssCR.amrex::Real.i"></span><span class="target" id="classCastro_1a8dad8c8f334393aea22332fea513755a"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticleDerive</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ngrow</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14ParticleDeriveERKNSt6stringEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>Derived quantities associated with particles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of particle variable to derive </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>ngrow</strong> – Number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18TimestampParticlesEi">
<span id="_CPPv3N6Castro18TimestampParticlesEi"></span><span id="_CPPv2N6Castro18TimestampParticlesEi"></span><span id="Castro::TimestampParticles__i"></span><span class="target" id="classCastro_1a2a9ffc3d36d599a6379dcaca83faf5ef"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TimestampParticles</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ngrow</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro18TimestampParticlesEi" title="Link to this definition"></a><br /></dt>
<dd><p>Timestamp particles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ngrow</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro17advance_particlesEiN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3N6Castro17advance_particlesEiN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2N6Castro17advance_particlesEiN5amrex4RealEN5amrex4RealE"></span><span id="Castro::advance_particles__i.amrex::Real.amrex::Real"></span><span class="target" id="classCastro_1adfc90d281594ed7c1c24526140f8eb12"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advance_particles</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iteration</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro17advance_particlesEiN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Advance the particles by dt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> – where we are in the current AMR subcycle </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>dt</strong> – timestep </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12MAESTRO_initEv">
<span id="_CPPv3N6Castro12MAESTRO_initEv"></span><span id="_CPPv2N6Castro12MAESTRO_initEv"></span><span id="Castro::MAESTRO_init"></span><span class="target" id="classCastro_1add864ce973e24c9cdb1f053800ded054"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MAESTRO_init</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro12MAESTRO_initEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro4AreaEv">
<span id="_CPPv3N6Castro4AreaEv"></span><span id="_CPPv2N6Castro4AreaEv"></span><span id="Castro::Area"></span><span class="target" id="classCastro_1a0ac6658f07b263f451b254029a7326ef"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Area</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro4AreaEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro4AreaEi">
<span id="_CPPv3N6Castro4AreaEi"></span><span id="_CPPv2N6Castro4AreaEi"></span><span id="Castro::Area__i"></span><span class="target" id="classCastro_1a36b4d46ca4d7a043887118b8d2778592"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">Area</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dir</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro4AreaEi" title="Link to this definition"></a><br /></dt>
<dd><p>Area of the multifab with surface normal along <code class="docutils literal notranslate"><span class="pre">dir</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir</strong> – direction of normal </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6VolumeEv">
<span id="_CPPv3N6Castro6VolumeEv"></span><span id="_CPPv2N6Castro6VolumeEv"></span><span id="Castro::Volume"></span><span class="target" id="classCastro_1ad5c5bbeccb660d6295b99e2427e8ca33"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">Volume</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro6VolumeEv" title="Link to this definition"></a><br /></dt>
<dd><p>The volume of the multifab. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6FluxesEi">
<span id="_CPPv3N6Castro6FluxesEi"></span><span id="_CPPv2N6Castro6FluxesEi"></span><span id="Castro::Fluxes__i"></span><span class="target" id="classCastro_1a578a706edd83189a55c0e8546316dd3a"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">Fluxes</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dir</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro6FluxesEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return the n’th fluxes MultiFab.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir</strong> – direction in which to find the fluxes along </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12setTimeLevelEN5amrex4RealEN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3N6Castro12setTimeLevelEN5amrex4RealEN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2N6Castro12setTimeLevelEN5amrex4RealEN5amrex4RealEN5amrex4RealE"></span><span id="Castro::setTimeLevel__amrex::Real.amrex::Real.amrex::Real"></span><span class="target" id="classCastro_1a22a2bf2629a724dc536ef0a2c5ecfdeb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setTimeLevel</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt_old</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt_new</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro12setTimeLevelEN5amrex4RealEN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Set time levels of state data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>dt_old</strong> – old timestep </p></li>
<li><p><strong>dt_new</strong> – new timestep </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro4initERN5amrex8AmrLevelE">
<span id="_CPPv3N6Castro4initERN5amrex8AmrLevelE"></span><span id="_CPPv2N6Castro4initERN5amrex8AmrLevelE"></span><span id="Castro::init__amrex::AmrLevelR"></span><span class="target" id="classCastro_1a60cb24df0146cec7063d3bc24279bec4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AmrLevel</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">old</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro4initERN5amrex8AmrLevelE" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize data on this level from another <a class="reference internal" href="../file/Castro_8H.html#classCastro"><span class="std std-ref">Castro</span></a> (during regrid).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>old</strong> – amrex::AmrLevel object to use to initialize data </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro4initEv">
<span id="_CPPv3N6Castro4initEv"></span><span id="_CPPv2N6Castro4initEv"></span><span id="Castro::init"></span><span class="target" id="classCastro_1ac1ab7c06893489b1997870fb256c84db"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro4initEv" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize data on this level after regridding if old level did not previously exist </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12okToContinueEv">
<span id="_CPPv3N6Castro12okToContinueEv"></span><span id="_CPPv2N6Castro12okToContinueEv"></span><span id="Castro::okToContinue"></span><span class="target" id="classCastro_1a4a9162fb5358dca2fc77f190d64b346e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">okToContinue</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro12okToContinueEv" title="Link to this definition"></a><br /></dt>
<dd><p>Proceed with next timestep? </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro7advanceEN5amrex4RealEN5amrex4RealEii">
<span id="_CPPv3N6Castro7advanceEN5amrex4RealEN5amrex4RealEii"></span><span id="_CPPv2N6Castro7advanceEN5amrex4RealEN5amrex4RealEii"></span><span id="Castro::advance__amrex::Real.amrex::Real.i.i"></span><span class="target" id="classCastro_1a42222c0181eff340288ad9d395604fea"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iteration</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ncycle</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro7advanceEN5amrex4RealEN5amrex4RealEii" title="Link to this definition"></a><br /></dt>
<dd><p>Advance grids at this level in time.</p>
<p>The main driver for a single level. This will do either the SDC algorithm or the Strang-split reactions algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance (e.g., go from time to time + dt) </p></li>
<li><p><strong>iteration</strong> – where we are in the current AMR subcycle. Each level will take a number of steps to reach the final time of the coarser level below it. This counter starts at 1 </p></li>
<li><p><strong>ncycle</strong> – the number of subcycles at this level </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14do_advance_ctuEN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3N6Castro14do_advance_ctuEN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2N6Castro14do_advance_ctuEN5amrex4RealEN5amrex4RealE"></span><span id="Castro::do_advance_ctu__amrex::Real.amrex::Real"></span><span class="target" id="classCastro_1ab3633097a3989c3202b3d4ce396329a2"></span><a class="reference internal" href="../file/Castro_8H.html#_CPPv414advance_status" title="advance_status"><span class="n"><span class="pre">advance_status</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">do_advance_ctu</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14do_advance_ctuEN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>This routine will advance the old state data (called <code class="docutils literal notranslate"><span class="pre">S_old</span></code> here) to the new time, for a single level. The new data is called <code class="docutils literal notranslate"><span class="pre">S_new</span></code> here. The update includes reactions (if we are not doing SDC), hydro, and the source terms. The advance is doing using the CTU (corner transport upwind) approach. We also use this interface for the simplified SDC update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance (e.g., go from time to time + dt) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14do_advance_sdcEN5amrex4RealEN5amrex4RealEii">
<span id="_CPPv3N6Castro14do_advance_sdcEN5amrex4RealEN5amrex4RealEii"></span><span id="_CPPv2N6Castro14do_advance_sdcEN5amrex4RealEN5amrex4RealEii"></span><span id="Castro::do_advance_sdc__amrex::Real.amrex::Real.i.i"></span><span class="target" id="classCastro_1a4ed730068ad5f231af6fe2f6c2182c28"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">do_advance_sdc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">amr_iteration</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">amr_ncycle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14do_advance_sdcEN5amrex4RealEN5amrex4RealEii" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro19save_data_for_retryEv">
<span id="_CPPv3N6Castro19save_data_for_retryEv"></span><span id="_CPPv2N6Castro19save_data_for_retryEv"></span><span id="Castro::save_data_for_retry"></span><span class="target" id="classCastro_1ae5cb03c2c7288e91505c7e31c9a3f718"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">save_data_for_retry</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro19save_data_for_retryEv" title="Link to this definition"></a><br /></dt>
<dd><p>Save a copy of the old state data in case for the purposes of a retry. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro17retry_advance_ctuEN5amrex4RealERK14advance_status">
<span id="_CPPv3N6Castro17retry_advance_ctuEN5amrex4RealERK14advance_status"></span><span id="_CPPv2N6Castro17retry_advance_ctuEN5amrex4RealERK14advance_status"></span><span id="Castro::retry_advance_ctu__amrex::Real.advance_statusCR"></span><span class="target" id="classCastro_1ae2763d07faed7894685323e6075e8b15"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">retry_advance_ctu</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro_8H.html#_CPPv414advance_status" title="advance_status"><span class="n"><span class="pre">advance_status</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">status</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro17retry_advance_ctuEN5amrex4RealERK14advance_status" title="Link to this definition"></a><br /></dt>
<dd><p>Should we retry advancing the simulation? By default, we don’t do a retry unless the criteria are violated. This is used only for the CTU advance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – the timestep to advance (e.g., go from time to time + dt) </p></li>
<li><p><strong>advance_status</strong> – was the advance successful? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro20subcycle_advance_ctuEN5amrex4RealEN5amrex4RealEii">
<span id="_CPPv3N6Castro20subcycle_advance_ctuEN5amrex4RealEN5amrex4RealEii"></span><span id="_CPPv2N6Castro20subcycle_advance_ctuEN5amrex4RealEN5amrex4RealEii"></span><span id="Castro::subcycle_advance_ctu__amrex::Real.amrex::Real.i.i"></span><span class="target" id="classCastro_1a6877c202696435c2a51d99b9ff40f759"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">subcycle_advance_ctu</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">amr_iteration</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">amr_ncycle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro20subcycle_advance_ctuEN5amrex4RealEN5amrex4RealEii" title="Link to this definition"></a><br /></dt>
<dd><p>Subcyles until we’ve reached the target time, <code class="docutils literal notranslate"><span class="pre">time</span></code> + <code class="docutils literal notranslate"><span class="pre">dt</span></code>. The last timestep will be shortened if needed so that it does not overshoot the ending time. This is used only for the CTU advance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance (e.g., go from time to time + dt) </p></li>
<li><p><strong>amr_iteration</strong> – where we are in the current AMR subcycle. Each level will take a number of steps to reach the final time of the coarser level below it. This counter starts at 1 </p></li>
<li><p><strong>amr_ncycle</strong> – the number of subcycles at this level </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18initialize_advanceEN5amrex4RealEN5amrex4RealEi">
<span id="_CPPv3N6Castro18initialize_advanceEN5amrex4RealEN5amrex4RealEi"></span><span id="_CPPv2N6Castro18initialize_advanceEN5amrex4RealEN5amrex4RealEi"></span><span id="Castro::initialize_advance__amrex::Real.amrex::Real.i"></span><span class="target" id="classCastro_1af5b32de68efc13eb2cae542c40e08842"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialize_advance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">amr_iteration</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro18initialize_advanceEN5amrex4RealEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>This is run at the start of an <a class="reference internal" href="../file/Castro_8H.html#classCastro_1a42222c0181eff340288ad9d395604fea"><span class="std std-ref">advance</span></a> on a single level. It sets up all the necessary arrays and data containers, ensures the data is valid and makes copies of the MultiFabs in the old and new state in case a retry is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance (e.g., go from time to time + dt) </p></li>
<li><p><strong>amr_iteration</strong> – where we are in the current AMR subcycle. Each level will take a number of steps to reach the final time of the coarser level below it. This counter starts at 1 </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro16finalize_advanceEv">
<span id="_CPPv3N6Castro16finalize_advanceEv"></span><span id="_CPPv2N6Castro16finalize_advanceEv"></span><span id="Castro::finalize_advance"></span><span class="target" id="classCastro_1a68e6a604b5072e6349871d78b9dca1e8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_advance</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro16finalize_advanceEv" title="Link to this definition"></a><br /></dt>
<dd><p>If required, adds material lost in timestep to cumulative losses, does refluxing, and clears arrays/data containers initialized at start of the level’s advance. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro21initialize_do_advanceEN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3N6Castro21initialize_do_advanceEN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2N6Castro21initialize_do_advanceEN5amrex4RealEN5amrex4RealE"></span><span id="Castro::initialize_do_advance__amrex::Real.amrex::Real"></span><span class="target" id="classCastro_1aa9b48fa4f075e47272d11c0a582389fd"></span><a class="reference internal" href="../file/Castro_8H.html#_CPPv414advance_status" title="advance_status"><span class="n"><span class="pre">advance_status</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialize_do_advance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro21initialize_do_advanceEN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Performed at the start of ::do_advance, resets flags and ensures required ghost zones are filled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro19finalize_do_advanceEN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3N6Castro19finalize_do_advanceEN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2N6Castro19finalize_do_advanceEN5amrex4RealEN5amrex4RealE"></span><span id="Castro::finalize_do_advance__amrex::Real.amrex::Real"></span><span class="target" id="classCastro_1a82910bbd5632a06ce1402e19ec841cd9"></span><a class="reference internal" href="../file/Castro_8H.html#_CPPv414advance_status" title="advance_status"><span class="n"><span class="pre">advance_status</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_do_advance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro19finalize_do_advanceEN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Performed at the end of ::do_advance, cleans up temporary data created by <a class="reference internal" href="../file/Castro_8H.html#classCastro_1aa9b48fa4f075e47272d11c0a582389fd"><span class="std std-ref">initialize_do_advance</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – the current simulation time </p></li>
<li><p><strong>dt</strong> – the timestep to advance </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11estTimeStepEi">
<span id="_CPPv3N6Castro11estTimeStepEi"></span><span id="_CPPv2N6Castro11estTimeStepEi"></span><span id="Castro::estTimeStep__i"></span><span class="target" id="classCastro_1a508a9e48dca962b5b06652afd2a1cfcc"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">estTimeStep</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_new</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro11estTimeStepEi" title="Link to this definition"></a><br /></dt>
<dd><p>Estimate time step. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro15initialTimeStepEv">
<span id="_CPPv3N6Castro15initialTimeStepEv"></span><span id="_CPPv2N6Castro15initialTimeStepEv"></span><span id="Castro::initialTimeStep"></span><span class="target" id="classCastro_1a5d36e2b7ae6b1d853ffb2bdb51dc026c"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialTimeStep</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro15initialTimeStepEv" title="Link to this definition"></a><br /></dt>
<dd><p>Compute initial time step. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro16computeInitialDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealE">
<span id="_CPPv3N6Castro16computeInitialDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealE"></span><span id="_CPPv2N6Castro16computeInitialDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealE"></span><span id="Castro::computeInitialDt__i.i.amrex::Vector:i:R.amrex::Vector:amrex::IntVect:CR.amrex::Vector:amrex::Real:R.amrex::Real"></span><span class="target" id="classCastro_1a77f71b20dd1bf977a183ae8d203c851c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">computeInitialDt</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finest_level</span></span>, <span class="kt"><span class="pre">int</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">n_cycle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">IntVect</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dt_level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stop_time</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro16computeInitialDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute initial <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>finest_level</strong> – Index of finest level </p></li>
<li><p><strong>subcycle</strong> – unused </p></li>
<li><p><strong>n_cycle</strong> – the number of subcycles at this level </p></li>
<li><p><strong>ref_ratio</strong> – unused </p></li>
<li><p><strong>dt_level</strong> – Real Vector, will contain initial timestep at each level. </p></li>
<li><p><strong>stop_time</strong> – End time of simulation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12computeNewDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealEi">
<span id="_CPPv3N6Castro12computeNewDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealEi"></span><span id="_CPPv2N6Castro12computeNewDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealEi"></span><span id="Castro::computeNewDt__i.i.amrex::Vector:i:R.amrex::Vector:amrex::IntVect:CR.amrex::Vector:amrex::Real:R.amrex::Vector:amrex::Real:R.amrex::Real.i"></span><span class="target" id="classCastro_1a5176cd062384c8a87edbc8e9c13d2402"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">computeNewDt</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finest_level</span></span>, <span class="kt"><span class="pre">int</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">n_cycle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">IntVect</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dt_min</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dt_level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stop_time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">post_regrid_flag</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro12computeNewDtEiiRN5amrex6VectorIiEERKN5amrex6VectorIN5amrex7IntVectEEERN5amrex6VectorIN5amrex4RealEEERN5amrex6VectorIN5amrex4RealEEEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>Compute new <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>finest_level</strong> – Index of finest level </p></li>
<li><p><strong>subcycle</strong> – unused </p></li>
<li><p><strong>n_cycle</strong> – the number of subcycles at this level </p></li>
<li><p><strong>ref_ratio</strong> – unused </p></li>
<li><p><strong>dt_min</strong> – </p></li>
<li><p><strong>dt_level</strong> – </p></li>
<li><p><strong>stop_time</strong> – End time of simulation </p></li>
<li><p><strong>post_regrid_flag</strong> – Have we done regridding yet? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12allocOldDataEv">
<span id="_CPPv3N6Castro12allocOldDataEv"></span><span id="_CPPv2N6Castro12allocOldDataEv"></span><span id="Castro::allocOldData"></span><span class="target" id="classCastro_1a8ef4ee7c4347ce493def85f9f329e535"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocOldData</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro12allocOldDataEv" title="Link to this definition"></a><br /></dt>
<dd><p>Allocate data at old time. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13removeOldDataEv">
<span id="_CPPv3N6Castro13removeOldDataEv"></span><span id="_CPPv2N6Castro13removeOldDataEv"></span><span id="Castro::removeOldData"></span><span class="target" id="classCastro_1add24063a8853f1ed22d387e489dc8822"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">removeOldData</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro13removeOldDataEv" title="Link to this definition"></a><br /></dt>
<dd><p>Remove data at old time. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro21do_energy_diagnosticsEv">
<span id="_CPPv3N6Castro21do_energy_diagnosticsEv"></span><span id="_CPPv2N6Castro21do_energy_diagnosticsEv"></span><span id="Castro::do_energy_diagnostics"></span><span class="target" id="classCastro_1a27707c673946e5b5d00991bca9df8e45"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">do_energy_diagnostics</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro21do_energy_diagnosticsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Print information about energy budget. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13post_timestepEi">
<span id="_CPPv3N6Castro13post_timestepEi"></span><span id="_CPPv2N6Castro13post_timestepEi"></span><span id="Castro::post_timestep__i"></span><span class="target" id="classCastro_1ab6e57e80f78797b8322bbf86f65ed91d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">post_timestep</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iteration</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro13post_timestepEi" title="Link to this definition"></a><br /></dt>
<dd><p>Do work after timestep().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iteration</strong> – where we are in the current AMR subcycle </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18postCoarseTimeStepEN5amrex4RealE">
<span id="_CPPv3N6Castro18postCoarseTimeStepEN5amrex4RealE"></span><span id="_CPPv2N6Castro18postCoarseTimeStepEN5amrex4RealE"></span><span id="Castro::postCoarseTimeStep__amrex::Real"></span><span class="target" id="classCastro_1a508c30494a96b6d53370dba3833972d3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">postCoarseTimeStep</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cumtime</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro18postCoarseTimeStepEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Contains operations to be done only after a full coarse timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cumtime</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11post_regridEii">
<span id="_CPPv3N6Castro11post_regridEii"></span><span id="_CPPv2N6Castro11post_regridEii"></span><span id="Castro::post_regrid__i.i"></span><span class="target" id="classCastro_1a350c686834180f657c25ff1cb4a7f686"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">post_regrid</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lbase</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_finest</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro11post_regridEii" title="Link to this definition"></a><br /></dt>
<dd><p>Do work after regrid().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lbase</strong> – </p></li>
<li><p><strong>new_finest</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12post_restartEv">
<span id="_CPPv3N6Castro12post_restartEv"></span><span id="_CPPv2N6Castro12post_restartEv"></span><span id="Castro::post_restart"></span><span class="target" id="classCastro_1a55a8a5c219d65d7e3bc780c8cfa3a161"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">post_restart</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro12post_restartEv" title="Link to this definition"></a><br /></dt>
<dd><p>Do work after a <a class="reference internal" href="../file/Castro_8H.html#classCastro_1afde904ee263a01f9002f6e84c63c1ed9"><span class="std std-ref">restart()</span></a>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro9post_initEN5amrex4RealE">
<span id="_CPPv3N6Castro9post_initEN5amrex4RealE"></span><span id="_CPPv2N6Castro9post_initEN5amrex4RealE"></span><span id="Castro::post_init__amrex::Real"></span><span class="target" id="classCastro_1a6de18362ba8f63dcd4e689c69fbfd02a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">post_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stop_time</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro9post_initEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Do work after <a class="reference internal" href="../file/Castro_8H.html#classCastro_1ac1ab7c06893489b1997870fb256c84db"><span class="std std-ref">init()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stop_time</strong> – End time of simulation </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14scf_relaxationEv">
<span id="_CPPv3N6Castro14scf_relaxationEv"></span><span id="_CPPv2N6Castro14scf_relaxationEv"></span><span id="Castro::scf_relaxation"></span><span class="target" id="classCastro_1af6e42d1e0f50c2340516a53379baf1a5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scf_relaxation</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14scf_relaxationEv" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize a model using the self-consistent field method. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13do_hscf_solveEv">
<span id="_CPPv3N6Castro13do_hscf_solveEv"></span><span id="_CPPv2N6Castro13do_hscf_solveEv"></span><span id="Castro::do_hscf_solve"></span><span class="target" id="classCastro_1aa4bc06e4bd017c884e2c92af4e18fb4f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">do_hscf_solve</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13do_hscf_solveEv" title="Link to this definition"></a><br /></dt>
<dd><p>Perform the Hachisu SCF method. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18post_grown_restartEv">
<span id="_CPPv3N6Castro18post_grown_restartEv"></span><span id="_CPPv2N6Castro18post_grown_restartEv"></span><span id="Castro::post_grown_restart"></span><span class="target" id="classCastro_1a853a6a3e3c8b75e1ed876bde15dd19f9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">post_grown_restart</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro18post_grown_restartEv" title="Link to this definition"></a><br /></dt>
<dd><p>Do work after restart with <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> &gt; 1 </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro8errorEstERN5amrex11TagBoxArrayEiiN5amrex4RealEii">
<span id="_CPPv3N6Castro8errorEstERN5amrex11TagBoxArrayEiiN5amrex4RealEii"></span><span id="_CPPv2N6Castro8errorEstERN5amrex11TagBoxArrayEiiN5amrex4RealEii"></span><span id="Castro::errorEst__amrex::TagBoxArrayR.i.i.amrex::Real.i.i"></span><span class="target" id="classCastro_1af2fd19393b34adf6dabe1540761f3eea"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">errorEst</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">TagBoxArray</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tags</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">clearval</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">tagval</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_error_buf</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ngrow</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro8errorEstERN5amrex11TagBoxArrayEiiN5amrex4RealEii" title="Link to this definition"></a><br /></dt>
<dd><p>Error estimation for regridding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tags</strong> – TagBoxArray of tags </p></li>
<li><p><strong>clearval</strong> – integer </p></li>
<li><p><strong>tagval</strong> – integer </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>n_error_buf</strong> – integer </p></li>
<li><p><strong>ngrow</strong> – Number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro18apply_problem_tagsERN5amrex11TagBoxArrayEN5amrex4RealE">
<span id="_CPPv3N6Castro18apply_problem_tagsERN5amrex11TagBoxArrayEN5amrex4RealE"></span><span id="_CPPv2N6Castro18apply_problem_tagsERN5amrex11TagBoxArrayEN5amrex4RealE"></span><span id="Castro::apply_problem_tags__amrex::TagBoxArrayR.amrex::Real"></span><span class="target" id="classCastro_1a356447819fc378cf4d19d7e30e6b7fc8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_problem_tags</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">TagBoxArray</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tags</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro18apply_problem_tagsERN5amrex11TagBoxArrayEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Apply the <a class="reference internal" href="../file/problem__tagging_8H.html#problem__tagging_8H_1a0db54260935ab528b9b3e6154f37dfd3"><span class="std std-ref">problem_tagging</span></a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tags</strong> – TagBoxArray of tags </p></li>
<li><p><strong>time</strong> – current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro26apply_tagging_restrictionsERN5amrex11TagBoxArrayEN5amrex4RealE">
<span id="_CPPv3N6Castro26apply_tagging_restrictionsERN5amrex11TagBoxArrayEN5amrex4RealE"></span><span id="_CPPv2N6Castro26apply_tagging_restrictionsERN5amrex11TagBoxArrayEN5amrex4RealE"></span><span id="Castro::apply_tagging_restrictions__amrex::TagBoxArrayR.amrex::Real"></span><span class="target" id="classCastro_1a837d26bd4bfc315fe986f54f621b468d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_tagging_restrictions</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">TagBoxArray</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tags</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro26apply_tagging_restrictionsERN5amrex11TagBoxArrayEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Apply any tagging restrictions that must be satisfied by all problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tags</strong> – TagBoxArray of tags </p></li>
<li><p><strong>time</strong> – current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealEi">
<span id="_CPPv3N6Castro6deriveERKNSt6stringEN5amrex4RealEi"></span><span id="_CPPv2N6Castro6deriveERKNSt6stringEN5amrex4RealEi"></span><span id="Castro::derive__ssCR.amrex::Real.i"></span><span class="target" id="classCastro_1a0d85e53a1b9f7c216ce52801344299a0"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">derive</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ngrow</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a MultiFab containing the derived data for this level. If ngrow&gt;0 the MultiFab is built on the appropriately grown BoxArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of derived data </p></li>
<li><p><strong>time</strong> – Current time </p></li>
<li><p><strong>ngrow</strong> – Number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealERN5amrex8MultiFabEi">
<span id="_CPPv3N6Castro6deriveERKNSt6stringEN5amrex4RealERN5amrex8MultiFabEi"></span><span id="_CPPv2N6Castro6deriveERKNSt6stringEN5amrex4RealERN5amrex8MultiFabEi"></span><span id="Castro::derive__ssCR.amrex::Real.amrex::MultiFabR.i"></span><span class="target" id="classCastro_1a17e4f55770a6badc6ec067b396fb6b74"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">derive</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mf</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dcomp</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><a class="headerlink" href="#_CPPv4N6Castro6deriveERKNSt6stringEN5amrex4RealERN5amrex8MultiFabEi" title="Link to this definition"></a><br /></dt>
<dd><p>This version of <a class="reference internal" href="../file/Castro_8H.html#classCastro_1a0d85e53a1b9f7c216ce52801344299a0"><span class="std std-ref">derive()</span></a> fills the dcomp’th component of mf with the derived quantity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of quantity to derive </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>mf</strong> – MultiFab to store derived quantity in </p></li>
<li><p><strong>dcomp</strong> – index of component of <code class="docutils literal notranslate"><span class="pre">mf</span></code> to fill with derived quantity </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro20final_radiation_callERN5amrex8MultiFabEii">
<span id="_CPPv3N6Castro20final_radiation_callERN5amrex8MultiFabEii"></span><span id="_CPPv2N6Castro20final_radiation_callERN5amrex8MultiFabEii"></span><span id="Castro::final_radiation_call__amrex::MultiFabR.i.i"></span><span class="target" id="classCastro_1a2d45e9419ba0eb07ec75ddee0285bb6e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">final_radiation_call</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">S_new</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iteration</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ncycle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro20final_radiation_callERN5amrex8MultiFabEii" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_new</strong> – </p></li>
<li><p><strong>iteration</strong> – where we are in the current AMR subcycle </p></li>
<li><p><strong>ncycle</strong> – the number of subcycles at this level </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro21reset_internal_energyERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEi">
<span id="_CPPv3N6Castro21reset_internal_energyERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEi"></span><span id="_CPPv2N6Castro21reset_internal_energyERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEi"></span><span id="Castro::reset_internal_energy__amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.i"></span><span class="target" id="classCastro_1abfed1ea86ec3db402a2a89ec2dcb1d24"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reset_internal_energy</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">By</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">State</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ng</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro21reset_internal_energyERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEi" title="Link to this definition"></a><br /></dt>
<dd><p>Reset the internal energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>State</strong> – Current state (MultiFab) </p></li>
<li><p><strong>ng</strong> – number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11check_div_BERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE">
<span id="_CPPv3N6Castro11check_div_BERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="_CPPv2N6Castro11check_div_BERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="Castro::check_div_B__amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR"></span><span class="target" id="classCastro_1a5bf793c2b91ad3a30e0deb6b91348a2a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_div_B</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">By</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro11check_div_BERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Check if divergence of B is zero at initialization </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Bx</strong> – magnetic field in x </p></li>
<li><p><strong>By</strong> – magnetic field in y </p></li>
<li><p><strong>Bz</strong> – magnetic field in z </p></li>
<li><p><strong>state</strong> – the state to operate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11computeTempERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEN5amrex4RealEi">
<span id="_CPPv3N6Castro11computeTempERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEN5amrex4RealEi"></span><span id="_CPPv2N6Castro11computeTempERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEN5amrex4RealEi"></span><span id="Castro::computeTemp__amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.amrex::Real.i"></span><span class="target" id="classCastro_1a31f5bb8b118a05389782d77766c9b1b1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">computeTemp</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">By</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ng</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro11computeTempERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the current temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – the state to operate on </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>ng</strong> – number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro23create_source_correctorEv">
<span id="_CPPv3N6Castro23create_source_correctorEv"></span><span id="_CPPv2N6Castro23create_source_correctorEv"></span><span id="Castro::create_source_corrector"></span><span class="target" id="classCastro_1a0439af87960668e22136574728818758"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_source_corrector</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro23create_source_correctorEv" title="Link to this definition"></a><br /></dt>
<dd><p>Add any terms needed to correct the source terms. Currently this is a lagged predictor for CTU and the time-centering correction for simplified SDC. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro22swap_state_time_levelsEKN5amrex4RealE">
<span id="_CPPv3N6Castro22swap_state_time_levelsEKN5amrex4RealE"></span><span id="_CPPv2N6Castro22swap_state_time_levelsEKN5amrex4RealE"></span><span id="Castro::swap_state_time_levels__amrex::RealC"></span><span class="target" id="classCastro_1aef8e45ccb243d726effd82dddc824cb4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">swap_state_time_levels</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro22swap_state_time_levelsEKN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>This is a hack to make sure that we only ever have new data for certain state types that only ever need new time data; by doing a swap now, we’ll guarantee that <a class="reference internal" href="../file/Castro_8H.html#classCastro_1a8ef4ee7c4347ce493def85f9f329e535"><span class="std std-ref">allocOldData()</span></a> does nothing. We do this because we never need the old data, so we don’t want to allocate memory for it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dt</strong> – timestep </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro9volWgtSumERK8MultiFabibb">
<span id="_CPPv3N6Castro9volWgtSumERK8MultiFabibb"></span><span id="_CPPv2N6Castro9volWgtSumERK8MultiFabibb"></span><span id="Castro::volWgtSum__MultiFabCR.i.b.b"></span><span class="target" id="classCastro_1a6bd8e66825a5b295ecc6fae6ef52f544"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">volWgtSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mf</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comp</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finemask</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro9volWgtSumERK8MultiFabibb" title="Link to this definition"></a><br /></dt>
<dd><p>Volume weighted sum of given quantity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> – MultiFab containing quantity </p></li>
<li><p><strong>comp</strong> – integer index of quantity in MultiFab </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
<li><p><strong>finemask</strong> – boolean, should we build a mask to exclude finer levels? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro9volWgtSumERKNSt6stringEN5amrex4RealEbb">
<span id="_CPPv3N6Castro9volWgtSumERKNSt6stringEN5amrex4RealEbb"></span><span id="_CPPv2N6Castro9volWgtSumERKNSt6stringEN5amrex4RealEbb"></span><span id="Castro::volWgtSum__ssCR.amrex::Real.b.b"></span><span class="target" id="classCastro_1a3e457aa8e25326d7b86b051b46fa4b46"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">volWgtSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finemask</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro9volWgtSumERKNSt6stringEN5amrex4RealEbb" title="Link to this definition"></a><br /></dt>
<dd><p>Volume weighted sum of given quantity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of quantity </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
<li><p><strong>finemask</strong> – boolean, should we build a mask to exclude finer levels? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro9locWgtSumERK8MultiFabiib">
<span id="_CPPv3N6Castro9locWgtSumERK8MultiFabiib"></span><span id="_CPPv2N6Castro9locWgtSumERK8MultiFabiib"></span><span id="Castro::locWgtSum__MultiFabCR.i.i.b"></span><span class="target" id="classCastro_1a7858e066d61a4692c102e02104cb42d9"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">locWgtSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mf</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comp</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idir</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro9locWgtSumERK8MultiFabiib" title="Link to this definition"></a><br /></dt>
<dd><p>Sum weighted by volume multiplied by distance from center in given direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> – MultiFab containing quantity </p></li>
<li><p><strong>comp</strong> – integer index of quantity in MultiFab </p></li>
<li><p><strong>idir</strong> – Axis along which to compute distance from center </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro9locWgtSumERKNSt6stringEN5amrex4RealEib">
<span id="_CPPv3N6Castro9locWgtSumERKNSt6stringEN5amrex4RealEib"></span><span id="_CPPv2N6Castro9locWgtSumERKNSt6stringEN5amrex4RealEib"></span><span id="Castro::locWgtSum__ssCR.amrex::Real.i.b"></span><span class="target" id="classCastro_1a1206793cf51bf8bfe37b5772c6b82b4c"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">locWgtSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idir</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro9locWgtSumERKNSt6stringEN5amrex4RealEib" title="Link to this definition"></a><br /></dt>
<dd><p>Sum weighted by volume multiplied by distance from center in given direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of quantity </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>idir</strong> – Axis along which to compute distance from center </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13volProductSumERK8MultiFabRK8MultiFabiib">
<span id="_CPPv3N6Castro13volProductSumERK8MultiFabRK8MultiFabiib"></span><span id="_CPPv2N6Castro13volProductSumERK8MultiFabRK8MultiFabiib"></span><span id="Castro::volProductSum__MultiFabCR.MultiFabCR.i.i.b"></span><span class="target" id="classCastro_1a8171de8ea74f9fab811915e32e45d4f9"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">volProductSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mf1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mf2</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comp1</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comp2</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13volProductSumERK8MultiFabRK8MultiFabiib" title="Link to this definition"></a><br /></dt>
<dd><p>Volume weighted sum of the product of two quantities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf1</strong> – MultiFab containing first quantity </p></li>
<li><p><strong>mf2</strong> – MultiFab containing second quantity </p></li>
<li><p><strong>comp1</strong> – integer index of quantity in first MultiFab </p></li>
<li><p><strong>comp2</strong> – integer index of quantity in second MultiFab </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13volProductSumERKNSt6stringERKNSt6stringEN5amrex4RealEb">
<span id="_CPPv3N6Castro13volProductSumERKNSt6stringERKNSt6stringEN5amrex4RealEb"></span><span id="_CPPv2N6Castro13volProductSumERKNSt6stringERKNSt6stringEN5amrex4RealEb"></span><span id="Castro::volProductSum__ssCR.ssCR.amrex::Real.b"></span><span class="target" id="classCastro_1a0227ba60b8077c4472fe94a4ddd607b7"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">volProductSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name2</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13volProductSumERKNSt6stringERKNSt6stringEN5amrex4RealEb" title="Link to this definition"></a><br /></dt>
<dd><p>Volume weighted sum of the product of two quantities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name1</strong> – Name of first quantity </p></li>
<li><p><strong>name2</strong> – Name of second quantity </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13locSquaredSumERKNSt6stringEN5amrex4RealEib">
<span id="_CPPv3N6Castro13locSquaredSumERKNSt6stringEN5amrex4RealEib"></span><span id="_CPPv2N6Castro13locSquaredSumERKNSt6stringEN5amrex4RealEib"></span><span id="Castro::locSquaredSum__ssCR.amrex::Real.i.b"></span><span class="target" id="classCastro_1a72ba784d23422fe8bc550abec2a53c47"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">locSquaredSum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">idir</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13locSquaredSumERKNSt6stringEN5amrex4RealEib" title="Link to this definition"></a><br /></dt>
<dd><p>Location weighted sum of (quantity) squared</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of quantity </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>idir</strong> – Direction along which to weight </p></li>
<li><p><strong>local</strong> – boolean, is sum local (over each patch) or over entire MultiFab? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro8gwstrainE4RealR4RealR4RealR4RealR4RealR4RealR4Realb">
<span id="_CPPv3N6Castro8gwstrainE4RealR4RealR4RealR4RealR4RealR4RealR4Realb"></span><span id="_CPPv2N6Castro8gwstrainE4RealR4RealR4RealR4RealR4RealR4RealR4Realb"></span><span id="Castro::gwstrain__Real.RealR.RealR.RealR.RealR.RealR.RealR.b"></span><span class="target" id="classCastro_1ac2d7bd84807577fc95bb5f533f73cac9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gwstrain</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_plus_1</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_cross_1</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_plus_2</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_cross_2</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_plus_3</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h_cross_3</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro8gwstrainE4RealR4RealR4RealR4RealR4RealR4RealR4Realb" title="Link to this definition"></a><br /></dt>
<dd><p>Calculate the gravitational wave signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>h_plus_1</strong> – gravitational wave signal in x-direction </p></li>
<li><p><strong>h_cross_1</strong> – gravitational wave signal in x-direction </p></li>
<li><p><strong>h_plus_2</strong> – gravitational wave signal in y-direction </p></li>
<li><p><strong>h_cross_2</strong> – gravitational wave signal in y-direction </p></li>
<li><p><strong>h_plus_3</strong> – gravitational wave signal in z-direction </p></li>
<li><p><strong>h_cross_3</strong> – gravitational wave signal in z-direction </p></li>
<li><p><strong>local</strong> – is sum local </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro12expand_stateERN5amrex8MultiFabEN5amrex4RealEi">
<span id="_CPPv3N6Castro12expand_stateERN5amrex8MultiFabEN5amrex4RealEi"></span><span id="_CPPv2N6Castro12expand_stateERN5amrex8MultiFabEN5amrex4RealEi"></span><span id="Castro::expand_state__amrex::MultiFabR.amrex::Real.i"></span><span class="target" id="classCastro_1a7252c7c657f96170a61a4fd2d86ea006"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">expand_state</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">S</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ng</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro12expand_stateERN5amrex8MultiFabEN5amrex4RealEi" title="Link to this definition"></a><br /></dt>
<dd><p>Fill a version of the state with <code class="docutils literal notranslate"><span class="pre">ng</span></code> ghost zones from the state data. After we do the fill, optionally clean the data using the iclean parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> – MultiFab to be filled </p></li>
<li><p><strong>time</strong> – current time </p></li>
<li><p><strong>ng</strong> – number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro8getLevelEi">
<span id="_CPPv3N6Castro8getLevelEi"></span><span id="_CPPv2N6Castro8getLevelEi"></span><span id="Castro::getLevel__i"></span><span class="target" id="classCastro_1a3b6d83fb0569da5071dd5e36bc06abdd"></span><a class="reference internal" href="#_CPPv46Castro" title="Castro"><span class="n"><span class="pre">Castro</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">getLevel</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro8getLevelEi" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lev</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro15FluxRegCrseInitEv">
<span id="_CPPv3N6Castro15FluxRegCrseInitEv"></span><span id="_CPPv2N6Castro15FluxRegCrseInitEv"></span><span id="Castro::FluxRegCrseInit"></span><span class="target" id="classCastro_1a45605f8e5c219c1a25e9173e49227d0e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FluxRegCrseInit</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro15FluxRegCrseInitEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14FluxRegFineAddEv">
<span id="_CPPv3N6Castro14FluxRegFineAddEv"></span><span id="_CPPv2N6Castro14FluxRegFineAddEv"></span><span id="Castro::FluxRegFineAdd"></span><span class="target" id="classCastro_1a12792bdb83e475e19d12ff543ed6a6ad"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FluxRegFineAdd</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14FluxRegFineAddEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro6refluxEiib">
<span id="_CPPv3N6Castro6refluxEiib"></span><span id="_CPPv2N6Castro6refluxEiib"></span><span id="Castro::reflux__i.i.b"></span><span class="target" id="classCastro_1adf8a439a2edb05cd73fe3af91e80daea"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reflux</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in_post_timestep</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro6refluxEiib" title="Link to this definition"></a><br /></dt>
<dd><p>Do refluxing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – </p></li>
<li><p><strong>fine_level</strong> – </p></li>
<li><p><strong>in_post_timestep</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14writeBuildInfoEv">
<span id="_CPPv3N6Castro14writeBuildInfoEv"></span><span id="_CPPv2N6Castro14writeBuildInfoEv"></span><span id="Castro::writeBuildInfo"></span><span class="target" id="classCastro_1a01a5a8719b8a08d0a462ccecd1dafbe4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">writeBuildInfo</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14writeBuildInfoEv" title="Link to this definition"></a><br /></dt>
<dd><p>Dump build info </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13variableSetUpEv">
<span id="_CPPv3N6Castro13variableSetUpEv"></span><span id="_CPPv2N6Castro13variableSetUpEv"></span><span id="Castro::variableSetUp"></span><span class="target" id="classCastro_1af1fb86fccd0c9ef1892f3d3d56571332"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">variableSetUp</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13variableSetUpEv" title="Link to this definition"></a><br /></dt>
<dd><p>Define data descriptors.</p>
<p><a class="reference internal" href="../file/Castro_8H.html#classCastro_1af1fb86fccd0c9ef1892f3d3d56571332"><span class="std std-ref">variableSetUp</span></a> is called in the constructor of Amr.cpp, so it should get called every time we start or restart a job </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro10ErrorSetUpEv">
<span id="_CPPv3N6Castro10ErrorSetUpEv"></span><span id="_CPPv2N6Castro10ErrorSetUpEv"></span><span id="Castro::ErrorSetUp"></span><span class="target" id="classCastro_1a2ff2ce7b6c5f23bdc98579b965831fbc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ErrorSetUp</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro10ErrorSetUpEv" title="Link to this definition"></a><br /></dt>
<dd><p>Define tagging functions. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro15variableCleanUpEv">
<span id="_CPPv3N6Castro15variableCleanUpEv"></span><span id="_CPPv2N6Castro15variableCleanUpEv"></span><span id="Castro::variableCleanUp"></span><span class="target" id="classCastro_1a2e1f20b769f4d92a2290050f176592fb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">variableCleanUp</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro15variableCleanUpEv" title="Link to this definition"></a><br /></dt>
<dd><p>Cleanup data descriptors at end of run.</p>
<p><a class="reference internal" href="../file/Castro_8H.html#classCastro_1af1fb86fccd0c9ef1892f3d3d56571332"><span class="std std-ref">variableSetUp</span></a> is in <code class="docutils literal notranslate"><span class="pre">Castro_setup.cpp</span></code> <code class="docutils literal notranslate"><span class="pre">variableCleanUp</span></code> is called once at the end of a simulation </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro20read_particle_paramsEv">
<span id="_CPPv3N6Castro20read_particle_paramsEv"></span><span id="_CPPv2N6Castro20read_particle_paramsEv"></span><span id="Castro::read_particle_params"></span><span class="target" id="classCastro_1a97e96ec55650c0d51ae108658914238a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_particle_params</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro20read_particle_paramsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Read particle-related inputs </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro13check_for_nanERKN5amrex8MultiFabEi">
<span id="_CPPv3N6Castro13check_for_nanERKN5amrex8MultiFabEi"></span><span id="_CPPv2N6Castro13check_for_nanERKN5amrex8MultiFabEi"></span><span id="Castro::check_for_nan__amrex::MultiFabCR.i"></span><span class="target" id="classCastro_1a6d408b508a9dc1ffe52f09f5e6ba6408"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_for_nan</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">check_ghost</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro13check_for_nanERKN5amrex8MultiFabEi" title="Link to this definition"></a><br /></dt>
<dd><p>Check for NaNs in the given MultiFab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – MultiFab to check </p></li>
<li><p><strong>check_ghost</strong> – do we check the ghost cells? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro23problem_post_simulationERN5amrex6VectorINSt10unique_ptrI8AmrLevelEEEE">
<span id="_CPPv3N6Castro23problem_post_simulationERN5amrex6VectorINSt10unique_ptrI8AmrLevelEEEE"></span><span id="_CPPv2N6Castro23problem_post_simulationERN5amrex6VectorINSt10unique_ptrI8AmrLevelEEEE"></span><span id="Castro::problem_post_simulation__amrex::Vector:std::unique_ptr:AmrLevel::R"></span><span class="target" id="classCastro_1a844ccb0a8d774190e1d247f53266ab68"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">problem_post_simulation</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">AmrLevel</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">amr_level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro23problem_post_simulationERN5amrex6VectorINSt10unique_ptrI8AmrLevelEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Do work at the end of the simulation - before the last outputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>amr_level</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro21reset_internal_energyERKN5amrex3BoxEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEE">
<span id="_CPPv3N6Castro21reset_internal_energyERKN5amrex3BoxEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEE"></span><span id="_CPPv2N6Castro21reset_internal_energyERKN5amrex3BoxEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEE"></span><span id="Castro::reset_internal_energy__amrex::BoxCR.amrex::Array4:amrex::Real:C.amrex::Array4:amrex::Real:C.amrex::Array4:amrex::Real:C.amrex::Array4:amrex::Real:C"></span><span class="target" id="classCastro_1aeb76b97915246f0670a9a56869263df4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reset_internal_energy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Box</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">By</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Bz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">u</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro21reset_internal_energyERKN5amrex3BoxEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEEKN5amrex6Array4IN5amrex4RealEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Reset the internal energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bx</strong> – Box to update </p></li>
<li><p><strong>u</strong> – Current state (Fab) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14add_magnetic_eERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE">
<span id="_CPPv3N6Castro14add_magnetic_eERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="_CPPv2N6Castro14add_magnetic_eERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="Castro::add_magnetic_e__amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR.amrex::MultiFabR"></span><span class="target" id="classCastro_1a443e99ba59de8678223337dbc89c19e7"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add_magnetic_e</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">By</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Bz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">state</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14add_magnetic_eERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabERN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Add magnetic contribution to energy density </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Bx</strong> – magnetic field in x </p></li>
<li><p><strong>By</strong> – magnetic field in y </p></li>
<li><p><strong>Bz</strong> – magnetic field in z </p></li>
<li><p><strong>state</strong> – the state to operate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro16using_point_massEv">
<span id="_CPPv3N6Castro16using_point_massEv"></span><span id="_CPPv2N6Castro16using_point_massEv"></span><span id="Castro::using_point_mass"></span><span class="target" id="classCastro_1a80d7cf385a30dba2f2458189504e67e3"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">using_point_mass</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro16using_point_massEv" title="Link to this definition"></a><br /></dt>
<dd><p>Are we using point mass gravity? </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro14get_point_massEv">
<span id="_CPPv3N6Castro14get_point_massEv"></span><span id="_CPPv2N6Castro14get_point_massEv"></span><span id="Castro::get_point_mass"></span><span class="target" id="classCastro_1a70bf0c8b32342dcc8aef3bc78a9becd6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_point_mass</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro14get_point_massEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return the value of the point mass. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11extern_initEv">
<span id="_CPPv3N6Castro11extern_initEv"></span><span id="_CPPv2N6Castro11extern_initEv"></span><span id="Castro::extern_init"></span><span class="target" id="classCastro_1a54ac4dc9481c19c1e3ac9a17486728d7"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extern_init</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro11extern_initEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro11read_paramsEv">
<span id="_CPPv3N6Castro11read_paramsEv"></span><span id="_CPPv2N6Castro11read_paramsEv"></span><span id="Castro::read_params"></span><span class="target" id="classCastro_1a34311775f04511064a8020d36e32407b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_params</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro11read_paramsEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N6Castro17normalize_speciesERN5amrex8MultiFabEi">
<span id="_CPPv3N6Castro17normalize_speciesERN5amrex8MultiFabEi"></span><span id="_CPPv2N6Castro17normalize_speciesERN5amrex8MultiFabEi"></span><span id="Castro::normalize_species__amrex::MultiFabR.i"></span><span class="target" id="classCastro_1a485fbc9a051269d23057c64a0a66de68"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">normalize_species</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">S_new</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ng</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N6Castro17normalize_speciesERN5amrex8MultiFabEi" title="Link to this definition"></a><br /></dt>
<dd><p>Normalize species fractions so they sum to 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_new</strong> – State </p></li>
<li><p><strong>ng</strong> – number of ghost cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../classlist.html" class="btn btn-neutral float-left" title="Class list" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="classCoutRedirection.html" class="btn btn-neutral float-right" title="Class CoutRedirection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Castro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>