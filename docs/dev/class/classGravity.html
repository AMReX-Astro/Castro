

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Class Gravity &mdash; Castro  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=2e394b92" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"kth": "{{k_\\mathrm{th}}}", "gcc": "{\\mathrm{g~cm^{-3}}}", "cms": "{\\mathrm{cm~s^{-1}}}", "presunit": "{\\mathrm{dyn~cm^{-2}}}", "accelunit": "{\\mathrm{cm~s^{-2}}}", "ergg": "{\\mathrm{erg~g^{-1}}}", "Ab": "{{\\bf A}}", "eb": "{{\\bf e}}", "Fb": "{{\\bf F}}", "gb": "{{\\bf g}}", "Hb": "{{\\bf H}}", "ib": "{{\\bf i}}", "Ib": "{{\\bf I}}", "Kb": "{{\\bf K}}", "lb": "{{\\bf l}}", "Lb": "{{\\bf L}}", "nb": "{{\\bf n}}", "Pb": "{{\\bf P}}", "Qb": "{{\\bf Q}}", "rb": "{{\\bf r}}", "Rb": "{{\\bf R}}", "Sb": "{{\\bf S}}", "ub": "{{\\bf u}}", "Ub": "{{\\bf U}}", "xb": "{{\\bf x}}", "dt": "{\\Delta t}", "omegadot": "{\\dot\\omega}", "inp": "{{\\rm in}}", "outp": "{{\\rm out}}", "sync": "{{\\rm sync}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\half}", "nph": "{{n+\\myhalf}}", "kpp": "{\\ensuremath{\\kappa_{\\mathrm{P}}}}", "kpr": "{\\ensuremath{\\kappa_{\\mathrm{R}}}}", "kpf": "{\\ensuremath{\\kappa_{\\mathrm{F}}}}", "vb": "{\\boldsymbol{v}}", "vbt": "{\\widetilde{\\vb}}", "rbt": "{\\widetilde{\\rb}}", "ob": "{\\boldsymbol{\\omega}}", "nablab": "{\\boldsymbol{\\nabla}}", "avg": ["{{\\left \\langle #1 \\right \\rangle}}", 1]}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class HypreABec" href="classHypreABec.html" />
    <link rel="prev" title="Class GradPhiPhysBCFunct" href="classGradPhiPhysBCFunct.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="../index.html" class="icon icon-home">
            Castro
              <img src="../_static/castro_logo_hot_200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="../../class/classGravity.html">main</a> | <a href="../class/classGravity.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Castro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mpi_plus_x.html">Running Options: CPUs and GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu.html">GPU Programming Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problem_setups.html">Distributed Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timestepping.html">Timestepping and Retries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_a_problem.html">Setting Up Your Own Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">Outputting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Castro reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hse.html">Hydrostatic Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EOS.html">Equation of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reactions.html">Reactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhd.html">MHD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diffusion.html">Thermal Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sponge.html">Sponge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ConvertCheckpoint.html">Checkpoint Embiggener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../self_consistent_field.html">Self-Consistent Field Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development Best Practices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../filelist.html">File list</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../classlist.html">Class list</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="classCastro.html">Class Castro</a></li>
<li class="toctree-l2"><a class="reference internal" href="classCoutRedirection.html">Class CoutRedirection</a></li>
<li class="toctree-l2"><a class="reference internal" href="classDiffusion.html">Class Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="classGradPhiPhysBCFunct.html">Class GradPhiPhysBCFunct</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Class Gravity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47Gravity"><code class="docutils literal notranslate"><span class="pre">Gravity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7GravityEPN5amrex3AmrEiPN5amrex5BCRecEi"><code class="docutils literal notranslate"><span class="pre">Gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7GravityD0Ev"><code class="docutils literal notranslate"><span class="pre">~Gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7GravityERK7Gravity"><code class="docutils literal notranslate"><span class="pre">Gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7GravityERR7Gravity"><code class="docutils literal notranslate"><span class="pre">Gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7GravityaSERK7Gravity"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7GravityaSERR7Gravity"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity11read_paramsEv"><code class="docutils literal notranslate"><span class="pre">read_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity21set_numpts_in_gravityEi"><code class="docutils literal notranslate"><span class="pre">set_numpts_in_gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity13install_levelEiPN5amrex8AmrLevelERN5amrex8MultiFabEPN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">install_level()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity15set_mass_offsetEN5amrex4RealEb"><code class="docutils literal notranslate"><span class="pre">set_mass_offset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity17get_grad_phi_prevEi"><code class="docutils literal notranslate"><span class="pre">get_grad_phi_prev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity17get_grad_phi_currEi"><code class="docutils literal notranslate"><span class="pre">get_grad_phi_curr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity22get_grad_phi_prev_compEii"><code class="docutils literal notranslate"><span class="pre">get_grad_phi_prev_comp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity18plus_grad_phi_currEiRN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"><code class="docutils literal notranslate"><span class="pre">plus_grad_phi_curr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity14swapTimeLevelsEi"><code class="docutils literal notranslate"><span class="pre">swapTimeLevels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity14update_max_rhsEv"><code class="docutils literal notranslate"><span class="pre">update_max_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity13solve_for_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEEi"><code class="docutils literal notranslate"><span class="pre">solve_for_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19solve_for_delta_phiEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEE"><code class="docutils literal notranslate"><span class="pre">solve_for_delta_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity12gravity_syncEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEE"><code class="docutils literal notranslate"><span class="pre">gravity_sync()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity28multilevel_solve_for_new_phiEii"><code class="docutils literal notranslate"><span class="pre">multilevel_solve_for_new_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity23actual_multilevel_solveEiiRKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEEi"><code class="docutils literal notranslate"><span class="pre">actual_multilevel_solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity32create_comp_minus_level_grad_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabERN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"><code class="docutils literal notranslate"><span class="pre">create_comp_minus_level_grad_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity10GetCrsePhiEiRN5amrex8MultiFabEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">GetCrsePhi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19get_old_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">get_old_grav_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19get_new_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">get_new_grav_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity24test_level_grad_phi_prevEi"><code class="docutils literal notranslate"><span class="pre">test_level_grad_phi_prev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity24test_level_grad_phi_currEi"><code class="docutils literal notranslate"><span class="pre">test_level_grad_phi_curr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity18test_composite_phiEi"><code class="docutils literal notranslate"><span class="pre">test_composite_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity28average_fine_ec_onto_crse_ecEii"><code class="docutils literal notranslate"><span class="pre">average_fine_ec_onto_crse_ec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19make_radial_gravityEiN5amrex4RealER10RealVector"><code class="docutils literal notranslate"><span class="pre">make_radial_gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity25interpolate_monopole_gravEiR10RealVectorRN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">interpolate_monopole_grav()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity19compute_radial_massERKN5amrex3BoxEKN5amrex6Array4IKN5amrex4RealEEER10RealVectorR10RealVectorR10RealVectorii"><code class="docutils literal notranslate"><span class="pre">compute_radial_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity18fill_multipole_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">fill_multipole_BCs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity19init_multipole_gravEv"><code class="docutils literal notranslate"><span class="pre">init_multipole_grav()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19fill_direct_sum_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">fill_direct_sum_BCs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity10make_mg_bcEv"><code class="docutils literal notranslate"><span class="pre">make_mg_bc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity16applyMetricTermsEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEE"><code class="docutils literal notranslate"><span class="pre">applyMetricTerms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity11unweight_ccEiRN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">unweight_cc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity14unweight_edgesEiRKN5amrex6VectorIPN5amrex8MultiFabEEE"><code class="docutils literal notranslate"><span class="pre">unweight_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity24add_pointmass_to_gravityEiRN5amrex8MultiFabERN5amrex8MultiFabE"><code class="docutils literal notranslate"><span class="pre">add_pointmass_to_gravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7get_rhsEiii"><code class="docutils literal notranslate"><span class="pre">get_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity12sanity_checkEi"><code class="docutils literal notranslate"><span class="pre">sanity_check()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7Gravity22actual_solve_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPKN5amrex8MultiFabEEERKN5amrex6VectorINSt5arrayIPN5amrex8MultiFabE14AMREX_SPACEDIMEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEPCKN5amrex8MultiFabEN5amrex4RealEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">actual_solve_with_mlmg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19solve_phi_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEN5amrex4RealE"><code class="docutils literal notranslate"><span class="pre">solve_phi_with_mlmg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity6parentE"><code class="docutils literal notranslate"><span class="pre">parent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity9LevelDataE"><code class="docutils literal notranslate"><span class="pre">LevelData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity13grad_phi_currE"><code class="docutils literal notranslate"><span class="pre">grad_phi_curr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity13grad_phi_prevE"><code class="docutils literal notranslate"><span class="pre">grad_phi_prev</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity5gridsE"><code class="docutils literal notranslate"><span class="pre">grids</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity4dmapE"><code class="docutils literal notranslate"><span class="pre">dmap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7abs_tolE"><code class="docutils literal notranslate"><span class="pre">abs_tol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7rel_tolE"><code class="docutils literal notranslate"><span class="pre">rel_tol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity20level_solver_resnormE"><code class="docutils literal notranslate"><span class="pre">level_solver_resnorm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7max_rhsE"><code class="docutils literal notranslate"><span class="pre">max_rhs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity6volumeE"><code class="docutils literal notranslate"><span class="pre">volume</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity4areaE"><code class="docutils literal notranslate"><span class="pre">area</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7DensityE"><code class="docutils literal notranslate"><span class="pre">Density</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity22finest_level_allocatedE"><code class="docutils literal notranslate"><span class="pre">finest_level_allocated</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity7phys_bcE"><code class="docutils literal notranslate"><span class="pre">phys_bc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity9mlmg_lobcE"><code class="docutils literal notranslate"><span class="pre">mlmg_lobc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity9mlmg_hibcE"><code class="docutils literal notranslate"><span class="pre">mlmg_hibc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity15numpts_at_levelE"><code class="docutils literal notranslate"><span class="pre">numpts_at_level</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity15radial_grav_oldE"><code class="docutils literal notranslate"><span class="pre">radial_grav_old</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity15radial_grav_newE"><code class="docutils literal notranslate"><span class="pre">radial_grav_new</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity11radial_massE"><code class="docutils literal notranslate"><span class="pre">radial_mass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity10radial_volE"><code class="docutils literal notranslate"><span class="pre">radial_vol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity11radial_presE"><code class="docutils literal notranslate"><span class="pre">radial_pres</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity22output_job_info_paramsERNSt7ostreamE"><code class="docutils literal notranslate"><span class="pre">output_job_info_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity16get_gravity_typeEv"><code class="docutils literal notranslate"><span class="pre">get_gravity_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity19get_max_solve_levelEv"><code class="docutils literal notranslate"><span class="pre">get_max_solve_level()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity6NoSyncEv"><code class="docutils literal notranslate"><span class="pre">NoSync()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity21DoCompositeCorrectionEv"><code class="docutils literal notranslate"><span class="pre">DoCompositeCorrection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity22test_results_of_solvesEv"><code class="docutils literal notranslate"><span class="pre">test_results_of_solves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity13test_residualERKN5amrex3BoxERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEi"><code class="docutils literal notranslate"><span class="pre">test_residual()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity11test_solvesE"><code class="docutils literal notranslate"><span class="pre">test_solves</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity11mass_offsetE"><code class="docutils literal notranslate"><span class="pre">mass_offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity12stencil_typeE"><code class="docutils literal notranslate"><span class="pre">stencil_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7Gravity24max_radius_all_in_domainE"><code class="docutils literal notranslate"><span class="pre">max_radius_all_in_domain</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="classHypreABec.html">Class HypreABec</a></li>
<li class="toctree-l2"><a class="reference internal" href="classHypreExtMultiABec.html">Class HypreExtMultiABec</a></li>
<li class="toctree-l2"><a class="reference internal" href="classMGRadBndry.html">Class MGRadBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classMGRadBndryBld.html">Class MGRadBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classNGBndry.html">Class NGBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classNGBndryBld.html">Class NGBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadBndry.html">Class RadBndry</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadBndryBld.html">Class RadBndryBld</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadSolve.html">Class RadSolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="classRadiation.html">Class Radiation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Castro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../classlist.html">Class list</a></li>
      <li class="breadcrumb-item active">Class Gravity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/class/classGravity.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="class-gravity">
<h1>Class Gravity<a class="headerlink" href="#class-gravity" title="Link to this heading"></a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv47Gravity">
<span id="_CPPv37Gravity"></span><span id="_CPPv27Gravity"></span><span id="Gravity"></span><span class="target" id="classGravity"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Gravity</span></span></span><a class="headerlink" href="#_CPPv47Gravity" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7GravityEPN5amrex3AmrEiPN5amrex5BCRecEi">
<span id="_CPPv3N7Gravity7GravityEPN5amrex3AmrEiPN5amrex5BCRecEi"></span><span id="_CPPv2N7Gravity7GravityEPN5amrex3AmrEiPN5amrex5BCRecEi"></span><span id="Gravity::Gravity__amrex::AmrP.i.amrex::BCRecP.i"></span><span class="target" id="classGravity_1a19d2502982ff5d00f246b94d3613d2de"></span><span class="sig-name descname"><span class="n"><span class="pre">Gravity</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Amr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Parent</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">_finest_level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BCRec</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">_phys_bc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">_density</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity7GravityEPN5amrex3AmrEiPN5amrex5BCRecEi" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Parent</strong> – Parent <code class="docutils literal notranslate"><span class="pre">Amr</span></code> object </p></li>
<li><p><strong>_finest_level</strong> – finest level </p></li>
<li><p><strong>_phys_bc</strong> – <code class="docutils literal notranslate"><span class="pre">BCRec</span></code> object, physical boundary conditions </p></li>
<li><p><strong>_density</strong> – index of density component </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7GravityD0Ev">
<span id="_CPPv3N7GravityD0Ev"></span><span id="_CPPv2N7GravityD0Ev"></span><span id="Gravity::~Gravity"></span><span class="target" id="classGravity_1a6fcaf5f5f0d4672c4a1d97a3102e053a"></span><span class="sig-name descname"><span class="n"><span class="pre">~Gravity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7GravityD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Deconstructor </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7GravityERK7Gravity">
<span id="_CPPv3N7Gravity7GravityERK7Gravity"></span><span id="_CPPv2N7Gravity7GravityERK7Gravity"></span><span id="Gravity::Gravity__GravityCR"></span><span class="target" id="classGravity_1a49fdf857bb0dfa2e67e32c54450d088a"></span><span class="sig-name descname"><span class="n"><span class="pre">Gravity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7Gravity7GravityERK7Gravity" title="Gravity::Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7Gravity7GravityERK7Gravity" title="Link to this definition"></a><br /></dt>
<dd><p>Remove copy/move constructors/assignment operators. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7GravityERR7Gravity">
<span id="_CPPv3N7Gravity7GravityERR7Gravity"></span><span id="_CPPv2N7Gravity7GravityERR7Gravity"></span><span id="Gravity::Gravity__GravityRR"></span><span class="target" id="classGravity_1a969b76f4447216d37c13450bf4ed31c7"></span><span class="sig-name descname"><span class="n"><span class="pre">Gravity</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7Gravity7GravityERR7Gravity" title="Gravity::Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7Gravity7GravityERR7Gravity" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7GravityaSERK7Gravity">
<span id="_CPPv3N7GravityaSERK7Gravity"></span><span id="_CPPv2N7GravityaSERK7Gravity"></span><span id="Gravity::assign-operator__GravityCR"></span><span class="target" id="classGravity_1afa46e9a8f7171442ab9dde4ef710ef7b"></span><a class="reference internal" href="#_CPPv47Gravity" title="Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv47Gravity" title="Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7GravityaSERK7Gravity" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7GravityaSERR7Gravity">
<span id="_CPPv3N7GravityaSERR7Gravity"></span><span id="_CPPv2N7GravityaSERR7Gravity"></span><span id="Gravity::assign-operator__GravityRR"></span><span class="target" id="classGravity_1a1ef3cb44337a6bd90aecde8056fcda6c"></span><a class="reference internal" href="#_CPPv47Gravity" title="Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47Gravity" title="Gravity"><span class="n"><span class="pre">Gravity</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7GravityaSERR7Gravity" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity11read_paramsEv">
<span id="_CPPv3N7Gravity11read_paramsEv"></span><span id="_CPPv2N7Gravity11read_paramsEv"></span><span id="Gravity::read_params"></span><span class="target" id="classGravity_1a6069f195122b406d09303ee22a7c8f0c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_params</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity11read_paramsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Read gravity-related parameters from parameter file </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity21set_numpts_in_gravityEi">
<span id="_CPPv3N7Gravity21set_numpts_in_gravityEi"></span><span id="_CPPv2N7Gravity21set_numpts_in_gravityEi"></span><span id="Gravity::set_numpts_in_gravity__i"></span><span class="target" id="classGravity_1adf7c071b4fdedea8349636fc674d3610"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_numpts_in_gravity</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numpts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity21set_numpts_in_gravityEi" title="Link to this definition"></a><br /></dt>
<dd><p>Set <code class="docutils literal notranslate"><a class="reference internal" href="../file/Gravity_8H.html#classGravity"><span class="std std-ref"><span class="pre">Gravity</span></span></a></code> object’s <code class="docutils literal notranslate"><span class="pre">numpts_at_level</span></code> variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>numpts</strong> – number of points </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity13install_levelEiPN5amrex8AmrLevelERN5amrex8MultiFabEPN5amrex8MultiFabE">
<span id="_CPPv3N7Gravity13install_levelEiPN5amrex8AmrLevelERN5amrex8MultiFabEPN5amrex8MultiFabE"></span><span id="_CPPv2N7Gravity13install_levelEiPN5amrex8AmrLevelERN5amrex8MultiFabEPN5amrex8MultiFabE"></span><span id="Gravity::install_level__i.amrex::AmrLevelP.amrex::MultiFabR.amrex::MultiFabP"></span><span class="target" id="classGravity_1aff69c6ba49044528ce55c068a217055f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">install_level</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AmrLevel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">level_data</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">volume</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">area</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity13install_levelEiPN5amrex8AmrLevelERN5amrex8MultiFabEPN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Setup gravity at level <code class="docutils literal notranslate"><span class="pre">level</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – integer, level number </p></li>
<li><p><strong>level_data</strong> – <code class="docutils literal notranslate"><span class="pre">AmrLevel</span></code> object containing state data at that level </p></li>
<li><p><strong>volume</strong> – MultiFab, volume elements of cells </p></li>
<li><p><strong>area</strong> – MultiFab, area elements of cells </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity15set_mass_offsetEN5amrex4RealEb">
<span id="_CPPv3NK7Gravity15set_mass_offsetEN5amrex4RealEb"></span><span id="_CPPv2NK7Gravity15set_mass_offsetEN5amrex4RealEb"></span><span id="Gravity::set_mass_offset__amrex::Real.bC"></span><span class="target" id="classGravity_1aeaa180317acd78d9135b5aa4be87e390"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_mass_offset</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">multi_level</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity15set_mass_offsetEN5amrex4RealEb" title="Link to this definition"></a><br /></dt>
<dd><p>Set the <code class="docutils literal notranslate"><span class="pre">mass_offset</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – Current time </p></li>
<li><p><strong>multi_level</strong> – boolean, do we iterate over all levels or mask off fine grids? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity17get_grad_phi_prevEi">
<span id="_CPPv3N7Gravity17get_grad_phi_prevEi"></span><span id="_CPPv2N7Gravity17get_grad_phi_prevEi"></span><span id="Gravity::get_grad_phi_prev__i"></span><span class="target" id="classGravity_1af6b52eceb0807da0a25371f0363960d5"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_grad_phi_prev</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity17get_grad_phi_prevEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">grad_phi_prev</span></code> at given level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – level index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity17get_grad_phi_currEi">
<span id="_CPPv3N7Gravity17get_grad_phi_currEi"></span><span id="_CPPv2N7Gravity17get_grad_phi_currEi"></span><span id="Gravity::get_grad_phi_curr__i"></span><span class="target" id="classGravity_1a299e10eddc197d7d6450e43cf179badf"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_grad_phi_curr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity17get_grad_phi_currEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">grad_phi_curr</span></code> at given level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – level index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity22get_grad_phi_prev_compEii">
<span id="_CPPv3N7Gravity22get_grad_phi_prev_compEii"></span><span id="_CPPv2N7Gravity22get_grad_phi_prev_compEii"></span><span id="Gravity::get_grad_phi_prev_comp__i.i"></span><span class="target" id="classGravity_1aa7362b4e3aa6842f3994e0f436cd0669"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_grad_phi_prev_comp</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity22get_grad_phi_prev_compEii" title="Link to this definition"></a><br /></dt>
<dd><p>Return given component of <code class="docutils literal notranslate"><span class="pre">grad_phi_prev</span></code> at given level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – level index </p></li>
<li><p><strong>comp</strong> – component index </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity18plus_grad_phi_currEiRN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE">
<span id="_CPPv3N7Gravity18plus_grad_phi_currEiRN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"></span><span id="_CPPv2N7Gravity18plus_grad_phi_currEiRN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"></span><span id="Gravity::plus_grad_phi_curr__i.amrex::Vector:std::unique_ptr:amrex::MultiFab::R"></span><span class="target" id="classGravity_1ad8e605bd62ad5935caf8e0bfc2f9fcaa"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">plus_grad_phi_curr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">addend</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity18plus_grad_phi_currEiRN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">grad_phi_curr</span></code> at given level plus the given vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – level index </p></li>
<li><p><strong>addend</strong> – Vector of MultiFabs to add to grad phi </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity14swapTimeLevelsEi">
<span id="_CPPv3N7Gravity14swapTimeLevelsEi"></span><span id="_CPPv2N7Gravity14swapTimeLevelsEi"></span><span id="Gravity::swapTimeLevels__i"></span><span class="target" id="classGravity_1a49175c8beb9c0bb05c966d3c8a457714"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">swapTimeLevels</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity14swapTimeLevelsEi" title="Link to this definition"></a><br /></dt>
<dd><p>Swap <code class="docutils literal notranslate"><span class="pre">grad_phi_prev</span></code> with <code class="docutils literal notranslate"><span class="pre">grad_phi_curr</span></code> at given level at set new <code class="docutils literal notranslate"><span class="pre">grad_phi_curr</span></code> to 1.e50.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – level index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity14update_max_rhsEv">
<span id="_CPPv3N7Gravity14update_max_rhsEv"></span><span id="_CPPv2N7Gravity14update_max_rhsEv"></span><span id="Gravity::update_max_rhs"></span><span class="target" id="classGravity_1ad9772a4cc6b5451d7326e9579a851498"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update_max_rhs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity14update_max_rhsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Calculate the maximum value of the RHS over all levels. This should only be called at a synchronization point where all <a class="reference internal" href="../file/Castro_8H.html#classCastro"><span class="std std-ref">Castro</span></a> levels have valid new time data at the same simulation time. The RHS we will use is the density multiplied by 4*pi*G and also multiplied by the metric terms, just as it would be in a real solve. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity13solve_for_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEEi">
<span id="_CPPv3N7Gravity13solve_for_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEEi"></span><span id="_CPPv2N7Gravity13solve_for_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEEi"></span><span id="Gravity::solve_for_phi__i.amrex::MultiFabR.amrex::Vector:amrex::MultiFabP:CR.i"></span><span class="target" id="classGravity_1a37ad9f53a26eb6b17cb19304abfa18ee"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_for_phi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grad_phi</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity13solve_for_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Solve Poisson’s equation to find the gravitational potential</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – level index </p></li>
<li><p><strong>phi</strong> – MultiFab to store gravitational potential in </p></li>
<li><p><strong>grad_phi</strong> – Vector of MultiFabs, <span class="math notranslate nohighlight">\( \nabla \Phi \)</span></p></li>
<li><p><strong>is_new</strong> – do we use state data at current time (1) or old time (0)? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19solve_for_delta_phiEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEE">
<span id="_CPPv3N7Gravity19solve_for_delta_phiEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEE"></span><span id="_CPPv2N7Gravity19solve_for_delta_phiEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEE"></span><span id="Gravity::solve_for_delta_phi__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::Vector:amrex::MultiFabP::CR"></span><span class="target" id="classGravity_1af3dd8b55d14d1b2012ae4726b36f274b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_for_delta_phi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rhs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">delta_phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grad_delta_phi</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19solve_for_delta_phiEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Find delta phi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – index of coarse level </p></li>
<li><p><strong>fine_level</strong> – index of fine level </p></li>
<li><p><strong>rhs</strong> – Vector of MultiFabs with right hand side source terms </p></li>
<li><p><strong>delta_phi</strong> – Vector of MultiFabs delta phi will be saved to </p></li>
<li><p><strong>grad_delta_phi</strong> – Vector of MultiFabs, gradient of delta phi </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity12gravity_syncEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEE">
<span id="_CPPv3N7Gravity12gravity_syncEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="_CPPv2N7Gravity12gravity_syncEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="Gravity::gravity_sync__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::MultiFabP:CR"></span><span class="target" id="classGravity_1a0d5d355f09450256664231c775a71e73"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravity_sync</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drho</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dphi</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity12gravity_syncEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Sync gravity across levels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – index of coarse level </p></li>
<li><p><strong>fine_level</strong> – index of fine level </p></li>
<li><p><strong>drho</strong> – </p></li>
<li><p><strong>dphi</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity28multilevel_solve_for_new_phiEii">
<span id="_CPPv3N7Gravity28multilevel_solve_for_new_phiEii"></span><span id="_CPPv2N7Gravity28multilevel_solve_for_new_phiEii"></span><span id="Gravity::multilevel_solve_for_new_phi__i.i"></span><span class="target" id="classGravity_1a08f9dee748537aeb33feede1cf271514"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">multilevel_solve_for_new_phi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finest_level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity28multilevel_solve_for_new_phiEii" title="Link to this definition"></a><br /></dt>
<dd><p>Multilevel solve for new phi from base level to finest level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Base level index </p></li>
<li><p><strong>finest_level</strong> – Fine level index </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity23actual_multilevel_solveEiiRKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEEi">
<span id="_CPPv3N7Gravity23actual_multilevel_solveEiiRKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEEi"></span><span id="_CPPv2N7Gravity23actual_multilevel_solveEiiRKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEEi"></span><span id="Gravity::actual_multilevel_solve__i.i.amrex::Vector:amrex::Vector:amrex::MultiFabP::CR.i"></span><span class="target" id="classGravity_1a95af86999d23bafb7fbd8e37f6ce6eea"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">actual_multilevel_solve</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">finest_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grad_phi</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity23actual_multilevel_solveEiiRKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Actually do the multilevel solve for new phi from base level to finest level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Base level index </p></li>
<li><p><strong>finest_level</strong> – Fine level index </p></li>
<li><p><strong>grad_phi</strong> – gradient of phi </p></li>
<li><p><strong>is_new</strong> – Should we use the new state (1) or previous state (0)? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity32create_comp_minus_level_grad_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabERN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE">
<span id="_CPPv3N7Gravity32create_comp_minus_level_grad_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabERN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"></span><span id="_CPPv2N7Gravity32create_comp_minus_level_grad_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabERN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE"></span><span id="Gravity::create_comp_minus_level_grad_phi__i.amrex::MultiFabR.amrex::Vector:amrex::MultiFabP:CR.amrex::MultiFabR.amrex::Vector:std::unique_ptr:amrex::MultiFab::R"></span><span class="target" id="classGravity_1a0c85cbb83ab77d5796534888ebadb341"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_comp_minus_level_grad_phi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">comp_phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">comp_gphi</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">comp_minus_level_phi</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">comp_minus_level_grad_phi</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity32create_comp_minus_level_grad_phiEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabERN5amrex6VectorINSt10unique_ptrIN5amrex8MultiFabEEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the difference between level and composite solves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – level index </p></li>
<li><p><strong>comp_phi</strong> – MultiFab containing computed phi </p></li>
<li><p><strong>comp_gphi</strong> – Vector of MultiFabs containing computed grad phi </p></li>
<li><p><strong>comp_minus_level_phi</strong> – MultiFab, computed minus level phi </p></li>
<li><p><strong>comp_minus_level_grad_phi</strong> – Vector of MultiFabs, computed minus level grad phi </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity10GetCrsePhiEiRN5amrex8MultiFabEN5amrex4RealE">
<span id="_CPPv3N7Gravity10GetCrsePhiEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="_CPPv2N7Gravity10GetCrsePhiEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="Gravity::GetCrsePhi__i.amrex::MultiFabR.amrex::Real"></span><span class="target" id="classGravity_1a3102719dfc6a286432419c57a6132583"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetCrsePhi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi_crse</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity10GetCrsePhiEiRN5amrex8MultiFabEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Get coarse phi on level <code class="docutils literal notranslate"><span class="pre">level</span></code>-1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – level index of fine data </p></li>
<li><p><strong>phi_crse</strong> – MultiFab to contain coarse phi </p></li>
<li><p><strong>time</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19get_old_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE">
<span id="_CPPv3N7Gravity19get_old_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="_CPPv2N7Gravity19get_old_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="Gravity::get_old_grav_vector__i.amrex::MultiFabR.amrex::Real"></span><span class="target" id="classGravity_1afd769b96df67586649b086de75bd25fd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_old_grav_vector</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grav_vector</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19get_old_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Get old gravity vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>grav_vector</strong> – MultiFab containing gravity vector </p></li>
<li><p><strong>time</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19get_new_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE">
<span id="_CPPv3N7Gravity19get_new_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="_CPPv2N7Gravity19get_new_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE"></span><span id="Gravity::get_new_grav_vector__i.amrex::MultiFabR.amrex::Real"></span><span class="target" id="classGravity_1a517300a35456457611f7dffcdda34870"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_new_grav_vector</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grav_vector</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19get_new_grav_vectorEiRN5amrex8MultiFabEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Get new gravity vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>grav_vector</strong> – MultiFab containing gravity vector </p></li>
<li><p><strong>time</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity24test_level_grad_phi_prevEi">
<span id="_CPPv3N7Gravity24test_level_grad_phi_prevEi"></span><span id="_CPPv2N7Gravity24test_level_grad_phi_prevEi"></span><span id="Gravity::test_level_grad_phi_prev__i"></span><span class="target" id="classGravity_1accd3fe5ed76e322701a8059b1c4985cd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_level_grad_phi_prev</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity24test_level_grad_phi_prevEi" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity24test_level_grad_phi_currEi">
<span id="_CPPv3N7Gravity24test_level_grad_phi_currEi"></span><span id="_CPPv2N7Gravity24test_level_grad_phi_currEi"></span><span id="Gravity::test_level_grad_phi_curr__i"></span><span class="target" id="classGravity_1a2f975567560fbda454a7672a19f0b20b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_level_grad_phi_curr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity24test_level_grad_phi_currEi" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity18test_composite_phiEi">
<span id="_CPPv3N7Gravity18test_composite_phiEi"></span><span id="_CPPv2N7Gravity18test_composite_phiEi"></span><span id="Gravity::test_composite_phi__i"></span><span class="target" id="classGravity_1a8158e49f8e38335da83ad6863d37cd85"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_composite_phi</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity18test_composite_phiEi" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity28average_fine_ec_onto_crse_ecEii">
<span id="_CPPv3N7Gravity28average_fine_ec_onto_crse_ecEii"></span><span id="_CPPv2N7Gravity28average_fine_ec_onto_crse_ecEii"></span><span id="Gravity::average_fine_ec_onto_crse_ec__i.i"></span><span class="target" id="classGravity_1a46a37eac5cf80f96ecaabbf564d47fb0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">average_fine_ec_onto_crse_ec</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity28average_fine_ec_onto_crse_ecEii" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>is_new</strong> – Use new state data (1) or old state data (0)? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19make_radial_gravityEiN5amrex4RealER10RealVector">
<span id="_CPPv3N7Gravity19make_radial_gravityEiN5amrex4RealER10RealVector"></span><span id="_CPPv2N7Gravity19make_radial_gravityEiN5amrex4RealER10RealVector"></span><span id="Gravity::make_radial_gravity__i.amrex::Real.RealVectorR"></span><span class="target" id="classGravity_1a378aab2e7f1d2e1805706cdd7fa67e19"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_radial_gravity</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">radial_grav</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19make_radial_gravityEiN5amrex4RealER10RealVector" title="Link to this definition"></a><br /></dt>
<dd><p>Make radial gravity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>time</strong> – Current time </p></li>
<li><p><strong>radial_grav</strong> – Vector containing gravity in radial direction </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity25interpolate_monopole_gravEiR10RealVectorRN5amrex8MultiFabE">
<span id="_CPPv3NK7Gravity25interpolate_monopole_gravEiR10RealVectorRN5amrex8MultiFabE"></span><span id="_CPPv2NK7Gravity25interpolate_monopole_gravEiR10RealVectorRN5amrex8MultiFabE"></span><span id="Gravity::interpolate_monopole_grav__i.RealVectorR.amrex::MultiFabRC"></span><span class="target" id="classGravity_1aa7b2a645b1a926f4ad39be87a14d2f35"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate_monopole_grav</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">radial_grav</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grav_vector</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity25interpolate_monopole_gravEiR10RealVectorRN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolate monopole gravitational field in the radial direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>radial_grav</strong> – Radial gravity </p></li>
<li><p><strong>grav_vector</strong> – <a class="reference internal" href="../file/Gravity_8H.html#classGravity"><span class="std std-ref">Gravity</span></a> vector </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity19compute_radial_massERKN5amrex3BoxEKN5amrex6Array4IKN5amrex4RealEEER10RealVectorR10RealVectorR10RealVectorii">
<span id="_CPPv3NK7Gravity19compute_radial_massERKN5amrex3BoxEKN5amrex6Array4IKN5amrex4RealEEER10RealVectorR10RealVectorR10RealVectorii"></span><span id="_CPPv2NK7Gravity19compute_radial_massERKN5amrex3BoxEKN5amrex6Array4IKN5amrex4RealEEER10RealVectorR10RealVectorR10RealVectorii"></span><span id="Gravity::compute_radial_mass__amrex::BoxCR.amrex::Array4:amrex::RealC:C.RealVectorR.RealVectorR.RealVectorR.i.iC"></span><span class="target" id="classGravity_1aaddc52f1589ada1dc60c1300a8fe1ae7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_radial_mass</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Box</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">u</span></span>, <a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">radial_mass</span></span>, <a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">radial_vol</span></span>, <a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">radial_pres</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n1d</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity19compute_radial_massERKN5amrex3BoxEKN5amrex6Array4IKN5amrex4RealEEER10RealVectorR10RealVectorR10RealVectorii" title="Link to this definition"></a><br /></dt>
<dd><p>Integrate radially outward to find radial mass distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bx</strong> – Box </p></li>
<li><p><strong>u</strong> – Density (RHS of Poisson’s equation) </p></li>
<li><p><strong>radial_mass</strong> – Radially integrated mass </p></li>
<li><p><strong>radial_vol</strong> – Radially integrated volume </p></li>
<li><p><strong>radial_pres</strong> – Radially integrated pressure </p></li>
<li><p><strong>n1d</strong> – Number of radial points in the domain </p></li>
<li><p><strong>level</strong> – Level index </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity18fill_multipole_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE">
<span id="_CPPv3N7Gravity18fill_multipole_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"></span><span id="_CPPv2N7Gravity18fill_multipole_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"></span><span id="Gravity::fill_multipole_BCs__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::MultiFabR"></span><span class="target" id="classGravity_1a036c8842605734f1b2082c1f8cf8793b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fill_multipole_BCs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Rhs</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity18fill_multipole_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Implement multipole boundary conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – </p></li>
<li><p><strong>fine_level</strong> – </p></li>
<li><p><strong>Rhs</strong> – </p></li>
<li><p><strong>phi</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity19init_multipole_gravEv">
<span id="_CPPv3NK7Gravity19init_multipole_gravEv"></span><span id="_CPPv2NK7Gravity19init_multipole_gravEv"></span><span id="Gravity::init_multipole_gravC"></span><span class="target" id="classGravity_1ade34106c99c59d90d50cada82157800d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init_multipole_grav</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity19init_multipole_gravEv" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize multipole gravity </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19fill_direct_sum_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE">
<span id="_CPPv3N7Gravity19fill_direct_sum_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"></span><span id="_CPPv2N7Gravity19fill_direct_sum_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE"></span><span id="Gravity::fill_direct_sum_BCs__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::MultiFabR"></span><span class="target" id="classGravity_1a574779b21f04b3d844ff62aecc6be9a1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fill_direct_sum_BCs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Rhs</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19fill_direct_sum_BCsEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute and fill direct sum boundary conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – Index of coarse level </p></li>
<li><p><strong>fine_level</strong> – Index of fine level </p></li>
<li><p><strong>Rhs</strong> – Vector of MultiFabs, right hand side </p></li>
<li><p><strong>phi</strong> – MultiFab, phi </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity10make_mg_bcEv">
<span id="_CPPv3N7Gravity10make_mg_bcEv"></span><span id="_CPPv2N7Gravity10make_mg_bcEv"></span><span id="Gravity::make_mg_bc"></span><span class="target" id="classGravity_1afe42c53b873e967735b52f6e9523be95"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_mg_bc</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity10make_mg_bcEv" title="Link to this definition"></a><br /></dt>
<dd><p>Make multigrid boundary conditions </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity16applyMetricTermsEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEE">
<span id="_CPPv3NK7Gravity16applyMetricTermsEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="_CPPv2NK7Gravity16applyMetricTermsEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="Gravity::applyMetricTerms__i.amrex::MultiFabR.amrex::Vector:amrex::MultiFabP:CRC"></span><span class="target" id="classGravity_1a8492b88edcf2f63701d9a51e18c4cd64"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">applyMetricTerms</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Rhs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity16applyMetricTermsEiRN5amrex8MultiFabERKN5amrex6VectorIPN5amrex8MultiFabEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Modify Rhs and coeffs with the appropriate metric terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Level index </p></li>
<li><p><strong>Rhs</strong> – MultiFab </p></li>
<li><p><strong>coeffs</strong> – Vector of MultiFabs </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity11unweight_ccEiRN5amrex8MultiFabE">
<span id="_CPPv3NK7Gravity11unweight_ccEiRN5amrex8MultiFabE"></span><span id="_CPPv2NK7Gravity11unweight_ccEiRN5amrex8MultiFabE"></span><span id="Gravity::unweight_cc__i.amrex::MultiFabRC"></span><span class="target" id="classGravity_1a9c7b7825a5f54cc6744622303631dc00"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unweight_cc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cc</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity11unweight_ccEiRN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Index of level </p></li>
<li><p><strong>cc</strong> – Cell-centered data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity14unweight_edgesEiRKN5amrex6VectorIPN5amrex8MultiFabEEE">
<span id="_CPPv3NK7Gravity14unweight_edgesEiRKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="_CPPv2NK7Gravity14unweight_edgesEiRKN5amrex6VectorIPN5amrex8MultiFabEEE"></span><span id="Gravity::unweight_edges__i.amrex::Vector:amrex::MultiFabP:CRC"></span><span class="target" id="classGravity_1ac4372882ee98eaaf36472e55eef0b636"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unweight_edges</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">edges</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity14unweight_edgesEiRKN5amrex6VectorIPN5amrex8MultiFabEEE" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Index of level </p></li>
<li><p><strong>edges</strong> – Edge-based data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity24add_pointmass_to_gravityEiRN5amrex8MultiFabERN5amrex8MultiFabE">
<span id="_CPPv3NK7Gravity24add_pointmass_to_gravityEiRN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="_CPPv2NK7Gravity24add_pointmass_to_gravityEiRN5amrex8MultiFabERN5amrex8MultiFabE"></span><span id="Gravity::add_pointmass_to_gravity__i.amrex::MultiFabR.amrex::MultiFabRC"></span><span class="target" id="classGravity_1a48daca5707ad1eb91e483aafb066412c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add_pointmass_to_gravity</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grav_vector</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity24add_pointmass_to_gravityEiRN5amrex8MultiFabERN5amrex8MultiFabE" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – Index of level </p></li>
<li><p><strong>phi</strong> – Gravitational potential </p></li>
<li><p><strong>grav_vector</strong> – <a class="reference internal" href="../file/Gravity_8H.html#classGravity"><span class="std std-ref">Gravity</span></a> vector </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7get_rhsEiii">
<span id="_CPPv3N7Gravity7get_rhsEiii"></span><span id="_CPPv2N7Gravity7get_rhsEiii"></span><span id="Gravity::get_rhs__i.i.i"></span><span class="target" id="classGravity_1a3909178340351c72f997356cc4e3c830"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_rhs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlevs</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">is_new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity7get_rhsEiii" title="Link to this definition"></a><br /></dt>
<dd><p>Get the rhs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – Index of coarse level </p></li>
<li><p><strong>nlevs</strong> – Number of levels </p></li>
<li><p><strong>is_new</strong> – Use new (1) or old (0) state data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity12sanity_checkEi">
<span id="_CPPv3N7Gravity12sanity_checkEi"></span><span id="_CPPv2N7Gravity12sanity_checkEi"></span><span id="Gravity::sanity_check__i"></span><span class="target" id="classGravity_1a46368f0b449d04582cf1b68871a25a5b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sanity_check</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity12sanity_checkEi" title="Link to this definition"></a><br /></dt>
<dd><p>This is a sanity check on whether we are trying to fill multipole boundary conditiosn for grids at this level &gt; 0 &amp;#8212; this case is not currently supported. Here we shrink the domain at this level by 1 in any direction which is not symmetry or periodic, then ask if the grids at this level are contained in the shrunken domain. If not, then grids at this level touch the domain boundary and we must abort.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – Level index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7Gravity22actual_solve_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPKN5amrex8MultiFabEEERKN5amrex6VectorINSt5arrayIPN5amrex8MultiFabE14AMREX_SPACEDIMEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEPCKN5amrex8MultiFabEN5amrex4RealEN5amrex4RealE">
<span id="_CPPv3NK7Gravity22actual_solve_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPKN5amrex8MultiFabEEERKN5amrex6VectorINSt5arrayIPN5amrex8MultiFabE14AMREX_SPACEDIMEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEPCKN5amrex8MultiFabEN5amrex4RealEN5amrex4RealE"></span><span id="_CPPv2NK7Gravity22actual_solve_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPKN5amrex8MultiFabEEERKN5amrex6VectorINSt5arrayIPN5amrex8MultiFabE14AMREX_SPACEDIMEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEPCKN5amrex8MultiFabEN5amrex4RealEN5amrex4RealE"></span><span id="Gravity::actual_solve_with_mlmg__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::MultiFabCP:CR.amrex::Vector:std::array:amrex::MultiFabP.AMREX_SPACEDIM::CR.amrex::Vector:amrex::MultiFabP:CR.amrex::MultiFabCPC.amrex::Real.amrex::RealC"></span><span class="target" id="classGravity_1a2adfa64f9fb60cc3b21554b13f8cd806"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">actual_solve_with_mlmg</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rhs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">AMREX_SPACEDIM</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grad_phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_bcdata</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rel_eps</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">abs_eps</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7Gravity22actual_solve_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPKN5amrex8MultiFabEEERKN5amrex6VectorINSt5arrayIPN5amrex8MultiFabE14AMREX_SPACEDIMEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEPCKN5amrex8MultiFabEN5amrex4RealEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Do multigrid solve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – Coarse level index </p></li>
<li><p><strong>fine_level</strong> – Fine level index </p></li>
<li><p><strong>phi</strong> – Gravitational potential </p></li>
<li><p><strong>rhs</strong> – Right hand side </p></li>
<li><p><strong>grad_phi</strong> – Grad phi </p></li>
<li><p><strong>res</strong> – </p></li>
<li><p><strong>crse_bcdata</strong> – </p></li>
<li><p><strong>rel_eps</strong> – Relative tolerance </p></li>
<li><p><strong>abs_eps</strong> – Absolute tolerance </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19solve_phi_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEN5amrex4RealE">
<span id="_CPPv3N7Gravity19solve_phi_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEN5amrex4RealE"></span><span id="_CPPv2N7Gravity19solve_phi_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEN5amrex4RealE"></span><span id="Gravity::solve_phi_with_mlmg__i.i.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::MultiFabP:CR.amrex::Vector:amrex::Vector:amrex::MultiFabP::CR.amrex::Vector:amrex::MultiFabP:CR.amrex::Real"></span><span class="target" id="classGravity_1a0f10081c07c5037f65233086647ca262"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_phi_with_mlmg</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">crse_level</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fine_level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rhs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grad_phi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19solve_phi_with_mlmgEiiRKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIPN5amrex8MultiFabEEERKN5amrex6VectorIN5amrex6VectorIPN5amrex8MultiFabEEEEERKN5amrex6VectorIPN5amrex8MultiFabEEEN5amrex4RealE" title="Link to this definition"></a><br /></dt>
<dd><p>Do multigrid solve to find phi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crse_level</strong> – Coarse level index </p></li>
<li><p><strong>fine_level</strong> – Fine level index </p></li>
<li><p><strong>phi</strong> – Gravitational potential </p></li>
<li><p><strong>rhs</strong> – Right hand side source term </p></li>
<li><p><strong>grad_phi</strong> – Grad phi </p></li>
<li><p><strong>res</strong> – </p></li>
<li><p><strong>time</strong> – Current time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity6parentE">
<span id="_CPPv3N7Gravity6parentE"></span><span id="_CPPv2N7Gravity6parentE"></span><span id="Gravity::parent__amrex::AmrP"></span><span class="target" id="classGravity_1aabb853453b6ec4af0e0c4c4cce0709a8"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Amr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity6parentE" title="Link to this definition"></a><br /></dt>
<dd><p>Pointers to amr,amrlevel. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity9LevelDataE">
<span id="_CPPv3N7Gravity9LevelDataE"></span><span id="_CPPv2N7Gravity9LevelDataE"></span><span id="Gravity::LevelData__amrex::Vector:amrex::AmrLevelP:"></span><span class="target" id="classGravity_1adc94a9198e6dd967c1fa15c1e582aca5"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AmrLevel</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LevelData</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity9LevelDataE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity13grad_phi_currE">
<span id="_CPPv3N7Gravity13grad_phi_currE"></span><span id="_CPPv2N7Gravity13grad_phi_currE"></span><span id="Gravity::grad_phi_curr__amrex::Vector:amrex::Vector:std::unique_ptr:amrex::MultiFab:::"></span><span class="target" id="classGravity_1ac5726f2f29f2503f7640fbced9a9565a"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">grad_phi_curr</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity13grad_phi_currE" title="Link to this definition"></a><br /></dt>
<dd><p>Pointers to grad_phi at previous and current time </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity13grad_phi_prevE">
<span id="_CPPv3N7Gravity13grad_phi_prevE"></span><span id="_CPPv2N7Gravity13grad_phi_prevE"></span><span id="Gravity::grad_phi_prev__amrex::Vector:amrex::Vector:std::unique_ptr:amrex::MultiFab:::"></span><span class="target" id="classGravity_1a6e09f9e6f28784c6866b5b76db4c805c"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">grad_phi_prev</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity13grad_phi_prevE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity5gridsE">
<span id="_CPPv3N7Gravity5gridsE"></span><span id="_CPPv2N7Gravity5gridsE"></span><span id="Gravity::grids__amrex::Vector:amrex::BoxArray:CR"></span><span class="target" id="classGravity_1ae2070a6eb8f95b031b97e8f990843f58"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BoxArray</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">grids</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity5gridsE" title="Link to this definition"></a><br /></dt>
<dd><p>BoxArray at each level </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity4dmapE">
<span id="_CPPv3N7Gravity4dmapE"></span><span id="_CPPv2N7Gravity4dmapE"></span><span id="Gravity::dmap__amrex::Vector:amrex::DistributionMapping:CR"></span><span class="target" id="classGravity_1a363b6786e53f09fbf005f2c79ed5ee5d"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistributionMapping</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">dmap</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity4dmapE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7abs_tolE">
<span id="_CPPv3N7Gravity7abs_tolE"></span><span id="_CPPv2N7Gravity7abs_tolE"></span><span id="Gravity::abs_tol__amrex::Vector:amrex::Real:"></span><span class="target" id="classGravity_1accae19618c30f607e7ac4e47050eb595"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abs_tol</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity7abs_tolE" title="Link to this definition"></a><br /></dt>
<dd><p>Absolute tolerance on each level </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7rel_tolE">
<span id="_CPPv3N7Gravity7rel_tolE"></span><span id="_CPPv2N7Gravity7rel_tolE"></span><span id="Gravity::rel_tol__amrex::Vector:amrex::Real:"></span><span class="target" id="classGravity_1a4d63ad1a4cc39651078e4773cbe52726"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rel_tol</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity7rel_tolE" title="Link to this definition"></a><br /></dt>
<dd><p>Relative tolerance on each level </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity20level_solver_resnormE">
<span id="_CPPv3N7Gravity20level_solver_resnormE"></span><span id="_CPPv2N7Gravity20level_solver_resnormE"></span><span id="Gravity::level_solver_resnorm__amrex::Vector:amrex::Real:"></span><span class="target" id="classGravity_1a183711252629be95b0954e69c88b6d45"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">level_solver_resnorm</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity20level_solver_resnormE" title="Link to this definition"></a><br /></dt>
<dd><p>Resnorm at each level </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7max_rhsE">
<span id="_CPPv3N7Gravity7max_rhsE"></span><span id="_CPPv2N7Gravity7max_rhsE"></span><span id="Gravity::max_rhs__amrex::Real"></span><span class="target" id="classGravity_1ac484ef01613aa2986725ae0e17772d06"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_rhs</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity7max_rhsE" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum value of the RHS (used for obtaining absolute tolerances) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity6volumeE">
<span id="_CPPv3N7Gravity6volumeE"></span><span id="_CPPv2N7Gravity6volumeE"></span><span id="Gravity::volume__amrex::Vector:amrex::MultiFabP:"></span><span class="target" id="classGravity_1a0162d79d186b86381a163fd48a2f1044"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">volume</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity6volumeE" title="Link to this definition"></a><br /></dt>
<dd><p>Volume and area fractions. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity4areaE">
<span id="_CPPv3N7Gravity4areaE"></span><span id="_CPPv2N7Gravity4areaE"></span><span id="Gravity::area__amrex::Vector:amrex::MultiFabP:"></span><span class="target" id="classGravity_1ab84fd1b4eb0dad59259db65e436a220a"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MultiFab</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">area</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity4areaE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7DensityE">
<span id="_CPPv3N7Gravity7DensityE"></span><span id="_CPPv2N7Gravity7DensityE"></span><span id="Gravity::Density__i"></span><span class="target" id="classGravity_1a027d336b24e6c7393eed151a6a415ae8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Density</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity7DensityE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity22finest_level_allocatedE">
<span id="_CPPv3N7Gravity22finest_level_allocatedE"></span><span id="_CPPv2N7Gravity22finest_level_allocatedE"></span><span id="Gravity::finest_level_allocated__i"></span><span class="target" id="classGravity_1a79dc456ce35ab432cc1bec772f001cd7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finest_level_allocated</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity22finest_level_allocatedE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity7phys_bcE">
<span id="_CPPv3N7Gravity7phys_bcE"></span><span id="_CPPv2N7Gravity7phys_bcE"></span><span id="Gravity::phys_bc__amrex::BCRecP"></span><span class="target" id="classGravity_1a6d41ecceba6c104316eddedae0a2867b"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BCRec</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">phys_bc</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity7phys_bcE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity9mlmg_lobcE">
<span id="_CPPv3N7Gravity9mlmg_lobcE"></span><span id="_CPPv2N7Gravity9mlmg_lobcE"></span><span id="Gravity::mlmg_lobc__std::array:amrex::MLLinOp::BCType.AMREX_SPACEDIM:"></span><span class="target" id="classGravity_1a4ffacfd0a49e17ed02232088b41c5140"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MLLinOp</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BCType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">AMREX_SPACEDIM</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mlmg_lobc</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity9mlmg_lobcE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity9mlmg_hibcE">
<span id="_CPPv3N7Gravity9mlmg_hibcE"></span><span id="_CPPv2N7Gravity9mlmg_hibcE"></span><span id="Gravity::mlmg_hibc__std::array:amrex::MLLinOp::BCType.AMREX_SPACEDIM:"></span><span class="target" id="classGravity_1a8cff1c275aec86c6ee88a49fb0328b3d"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MLLinOp</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">BCType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">AMREX_SPACEDIM</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mlmg_hibc</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity9mlmg_hibcE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity15numpts_at_levelE">
<span id="_CPPv3N7Gravity15numpts_at_levelE"></span><span id="_CPPv2N7Gravity15numpts_at_levelE"></span><span id="Gravity::numpts_at_level__i"></span><span class="target" id="classGravity_1af15548dc68ffca9c3015cc32208e4541"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">numpts_at_level</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity15numpts_at_levelE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity15radial_grav_oldE">
<span id="_CPPv3N7Gravity15radial_grav_oldE"></span><span id="_CPPv2N7Gravity15radial_grav_oldE"></span><span id="Gravity::radial_grav_old__amrex::Vector:RealVector:"></span><span class="target" id="classGravity_1aad304a1fc75cdfd3cdb963f00aecd9f2"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">radial_grav_old</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity15radial_grav_oldE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity15radial_grav_newE">
<span id="_CPPv3N7Gravity15radial_grav_newE"></span><span id="_CPPv2N7Gravity15radial_grav_newE"></span><span id="Gravity::radial_grav_new__amrex::Vector:RealVector:"></span><span class="target" id="classGravity_1ad23d8234a75f4e4adabcae11b4c7c9fa"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">radial_grav_new</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity15radial_grav_newE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity11radial_massE">
<span id="_CPPv3N7Gravity11radial_massE"></span><span id="_CPPv2N7Gravity11radial_massE"></span><span id="Gravity::radial_mass__amrex::Vector:RealVector:"></span><span class="target" id="classGravity_1a46930329fee38a58a0851dbbd8917d88"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">radial_mass</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity11radial_massE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity10radial_volE">
<span id="_CPPv3N7Gravity10radial_volE"></span><span id="_CPPv2N7Gravity10radial_volE"></span><span id="Gravity::radial_vol__amrex::Vector:RealVector:"></span><span class="target" id="classGravity_1a37fae5475a1e5627f18b8674cc95b0bc"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">radial_vol</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity10radial_volE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity11radial_presE">
<span id="_CPPv3N7Gravity11radial_presE"></span><span id="_CPPv2N7Gravity11radial_presE"></span><span id="Gravity::radial_pres__amrex::Vector:RealVector:"></span><span class="target" id="classGravity_1a26b8b6b0d575266e3c5d949504cc3749"></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Gravity_8H.html#_CPPv410RealVector" title="RealVector"><span class="n"><span class="pre">RealVector</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">radial_pres</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity11radial_presE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity22output_job_info_paramsERNSt7ostreamE">
<span id="_CPPv3N7Gravity22output_job_info_paramsERNSt7ostreamE"></span><span id="_CPPv2N7Gravity22output_job_info_paramsERNSt7ostreamE"></span><span id="Gravity::output_job_info_params__osR"></span><span class="target" id="classGravity_1ac952ff3ed1a0b5316d2e3da8c8c2642c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">output_job_info_params</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ostream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">jobInfoFile</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity22output_job_info_paramsERNSt7ostreamE" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>jobInfoFile</strong> – std::ostream object </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity16get_gravity_typeEv">
<span id="_CPPv3N7Gravity16get_gravity_typeEv"></span><span id="_CPPv2N7Gravity16get_gravity_typeEv"></span><span id="Gravity::get_gravity_type"></span><span class="target" id="classGravity_1a8acf20db6265b0e7482988e12ba05f98"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_gravity_type</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity16get_gravity_typeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">gravity_type</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity19get_max_solve_levelEv">
<span id="_CPPv3N7Gravity19get_max_solve_levelEv"></span><span id="_CPPv2N7Gravity19get_max_solve_levelEv"></span><span id="Gravity::get_max_solve_level"></span><span class="target" id="classGravity_1ad6385907e21039d8249c2e5aa3bf64b5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_max_solve_level</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity19get_max_solve_levelEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">max_solve_level</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity6NoSyncEv">
<span id="_CPPv3N7Gravity6NoSyncEv"></span><span id="_CPPv2N7Gravity6NoSyncEv"></span><span id="Gravity::NoSync"></span><span class="target" id="classGravity_1a0cb55610051f165a0cf5ea41bff6edd0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">NoSync</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity6NoSyncEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">no_sync</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity21DoCompositeCorrectionEv">
<span id="_CPPv3N7Gravity21DoCompositeCorrectionEv"></span><span id="_CPPv2N7Gravity21DoCompositeCorrectionEv"></span><span id="Gravity::DoCompositeCorrection"></span><span class="target" id="classGravity_1a24ab70544b4e5c27d876797ee5795d56"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DoCompositeCorrection</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity21DoCompositeCorrectionEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">do_composite_phi_correction</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity22test_results_of_solvesEv">
<span id="_CPPv3N7Gravity22test_results_of_solvesEv"></span><span id="_CPPv2N7Gravity22test_results_of_solvesEv"></span><span id="Gravity::test_results_of_solves"></span><span class="target" id="classGravity_1a6789fc6db678fd764f87938db928a2d5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_results_of_solves</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity22test_results_of_solvesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">test_solves</span></code></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity13test_residualERKN5amrex3BoxERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEi">
<span id="_CPPv3N7Gravity13test_residualERKN5amrex3BoxERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEi"></span><span id="_CPPv2N7Gravity13test_residualERKN5amrex3BoxERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEi"></span><span id="Gravity::test_residual__amrex::BoxCR.amrex::Array4:amrex::Real:CR.amrex::Array4:amrex::Real:CR.amrex::Array4:amrex::Real:CR.amrex::Array4:amrex::Real:CR.amrex::GpuArray:amrex::Real.AMREX_SPACEDIM:.amrex::GpuArray:amrex::Real.AMREX_SPACEDIM:.i"></span><span class="target" id="classGravity_1a186253e68b40b5c867f2e1b053729092"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_residual</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Box</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rhs</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ecx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ecy</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Array4</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ecz</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">GpuArray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">AMREX_SPACEDIM</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dx</span></span>, <a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">GpuArray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">AMREX_SPACEDIM</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">problo</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">coord_type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7Gravity13test_residualERKN5amrex3BoxERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEERKN5amrex6Array4IN5amrex4RealEEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEN5amrex8GpuArrayIN5amrex4RealE14AMREX_SPACEDIMEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Test whether using the edge-based gradients to compute Div(Grad(Phi)) satisfies Lap(phi) = RHS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bx</strong> – box </p></li>
<li><p><strong>rhs</strong> – right-hand-side </p></li>
<li><p><strong>ecx</strong> – gradients wrt x </p></li>
<li><p><strong>ecy</strong> – gradients wrt y </p></li>
<li><p><strong>ecz</strong> – gradients wrt z </p></li>
<li><p><strong>coord_type</strong> – coordinate system </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-attributes">Public Static Attributes</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity11test_solvesE">
<span id="_CPPv3N7Gravity11test_solvesE"></span><span id="_CPPv2N7Gravity11test_solvesE"></span><span id="Gravity::test_solves__i"></span><span class="target" id="classGravity_1ac08196542f647f011081acbb56c40001"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_solves</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity11test_solvesE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity11mass_offsetE">
<span id="_CPPv3N7Gravity11mass_offsetE"></span><span id="_CPPv2N7Gravity11mass_offsetE"></span><span id="Gravity::mass_offset__amrex::Real"></span><span class="target" id="classGravity_1a6f051c1d5d93b44d62f2832c855b2008"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mass_offset</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity11mass_offsetE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity12stencil_typeE">
<span id="_CPPv3N7Gravity12stencil_typeE"></span><span id="_CPPv2N7Gravity12stencil_typeE"></span><span id="Gravity::stencil_type__i"></span><span class="target" id="classGravity_1a99ca5c59e3f4f874d80f572ae692a087"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stencil_type</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity12stencil_typeE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7Gravity24max_radius_all_in_domainE">
<span id="_CPPv3N7Gravity24max_radius_all_in_domainE"></span><span id="_CPPv2N7Gravity24max_radius_all_in_domainE"></span><span id="Gravity::max_radius_all_in_domain__amrex::Real"></span><span class="target" id="classGravity_1acbb91e5ff3eb2a2bf1e077926a117b68"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><a class="reference internal" href="../file/Castro__util_8H.html#_CPPv45amrex" title="amrex"><span class="n"><span class="pre">amrex</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_radius_all_in_domain</span></span></span><a class="headerlink" href="#_CPPv4N7Gravity24max_radius_all_in_domainE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="classGradPhiPhysBCFunct.html" class="btn btn-neutral float-left" title="Class GradPhiPhysBCFunct" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="classHypreABec.html" class="btn btn-neutral float-right" title="Class HypreABec" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Castro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>