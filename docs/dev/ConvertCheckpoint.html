

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Checkpoint Embiggener &mdash; Castro  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"kth": "{{k_\\mathrm{th}}}", "gcc": "{\\mathrm{g~cm^{-3}}}", "cms": "{\\mathrm{cm~s^{-1}}}", "presunit": "{\\mathrm{dyn~cm^{-2}}}", "accelunit": "{\\mathrm{cm~s^{-2}}}", "ergg": "{\\mathrm{erg~g^{-1}}}", "Ab": "{{\\bf A}}", "eb": "{{\\bf e}}", "Fb": "{{\\bf F}}", "gb": "{{\\bf g}}", "Hb": "{{\\bf H}}", "ib": "{{\\bf i}}", "Ib": "{{\\bf I}}", "Kb": "{{\\bf K}}", "lb": "{{\\bf l}}", "Lb": "{{\\bf L}}", "nb": "{{\\bf n}}", "Pb": "{{\\bf P}}", "Qb": "{{\\bf Q}}", "rb": "{{\\bf r}}", "Rb": "{{\\bf R}}", "Sb": "{{\\bf S}}", "ub": "{{\\bf u}}", "Ub": "{{\\bf U}}", "xb": "{{\\bf x}}", "dt": "{\\Delta t}", "omegadot": "{\\dot\\omega}", "inp": "{{\\rm in}}", "outp": "{{\\rm out}}", "sync": "{{\\rm sync}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\half}", "nph": "{{n+\\myhalf}}", "kpp": "{\\ensuremath{\\kappa_{\\mathrm{P}}}}", "kpr": "{\\ensuremath{\\kappa_{\\mathrm{R}}}}", "kpf": "{\\ensuremath{\\kappa_{\\mathrm{F}}}}", "vb": "{\\boldsymbol{v}}", "vbt": "{\\widetilde{\\vb}}", "rbt": "{\\widetilde{\\rb}}", "ob": "{\\boldsymbol{\\omega}}", "nablab": "{\\boldsymbol{\\nabla}}", "avg": ["{{\\left \\langle #1 \\right \\rangle}}", 1]}}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Self-Consistent Field Initialization" href="self_consistent_field.html" />
    <link rel="prev" title="Adaptive Mesh Refinement" href="AMR.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          


          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Castro
          

          
            
            <img src="_static/castro_logo_hot_200.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
    <div class="branch">
        Branch: <a href="../ConvertCheckpoint.html">main</a> | <a href="./ConvertCheckpoint.html">development</a>
    </div>

        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Castro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi_plus_x.html">Running Options: CPUs and GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="problem_setups.html">Distributed Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="timestepping.html">Timestepping and Retries</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_a_problem.html">Setting Up Your Own Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Outputting</a></li>
<li class="toctree-l1"><a class="reference internal" href="regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Castro reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu_porting.html">Offloading a routine to GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="mhd.html">MHD</a></li>
<li class="toctree-l1"><a class="reference internal" href="gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponge.html">Sponge</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="EOSNetwork.html">Microphysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Checkpoint Embiggener</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#star-in-corner-star-at-center-0">Star in Corner (<code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 0)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-the-checkpoint-file">Converting the Checkpoint File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restarting-from-a-grown-checkpoint-file">Restarting from a Grown Checkpoint File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#star-at-center-of-domain-star-at-center-1">Star at Center of Domain (<code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 1)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-the-checkpoint-file-1">Converting the Checkpoint File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restarting-from-a-grown-checkpoint-file-1">Restarting from a Grown Checkpoint File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cylindrical-coordinates">Cylindrical Coordinates</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="self_consistent_field.html">Self-Consistent Field Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1"><a class="reference internal" href="Verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Best Practices</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="classlist.html">Class list</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Castro</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Checkpoint Embiggener</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ConvertCheckpoint.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="checkpoint-embiggener">
<h1>Checkpoint Embiggener<a class="headerlink" href="#checkpoint-embiggener" title="Permalink to this headline">¶</a></h1>
<p>Within the Castro distribution, there is the capability to “grow” a
checkpoint file so that a calculation can be restarted in a larger
domain covered by grid cells a factor of two or four coarser than the
existing coarsest level. Instructions for how to do so are in the
<code class="docutils literal notranslate"><span class="pre">Castro/Util/ConvertCheckpoint/README</span></code> file and are included here.
Upon restart the existing data in the checkpoint file will be used to
fill the region of the previous computational domain, and the new
regions will be filled by some other means, typically interpolation
from a 1D model file.</p>
<div class="section" id="star-in-corner-star-at-center-0">
<h2>Star in Corner (<code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 0)<a class="headerlink" href="#star-in-corner-star-at-center-0" title="Permalink to this headline">¶</a></h2>
<p>In this section we consider the case where the star (or feature of interest)
is centered at the lower left corner of the domain, e.g. you are modeling only one
quarter of the star in 2D, or an octant of the star in 3D. Then you only want
to grow the domain in the “high side” directions (e.g., to the upper right).</p>
<div class="section" id="converting-the-checkpoint-file">
<h3>Converting the Checkpoint File<a class="headerlink" href="#converting-the-checkpoint-file" title="Permalink to this headline">¶</a></h3>
<p>Let’s say you have a checkpoint file, <code class="docutils literal notranslate"><span class="pre">chk00100</span></code> with 5 levels of
refinement and a (real) problem domain size <span class="math notranslate nohighlight">\(P\)</span> and (integer)
domain size <span class="math notranslate nohighlight">\(D\)</span> at level 0.  The inputs file that created this
might have contained:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_step</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span> <span class="o">=</span> <span class="n">D</span> <span class="n">D</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span> <span class="o">=</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span> <span class="o">=</span> <span class="n">P</span> <span class="n">P</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Now let’s suppose that you want to grow the domain by a factor of 8
and cover that new larger domain with a level that is a factor of 2
coarser than the existing level 0 grids.</p>
<ol class="arabic">
<li><p>First, set <code class="docutils literal notranslate"><span class="pre">DIM</span> <span class="pre">=</span></code> in the GNUmakefile, and type <code class="docutils literal notranslate"><span class="pre">make</span></code> in the
<code class="docutils literal notranslate"><span class="pre">Util/ConvertCheckpoint/</span></code> directory.  This will
make an executable from the <code class="docutils literal notranslate"><span class="pre">Embiggen.cpp</span></code> code.</p></li>
<li><p>Run the embiggening code as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Embiggen2d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">ex</span> <span class="n">checkin</span><span class="o">=</span><span class="n">chk00100</span> <span class="n">checkout</span><span class="o">=</span><span class="n">newchk00050</span> <span class="n">ref_ratio</span><span class="o">=</span><span class="mi">2</span> <span class="n">grown_factor</span><span class="o">=</span><span class="mi">8</span> <span class="n">star_at_center</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>(Your executable may have a slightly different name depending on the compilers you
built it with.)</p>
<p>This will create a new checkpoint directory, called
<code class="docutils literal notranslate"><span class="pre">newchk00050</span></code>, that represents a simulation with <em>one</em> additional
level of refinement <em>coarser</em> than the previous level 0 grids by a
factor of <code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> (in this case, 2).  The new domain will be a
factor of <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> (in this case, 8) larger than the previous
domain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> must be 2 or 4, because those are the only
acceptable values in Castro.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> can be any reasonable integer; but it’s only been
tested with 2, 3, 4 and 8. It does not need to be a multiple of 2.</p>
</li>
</ol>
</div>
<div class="section" id="restarting-from-a-grown-checkpoint-file">
<h3>Restarting from a Grown Checkpoint File<a class="headerlink" href="#restarting-from-a-grown-checkpoint-file" title="Permalink to this headline">¶</a></h3>
<p>You should now be able to restart your calculation using <code class="docutils literal notranslate"><span class="pre">newchk00050</span></code>.
Your inputs file should now contain lines like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_step</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">amr</span><span class="o">.</span><span class="n">restart</span> <span class="o">=</span> <span class="n">newchk00050</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span> <span class="o">=</span> <span class="mi">4</span><span class="n">D</span> <span class="mi">4</span><span class="n">D</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span> <span class="o">=</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span> <span class="o">=</span> <span class="mi">8</span><span class="n">P</span> <span class="mi">8</span><span class="n">P</span>
<span class="n">castro</span><span class="o">.</span><span class="n">grown_factor</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">castro</span><span class="o">.</span><span class="n">star_at_center</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span> <span class="o">=</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Important:</p>
<blockquote>
<div><ul class="simple">
<li><p>Unlike earlier, you may now set <code class="docutils literal notranslate"><span class="pre">amr.max_level</span></code> to be at most one
greater than before, but you need not set it that high. For
example, you could set <code class="docutils literal notranslate"><span class="pre">amr.max_level</span></code> the same as before and you
would lose data at the finest refinement level. You may not set
<code class="docutils literal notranslate"><span class="pre">amr.max_level</span></code> = 0, however, because we have no data at the new
level 0 until we average down from the new level 1 after the
restart.</p></li>
<li><p>You must set <code class="docutils literal notranslate"><span class="pre">amr.n_cell</span></code> = (<code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> / <code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code>)
<span class="math notranslate nohighlight">\(\times\)</span> (the previous value of <code class="docutils literal notranslate"><span class="pre">amr.n_cell</span></code>). In this case
<code class="docutils literal notranslate"><span class="pre">amr.n_cell</span></code> = (8/2)*D = 4D.</p></li>
<li><p>You must set <code class="docutils literal notranslate"><span class="pre">amr.prob_hi</span></code> to be a factor of <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code>
greater than the previous value of <code class="docutils literal notranslate"><span class="pre">amr.prob_hi</span></code>.</p></li>
<li><p>You must insert the value of <code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> used in the Embiggen
call as the first value in the list of <code class="docutils literal notranslate"><span class="pre">amr.ref_ratio</span></code>, since
that will now be the refinement ratio between the new level 0 and
the new level 1.</p></li>
<li><p>You must set <code class="docutils literal notranslate"><span class="pre">castro.grown_factor</span></code> in your inputs file equal to
the value of <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> you used when you called Embiggen*ex
so that Castro knows how big the original domain was.</p></li>
<li><p>Note that if you have run 100 steps at the original level 0, that
would be equivalent to 50 steps at the new level 0 because you
coarsened by a factor of 2.  Thus once you re-start from the new
checkpoint directory, the next step will be 51, not 101. Make sure
to keep track of your plotfiles accordingly.</p></li>
<li><p>Don’t forget to adjust <code class="docutils literal notranslate"><span class="pre">max_denerr_lev</span></code> and comparable variables
to control the number of fine levels you now want. If you want to
have 6 levels of refinement after restart, then make sure
<code class="docutils literal notranslate"><span class="pre">max_denerr_lev</span></code>, etc, are set high enough. If you only want to have
5 levels of refinement (where the new level 5 would now be a factor
of <code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> coarser than the previous level 5), make sure to
adjust <code class="docutils literal notranslate"><span class="pre">max_denerr_lev</span></code> accordingly as well.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="star-at-center-of-domain-star-at-center-1">
<h2>Star at Center of Domain (<code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 1)<a class="headerlink" href="#star-at-center-of-domain-star-at-center-1" title="Permalink to this headline">¶</a></h2>
<p>Now let’s assume that the star (or feature of interest) is centered at
the center of the domain in 2D or 3D Cartesian coordinates. We will
later consider the case of 2D cylindrical (r-z) coordinates in which
the star is centered at the left midpoint.</p>
<div class="section" id="converting-the-checkpoint-file-1">
<span id="id1"></span><h3>Converting the Checkpoint File<a class="headerlink" href="#converting-the-checkpoint-file-1" title="Permalink to this headline">¶</a></h3>
<p>Suppose that you want to grow the domain by a factor of 2 and cover
that new larger domain with a level that is a factor of 2 coarser than
the existing level 0 grids.</p>
<p>After you build the Embiggen executable, you type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Embiggen2d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">ex</span> <span class="n">checkin</span><span class="o">=</span><span class="n">chk00100</span> <span class="n">checkout</span><span class="o">=</span><span class="n">newchk00050</span> <span class="n">ref_ratio</span><span class="o">=</span><span class="mi">2</span> <span class="n">grown_factor</span><span class="o">=</span><span class="mi">2</span> <span class="n">star_at_center</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>Note that</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> must still be 2 or 4</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> can only be 2 or 3 in this case.</p></li>
</ul>
</div>
<div class="section" id="restarting-from-a-grown-checkpoint-file-1">
<span id="id2"></span><h3>Restarting from a Grown Checkpoint File<a class="headerlink" href="#restarting-from-a-grown-checkpoint-file-1" title="Permalink to this headline">¶</a></h3>
<p>Your inputs file for restarting would now look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_step</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">amr</span><span class="o">.</span><span class="n">restart</span> <span class="o">=</span> <span class="n">newchk00050</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span> <span class="o">=</span> <span class="n">D</span> <span class="n">D</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span> <span class="o">=</span> <span class="o">-</span><span class="n">P</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="n">P</span><span class="o">/</span><span class="mi">2</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span> <span class="o">=</span> <span class="mi">3</span><span class="n">P</span><span class="o">/</span><span class="mi">2</span> <span class="mi">3</span><span class="n">P</span><span class="o">/</span><span class="mi">2</span>
<span class="n">castro</span><span class="o">.</span><span class="n">grown_factor</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">castro</span><span class="o">.</span><span class="n">star_at_center</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span> <span class="o">=</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="cylindrical-coordinates">
<h3>Cylindrical Coordinates<a class="headerlink" href="#cylindrical-coordinates" title="Permalink to this headline">¶</a></h3>
<p>In the case of 2D cylindrical (r-z) coordinates in which the star is
centered at the left edge but vertical midpoint of the domain, the
embiggening procedure is the same as above (with <code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> =
1) but the inputs file for restart is slightly different in that
<code class="docutils literal notranslate"><span class="pre">geometry.prob_lo</span></code> is modified in the z- but not the r-direction. If
we consider the original inputs file to look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_step</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span> <span class="o">=</span> <span class="n">D</span> <span class="mi">2</span><span class="n">D</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span> <span class="o">=</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span> <span class="o">=</span> <span class="n">P</span> <span class="mi">2</span><span class="n">P</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
<p>then an inputs file for restart would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">amr</span><span class="o">.</span><span class="n">restart</span> <span class="o">=</span> <span class="n">newchk00050</span>
<span class="n">amr</span><span class="o">.</span><span class="n">max_level</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">amr</span><span class="o">.</span><span class="n">n_cell</span> <span class="o">=</span> <span class="n">D</span> <span class="mi">2</span><span class="n">D</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_lo</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span><span class="n">P</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">prob_hi</span> <span class="o">=</span> <span class="mi">2</span><span class="n">P</span> <span class="mi">3</span><span class="n">P</span>
<span class="n">castro</span><span class="o">.</span><span class="n">grown_factor</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">castro</span><span class="o">.</span><span class="n">star_at_center</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">amr</span><span class="o">.</span><span class="n">ref_ratio</span> <span class="o">=</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Some results:</p>
<div class="figure align-default" id="id3">
<img alt="_images/corner.png" src="_images/corner.png" />
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">Data from checkpoint file before and after the domain has been
coarsened and grown. This case uses <code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 0 and
<code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> = 2. The first grown example has <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> =
2, the second has <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> = 3. In all figures the level 0
grids are shown in white, the level 1 grids in red, the level 2
grids in yellow, and in the grown figures, the level 3 grids are in
pink.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id4">
<img alt="_images/center.png" src="_images/center.png" />
<p class="caption"><span class="caption-number">Fig. 10 </span><span class="caption-text">Data from checkpoint file before and after the domain has been
coarsened and grown. This case uses <code class="docutils literal notranslate"><span class="pre">star_at_center</span></code> = 1 and
<code class="docutils literal notranslate"><span class="pre">ref_ratio</span></code> = 2. The first grown example has <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> =
2, the second has <code class="docutils literal notranslate"><span class="pre">grown_factor</span></code> = 3. In all figures the level 0
grids are shown in white, the level 1 grids in red, the level 2
grids in yellow, and in the grown figures, the level 3 grids are in
pink.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="self_consistent_field.html" class="btn btn-neutral float-right" title="Self-Consistent Field Initialization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="AMR.html" class="btn btn-neutral float-left" title="Adaptive Mesh Refinement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2020, Castro development tem

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    


</body>
</html>