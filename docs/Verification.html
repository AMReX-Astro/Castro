

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Verification &mdash; Castro  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=e375baa2" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=eaa7b67c"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"kth": "{{k_\\mathrm{th}}}", "gcc": "{\\mathrm{g~cm^{-3}}}", "cms": "{\\mathrm{cm~s^{-1}}}", "presunit": "{\\mathrm{dyn~cm^{-2}}}", "accelunit": "{\\mathrm{cm~s^{-2}}}", "ergg": "{\\mathrm{erg~g^{-1}}}", "Ab": "{{\\bf A}}", "eb": "{{\\bf e}}", "Fb": "{{\\bf F}}", "gb": "{{\\bf g}}", "Hb": "{{\\bf H}}", "ib": "{{\\bf i}}", "Ib": "{{\\bf I}}", "Kb": "{{\\bf K}}", "lb": "{{\\bf l}}", "Lb": "{{\\bf L}}", "nb": "{{\\bf n}}", "Pb": "{{\\bf P}}", "Qb": "{{\\bf Q}}", "rb": "{{\\bf r}}", "Rb": "{{\\bf R}}", "Sb": "{{\\bf S}}", "ub": "{{\\bf u}}", "Ub": "{{\\bf U}}", "xb": "{{\\bf x}}", "dt": "{\\Delta t}", "omegadot": "{\\dot\\omega}", "inp": "{{\\rm in}}", "outp": "{{\\rm out}}", "sync": "{{\\rm sync}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\half}", "nph": "{{n+\\myhalf}}", "kpp": "{\\ensuremath{\\kappa_{\\mathrm{P}}}}", "kpr": "{\\ensuremath{\\kappa_{\\mathrm{R}}}}", "kpf": "{\\ensuremath{\\kappa_{\\mathrm{F}}}}", "vb": "{\\boldsymbol{v}}", "vbt": "{\\widetilde{\\vb}}", "rbt": "{\\widetilde{\\rb}}", "ob": "{\\boldsymbol{\\omega}}", "nablab": "{\\boldsymbol{\\nabla}}", "avg": ["{{\\left \\langle #1 \\right \\rangle}}", 1]}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Development Best Practices" href="development.html" />
    <link rel="prev" title="Restarting from Maestro" href="MAESTRO_restart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            Castro
              <img src="_static/castro_logo_hot_200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="./Verification.html">main</a> | <a href="./dev/Verification.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Castro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi_plus_x.html">Running Options: CPUs and GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Programming Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="problem_setups.html">Distributed Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="timestepping.html">Timestepping and Retries</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_a_problem.html">Setting Up Your Own Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Outputting</a></li>
<li class="toctree-l1"><a class="reference internal" href="regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Castro reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="hse.html">Hydrostatic Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="EOS.html">Equation of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactions.html">Reactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="mhd.html">MHD</a></li>
<li class="toctree-l1"><a class="reference internal" href="gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion.html">Thermal Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponge.html">Sponge</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertCheckpoint.html">Checkpoint Embiggener</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_consistent_field.html">Self-Consistent Field Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hydrodynamics-test-problems">Hydrodynamics Test Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sods-problem-and-other-shock-tube-problems">Sod’s Problem (and Other Shock Tube Problems)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sods-problem">Sod’s Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#double-rarefaction">Double Rarefaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strong-shock">Strong Shock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sedov-problem">Sedov Problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cylindrical-blast-wave">Cylindrical Blast Wave</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rayleigh-taylor">Rayleigh-Taylor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gravity-test-problems">Gravity Test Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="#radiation-test-problems">Radiation Test Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#light-front">Light Front</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diffusion-of-a-gaussian-pulse">Diffusion of a Gaussian Pulse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#radiation-source-problem">Radiation Source Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#radiating-sphere">Radiating Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#regression-testing">Regression Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Best Practices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="classlist.html">Class list</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Castro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Verification</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Verification.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="verification">
<h1>Verification<a class="headerlink" href="#verification" title="Link to this heading"></a></h1>
<section id="hydrodynamics-test-problems">
<h2>Hydrodynamics Test Problems<a class="headerlink" href="#hydrodynamics-test-problems" title="Link to this heading"></a></h2>
<section id="sods-problem-and-other-shock-tube-problems">
<h3>Sod’s Problem (and Other Shock Tube Problems)<a class="headerlink" href="#sods-problem-and-other-shock-tube-problems" title="Link to this heading"></a></h3>
<p>The Exec/hydro_tests/Sod problem directory sets up a general one-dimensional
shock tube. The left and right primitive-variable states are specified
and the solution evolves until a user-specified end time. For a simple
discontinuity, the exact solution can be found from an exact Riemann
solver. For this problem, the exact solutions were computed with the
exact Riemann solver from Toro <span id="id1">[<a class="reference internal" href="zreferences.html#id39" title="E. F. Toro. Riemann Solvers and Numerical Methods for Fluid Dynamics. Springer, 1997.">14</a>]</span>, Chapter 4.</p>
<section id="sods-problem">
<h4>Sod’s Problem<a class="headerlink" href="#sods-problem" title="Link to this heading"></a></h4>
<p>The Sod problem <span id="id2">[<a class="reference internal" href="zreferences.html#id40" title="G. A. Sod. A survey of several finite difference methods for systems of nonlinear hyperbolic conservation la ws. Journal of Computational Physics, 27:1-31, April 1978. doi:10.1016/0021-9991(78)90023-2.">64</a>]</span> is a simple shock tube problem that
exhibits a shock, contact discontinuity, and a rarefaction wave.
The initial conditions are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\rho_L = 1 \\
u_L = 0 \\
p_L = 1
\end{array}
\qquad
\begin{array}{l}
\rho_R = 0.125 \\
u_R = 0 \\
p_R = 0.1
\end{array}\end{split}\]</div>
<p>The gamma_law equation of state is used with <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>.
The system is evolved until <span class="math notranslate nohighlight">\(t = 0.2\)</span> s. Setups for 1-, 2-, and 3-d
are provided. The following inputs files setup the
Sod’s problem:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-sod-x</span></code></p></td>
<td><p>Sod’s problem along <span class="math notranslate nohighlight">\(x\)</span>-direction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-sod-y</span></code></p></td>
<td><p>Sod’s problem along <span class="math notranslate nohighlight">\(y\)</span>-direction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-sod-z</span></code></p></td>
<td><p>Sod’s problem along <span class="math notranslate nohighlight">\(z\)</span>-direction</p></td>
</tr>
</tbody>
</table>
<p>For multi-dimensional runs, the directions transverse to the jump are
kept constant. We use a CFL number of 0.9, an initial timestep shrink
(castro.init_shrink) of 0.1, and the maximum factor by which
the timestep can increase (castro.change_max) of 1.05.</p>
<figure class="align-center" id="id12">
<span id="fig-sod"></span><a class="reference internal image-reference" href="_images/sod_3d.png"><img alt="sod problem" src="_images/sod_3d.png" style="width: 4.75in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Castro solution for Sod’s problem run in 3-d, with the newest ppm
limiters, along the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> axes. A
coarse grid of 32 zones in the direction of propagation, with 2
levels of refinement was used. The analytic solution appears as the
red line.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id13">
<span id="fig-sod-ppm0"></span><a class="reference internal image-reference" href="_images/sod_3d_ppm0.png"><img alt="sod problem" src="_images/sod_3d_ppm0.png" style="width: 4.75in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Castro solution for Sod’s problem run in 3-d, with the
piecewise-linear Godunov method with limiters, along the <span class="math notranslate nohighlight">\(x\)</span>,
<span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> axes. A coarse grid of 32 zones in the
direction of propagation, with 2 levels of refinement was used. The
analytic solution appears as the red line.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-sod"><span class="std std-numref">Fig. 10</span></a> shows the Castro solution using the newest PPM limiters
compared to the analytic
solution, showing the density, velocity, pressure, and internal energy.
<a class="reference internal" href="#fig-sod-ppm0"><span class="std std-numref">Fig. 11</span></a> is the same as <a class="reference internal" href="#fig-sod"><span class="std std-numref">Fig. 10</span></a>,
but with the piecewise-linear Godunov method with limiters,
shown for comparison.</p>
<p>The Verification subdirectory includes the analytic solution for
the Sod problem sod-exact.out, with <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>. 1-d slices
can be extracted from the Castro plotfile using the fextract tool
from <code class="docutils literal notranslate"><span class="pre">amrex/Tools/Postprocessing/C_Src/</span></code>.
The steps to generate this verification plot with Castro are:</p>
<ol class="arabic">
<li><p>in <code class="docutils literal notranslate"><span class="pre">Exec/hydro_tests/Sod</span></code>, build the Castro executable in 3-d</p></li>
<li><p>run the Sod problem with Castro in the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> directions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">Castro3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span><span class="o">-</span><span class="n">sod</span><span class="o">-</span><span class="n">x</span>
<span class="o">./</span><span class="n">Castro3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span><span class="o">-</span><span class="n">sod</span><span class="o">-</span><span class="n">y</span>
<span class="o">./</span><span class="n">Castro3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span><span class="o">-</span><span class="n">sod</span><span class="o">-</span><span class="n">z</span>
</pre></div>
</div>
</li>
<li><p>build the fextract tool in <code class="docutils literal notranslate"><span class="pre">amrex/Tools/Postprocessing/C_Src/</span></code> .</p></li>
<li><p>run fextract on the Castro output to generate 1-d slices
through the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fextract3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">d</span> <span class="mi">1</span> <span class="o">-</span><span class="n">s</span> <span class="n">sodx</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">p</span> <span class="n">sod_x_plt00034</span>
<span class="n">fextract3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">d</span> <span class="mi">2</span> <span class="o">-</span><span class="n">s</span> <span class="n">sody</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">p</span> <span class="n">sod_y_plt00034</span>
<span class="n">fextract3d</span><span class="o">.</span><span class="n">Linux</span><span class="o">.</span><span class="n">Intel</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">d</span> <span class="mi">3</span> <span class="o">-</span><span class="n">s</span> <span class="n">sodz</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">p</span> <span class="n">sod_z_plt00034</span>
</pre></div>
</div>
</li>
<li><p>copy the sodx/y/z.out files into the <code class="docutils literal notranslate"><span class="pre">Verification/</span></code> directory.</p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">Verification/</span></code> run the gnuplot script <code class="docutils literal notranslate"><span class="pre">sod_3d.gp</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">sod_3d</span><span class="o">.</span><span class="n">gp</span>
</pre></div>
</div>
<p>This will produce the figure <code class="docutils literal notranslate"><span class="pre">sod_3d.eps</span></code>.</p>
</li>
</ol>
</section>
<section id="double-rarefaction">
<h4>Double Rarefaction<a class="headerlink" href="#double-rarefaction" title="Link to this heading"></a></h4>
<p>The double rarefaction is the “Test 2” problem described by Toro
<span id="id3">[<a class="reference internal" href="zreferences.html#id39" title="E. F. Toro. Riemann Solvers and Numerical Methods for Fluid Dynamics. Springer, 1997.">14</a>]</span>, Chapter 6. In this test, the center of the domain
is evacuated as two rarefaction waves propagate in each direction, outward
from the center. It is difficult to get the internal energy to
behave at the center of the domain because we are creating a vacuum.
The initial conditions are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\rho_L = 1 \\
u_L = -2 \\
p_L = 0.4
\end{array}
\qquad
\begin{array}{l}
\rho_R = 1 \\
u_R = 2 \\
p_R = 0.4
\end{array}\end{split}\]</div>
<p>The gamma_law equation of state is used with <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>.
The system is evolved until <span class="math notranslate nohighlight">\(t = 0.15\)</span> s. Setups for 1-, 2-, and 3-d
are provided. The following inputs files setup the
double rarefaction problem:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test2-x</span></code></p></td>
<td><p>Double rarefaction
problem along
<span class="math notranslate nohighlight">\(x\)</span>-direction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test2-y</span></code></p></td>
<td><p>Double rarefaction
problem along
<span class="math notranslate nohighlight">\(y\)</span>-direction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test2-z</span></code></p></td>
<td><p>Double rarefaction
problem along
<span class="math notranslate nohighlight">\(z\)</span>-direction</p></td>
</tr>
</tbody>
</table>
<p>We use a CFL number of 0.8, an initial timestep shrink
(<code class="docutils literal notranslate"><span class="pre">castro.init_shrink</span></code>) of 0.1, and the maximum factor by which the
timestep can increase (<code class="docutils literal notranslate"><span class="pre">castro.change_max</span></code>) of 1.05. The PPM solver with
the new limiters are used.</p>
<figure class="align-center" id="id14">
<span id="fig-test2"></span><a class="reference internal image-reference" href="_images/test2_3d.png"><img alt="double rarefaction" src="_images/test2_3d.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Castro solution for the double rarefaction problem run in 3-d,
along the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> axes. A coarse grid
of 32 zones in the direction of propagation, with 2 levels of
refinement was used. The analytic solution appears as the red line.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-test2"><span class="std std-numref">Fig. 12</span></a> shows the Castro output, run along all 3
coordinate axes in 3-d, compared to the analytic solution.</p>
<p>The comparison to the analytic solution follows the same procedure as
described for the Sod’s problem above. The gnuplot script
<code class="docutils literal notranslate"><span class="pre">test2_3d.gp</span></code> will generate the figure, from the 1-d slices created by
fextract named test2x.out, test2y.out, and test2z.out.</p>
</section>
<section id="strong-shock">
<h4>Strong Shock<a class="headerlink" href="#strong-shock" title="Link to this heading"></a></h4>
<p>The strong shock test is the “Test 3” problem described by Toro
<span id="id4">[<a class="reference internal" href="zreferences.html#id39" title="E. F. Toro. Riemann Solvers and Numerical Methods for Fluid Dynamics. Springer, 1997.">14</a>]</span>, Chapter 6. In this test, a large pressure jump
at the initial interface creates a very strong rightward moving
shock, followed very closely by a contact discontinuity.
The initial conditions are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\rho_L = 1 \\
u_L = 0 \\
p_L = 1000
\end{array}
\qquad
\begin{array}{l}
\rho_R = 1 \\
u_R = 0 \\
p_R = 0.01
\end{array}\end{split}\]</div>
<p>The gamma_law equation of state is used with <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>.
The system is evolved until <span class="math notranslate nohighlight">\(t = 0.012\)</span> s. Setups for 1-, 2-, and 3-d
are provided. The following inputs files and probin files setup the
strong shock problem:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test3-x</span></code></p></td>
<td><p>Strong shock problem
along
<span class="math notranslate nohighlight">\(x\)</span>-direction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test3-y</span></code></p></td>
<td><p>Strong shock problem
along
<span class="math notranslate nohighlight">\(y\)</span>-direction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs-test3-z</span></code></p></td>
<td><p>Strong shock problem
along
<span class="math notranslate nohighlight">\(z\)</span>-direction</p></td>
</tr>
</tbody>
</table>
<p>We use a CFL number of 0.9, an initial
timestep shrink (<code class="docutils literal notranslate"><span class="pre">castro.init_shrink</span></code>) of 0.1, and the maximum factor by which
the timestep can increase (<code class="docutils literal notranslate"><span class="pre">castro.change_max</span></code>) of 1.05. The PPM
solver with the new limiters are used.</p>
<figure class="align-center" id="id15">
<span id="fig-test3"></span><a class="reference internal image-reference" href="_images/test3_3d.png"><img alt="strong shock" src="_images/test3_3d.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Castro solution for the strong shock problem run in 3-d, along the
<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> axes. A coarse grid of 32 zones
in the direction of propagation, with 2 levels of refinement was
used. The analytic solution appears as the red line.</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-test3"><span class="std std-numref">Fig. 13</span></a> shows the Castro output, run along all 3
coordinate axes in 3-d, compared to the analytic solution.</p>
<p>The comparison to the analytic solution follows the same procedure as
described for the Sod’s problem above. The gnuplot script
<code class="docutils literal notranslate"><span class="pre">test3_3d.gp</span></code> will generate the figure, from the 1-d slices created by
fextract named test3x.out, test3y.out, and test3z.out.</p>
</section>
</section>
<section id="sedov-problem">
<h3>Sedov Problem<a class="headerlink" href="#sedov-problem" title="Link to this heading"></a></h3>
<p>The Sedov (or Sedov-Taylor) blast wave is a standard hydrodynamics
test problem. A large amount of energy is placed into a very small
volume, driving a spherical or cylindrical blast wave.
Analytic solutions were found by Sedov <span id="id5">[<a class="reference internal" href="zreferences.html#id41" title="L. I. Sedov. Similarity and Dimensional Methods in Mechanics. Academic Press, 1959. translated from the 4th Russian Ed.">63</a>]</span>.</p>
<p>A cylindrical blast wave (e.g. a point explosion in a 2-d plane) can
be modeled in 1-d cylindrical coordinate or 2-d Cartesian coordinates.
A spherical blast wave can be modeled in 1-d spherical, 2-d axisymmetric
(cylindrical <span class="math notranslate nohighlight">\(r\)</span>-<span class="math notranslate nohighlight">\(z\)</span>), 2-d axisymmetric
(spherical <span class="math notranslate nohighlight">\(r\)</span>-<span class="math notranslate nohighlight">\(\theta\)</span>),or 3-d Cartesian coordinates.
This provides a good test on the geometric factors in the hydrodynamics solver.
We use a publicly available code, <code class="docutils literal notranslate"><span class="pre">sedov3.f</span></code>
<span id="id6">[<a class="reference internal" href="zreferences.html#id42" title="J. R. Kamm and F. X. Timmes. On Efficient Generation of Numerically Robust Sedov Solutions. Retrieved from http://cococubed.com/research_pages/sedov.shtml. URL: http://cococubed.com/papers/la-ur-07-2849.pdf.">49</a>]</span>, to generate the analytic solutions.</p>
<p>The Castro implementation of the Sedov problem is <code class="docutils literal notranslate"><span class="pre">in</span>
<span class="pre">Exec/hydro_tests/Sedov/</span></code>.  A number of different inputs files
are provided, corresponding to different Sedov/Castro geometries. The
main ones are:</p>
<span id="table-sedov-inputs"></span><table class="docutils align-default" id="id16">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Sedov problem inputs files</span><a class="headerlink" href="#id16" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>inputs file</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.1d.cyl</span></code></p></td>
<td><p>Spherical Sedov explosion modeled
in 1-d cylindrical coordinates</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.1d.sph</span></code></p></td>
<td><p>Spherical Sedov explosion modeled
in 1-d spherical coordinates</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.2d.sph_in_cylcoords</span></code></p></td>
<td><p>Spherical Sedov explosion modeled
in 2-d cylindrical (axisymmetric)
coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.2d.sph_in_sphcoords</span></code></p></td>
<td><p>Spherical Sedov explosion modeled
in 2-d spherical (axisymmetric)
coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.2d.cyl_in_cartcoords</span></code></p></td>
<td><p>Cylindrical Sedov explosion modeled in
2-d Cartesian coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inputs.3d.sph</span></code></p></td>
<td><p>Spherical Sedov explosion modeled in
3-d Cartesian coordinates.</p></td>
</tr>
</tbody>
</table>
<p>In the Sedov problem, the explosion energy, <span class="math notranslate nohighlight">\(E_\mathrm{exp}\)</span> (in units
of energy, not energy/mass or energy/volume)
is to be deposited into a single point, in a medium of uniform ambient
density, <span class="math notranslate nohighlight">\(\rho_\mathrm{ambient}\)</span>, and pressure, <span class="math notranslate nohighlight">\(p_\mathrm{ambient}\)</span>.
Initializing the problem can be difficult because the small volume is
typically only a cell in extent. This can lead to grid imprinting in
the solution. A standard solution (see for example <span id="id7">[<a class="reference internal" href="zreferences.html#id43" title="M. Omang, S. Børve, and J. Trulsen. SPH in spherical and cylindrical coordinates. Journal of Computational Physics, 213:391-412, March 2006. doi:10.1016/j.jcp.2005.08.023.">60</a>]</span>
and the references therein)
is to convert the explosion energy into a pressure contained within a
certain volume, <span class="math notranslate nohighlight">\(V_\mathrm{init}\)</span>, of radius <span class="math notranslate nohighlight">\(r_\mathrm{init}\)</span> as</p>
<div class="math notranslate nohighlight">
\[p_\mathrm{init} = \frac{(\gamma - 1) E_\mathrm{exp}}{V_\mathrm{init}}\]</div>
<p>This pressure is then deposited in all of the cells where <span class="math notranslate nohighlight">\(r &lt;
r_\mathrm{init}\)</span>.</p>
<p>To further minimize any grid effects, we do subsampling
in each zone: each zone is divided it into <span class="math notranslate nohighlight">\(N_\mathrm{sub}\)</span> subzones in each
coordinate direction, each subzone is initialized independently, and
then the subzones are averaged together (using a volume weighting for
spherical or cylindrical/axisymmetric Castro grids) to determine the
initial state of the full zone.</p>
<p>For these runs, we use <span class="math notranslate nohighlight">\(\rho_\mathrm{ambient} = 1\)</span>,
<span class="math notranslate nohighlight">\(p_\mathrm{ambient} = 10^{-5}\)</span>, <span class="math notranslate nohighlight">\(E_\mathrm{exp} = 1\)</span>, <span class="math notranslate nohighlight">\(r_\mathrm{init} = 0.01\)</span>,
and <span class="math notranslate nohighlight">\(N_\mathrm{sub} = 10\)</span>. A base grid with 32 zones in each
coordinate direction plus 3 levels of refinement is used (the finest
mesh would correspond to 256 zones in a coordinate direction). The
domain runs from 0 to 1 in each coordinate direction.</p>
<p>An analysis routines for the Sedov problem is provided in
<code class="docutils literal notranslate"><span class="pre">Castro/Diagnostics/Sedov/</span></code>.  Typing <code class="docutils literal notranslate"><span class="pre">make</span></code> should build it (you
can specify the dimensionality with the <code class="docutils literal notranslate"><span class="pre">DIM</span></code> variable in the
build).</p>
<p>A spherical Sedov explosion can be modeled in 1-d spherical, 2-d
cylindrical (axisymmetric), 2-d spherical (axisymmetric), or
3-d Cartesian coordinates, using the inputs files described in
<a class="reference internal" href="#table-sedov-inputs"><span class="std std-numref">Table 10</span></a>. A 1-d radial profile can be extracted
using the analysis routine. For example, to run and process
the 2-d spherical Sedov explosion in cylindrical coordinates, one would do:</p>
<ol class="arabic">
<li><p>in <code class="docutils literal notranslate"><span class="pre">Exec/hydro_tests/Sedov</span></code>, build the Castro executable in 2-d:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">DIM</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p>run the spherical Sedov problem with Castro in 2-d cylindrical coordinates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">Castro2d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">MPI</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs</span><span class="mf">.2</span><span class="n">d</span><span class="o">.</span><span class="n">sph_in_cylcoords</span>
</pre></div>
</div>
</li>
<li><p>build the <code class="docutils literal notranslate"><span class="pre">sedov_2d.ex</span></code> tool in <code class="docutils literal notranslate"><span class="pre">Castro/Diagnostics/Sedov</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">DIM</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p>run the analysis script  on the Castro output to generate 1-d radial
profiles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sedov_2d</span><span class="o">.</span><span class="n">ex</span> <span class="o">-</span><span class="n">s</span> <span class="n">sedov_2d_sph_in_cyl</span><span class="o">.</span><span class="n">out</span> \
     <span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">sedov_2d_sph_in_cyl_plt00130</span>
</pre></div>
</div>
</li>
</ol>
<p>A similar procedure can be used for the spherical and cylindrical
Sedov explosions in other geometries and dimensions. Once this is done,
the <code class="docutils literal notranslate"><span class="pre">sedov_sph.gp</span></code> and <code class="docutils literal notranslate"><span class="pre">sedov_cyl.gp</span></code> gnuplot script can be used to
make a plot comparing the numerical solutions to the analytic solution
for spherical and cylindrical Sedov explosions, which are contained
in <code class="docutils literal notranslate"><span class="pre">spherical_sedov.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">cylindrical_sedov.dat</span></code>, respectively.
Note that the file containing the 1-d radial profiles of the numerical
solution has the same name as the one specified in the gnuplot script.</p>
<dl class="simple">
<dt><a class="reference internal" href="#fig-sedov-sph"><span class="std std-numref">Fig. 14</span></a> shows the comparison of the 3 Castro spherical</dt><dd><p>Sedov explosion simulations to the analytic solution.</p>
</dd>
</dl>
<figure class="align-center" id="id17">
<span id="fig-sedov-sph"></span><a class="reference internal image-reference" href="_images/sedov_sph.png"><img alt="Sedov blast wave" src="_images/sedov_sph.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Castro solution for the Sedov blast wave problem run in 1-d spherical,
2-d cylindrical, 2-d spherical, and 3-d Cartesian coordinates.
Each of these geometries produces a spherical Sedov explosion.</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="cylindrical-blast-wave">
<h4>Cylindrical Blast Wave<a class="headerlink" href="#cylindrical-blast-wave" title="Link to this heading"></a></h4>
<figure class="align-center" id="id18">
<a class="reference internal image-reference" href="_images/sedov_cyl.png"><img alt="Sedov in 2-d" src="_images/sedov_cyl.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Castro solution for the Sedov blast wave problem run in 1-d cylindrical and
2-d Cartesian coordinates. This corresponds to a cylindrical Sedov
explosion.</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="rayleigh-taylor">
<h3>Rayleigh-Taylor<a class="headerlink" href="#rayleigh-taylor" title="Link to this heading"></a></h3>
<p>2D. Domain size 0.5 by 1.0. 256 by 512 cells, single level
calculation. Periodic in x, solid walls on top and bottom in y.
Gamma law gas with <span class="math notranslate nohighlight">\(\gamma=1.4\)</span>, no reactions. Zero initial velocity.
Constant <span class="math notranslate nohighlight">\(|\gb|=1\)</span>. The density profile is essentially <span class="math notranslate nohighlight">\(\rho=1\)</span> on
bottom, <span class="math notranslate nohighlight">\(\rho=2\)</span> on top, but with a perturbation. A single-mode
perturbation is constructed as:</p>
<div class="math notranslate nohighlight">
\[\tilde y(x) = 0.5 + 0.01 \frac{\cos(4\pi x) + \cos(4\pi(L_x - x))}{2}\]</div>
<p>We note that the symmetric form of the cosine is done to ensure that
roundoff error does not introduce a left-right asymmetry in the problem.
Without this construction, the R-T instability will lose its symmetry
as it evolves. This then applied to the interface with a tanh profile
to smooth the transition between the high and low density material:</p>
<div class="math notranslate nohighlight">
\[\rho(x,y) = 1 + 0.5\left[1+\tanh\left(\frac{y-\tilde y(x)}{0.005}\right)\right]\]</div>
<p>Hydrostatic pressure with <span class="math notranslate nohighlight">\(p=5.0\)</span> at bottom of domain, assuming
<span class="math notranslate nohighlight">\(\rho=1\)</span> on the lower half of the domain, and <span class="math notranslate nohighlight">\(\rho=2\)</span> on the upper
half and no density perturbation. We run to <span class="math notranslate nohighlight">\(t=2.5\)</span> with piecewise
linear, old PPM, and new PPM. CFL=0.9. See <a class="reference internal" href="#fig-rt"><span class="std std-numref">Fig. 16</span></a>.</p>
<figure class="align-center" id="id19">
<span id="fig-rt"></span><a class="reference internal image-reference" href="_images/RT_ppm_type.png"><img alt="Rayleigh-Taylor with different PPM types." src="_images/RT_ppm_type.png" style="width: 6.5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Rayleigh-Taylor with different PPM types.</span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="gravity-test-problems">
<h2>Gravity Test Problems<a class="headerlink" href="#gravity-test-problems" title="Link to this heading"></a></h2>
</section>
<section id="radiation-test-problems">
<h2>Radiation Test Problems<a class="headerlink" href="#radiation-test-problems" title="Link to this heading"></a></h2>
<p>There are two photon radiation solvers in Castro—a gray solver and a
multigroup solver. The gray solver follows the algorithm outlined
in <span id="id8">[<a class="reference internal" href="zreferences.html#id44" title="L. H. Howell and J. A. Greenough. Radiation diffusion for multi-fluid Eulerian hydrodynamics with adaptive mesh refinement. Journal of Computational Physics, 184:53-78, January 2003. doi:10.1016/S0021-9991(02)00015-3.">45</a>]</span>. We use the notation described in that
paper. In particular, the radiation energy equation takes the form
of:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial E_R}{\partial t} =
 \nabla \cdot \left ( \frac{c \lambda(E_R)}{\kappa_R} \nabla E_R \right ) +
 \kappa_P (4 \sigma T^4 - c E_R )\]</div>
<p>Here, <span class="math notranslate nohighlight">\(E_R\)</span> is the radiation energy density, <span class="math notranslate nohighlight">\(\kappa_R\)</span> is the
Roseland-mean opacity, <span class="math notranslate nohighlight">\(\kappa_P\)</span> is the Planck-mean opaciy, and
<span class="math notranslate nohighlight">\(\lambda\)</span> is a quantity <span class="math notranslate nohighlight">\(\le 1/3\)</span> that is subjected to limiting to
keep the radiation field causal. Castro allows for <span class="math notranslate nohighlight">\(\kappa_R\)</span>
and <span class="math notranslate nohighlight">\(\kappa_P\)</span> to be set independently as power-laws.</p>
<section id="light-front">
<h3>Light Front<a class="headerlink" href="#light-front" title="Link to this heading"></a></h3>
<p>The light front problem tests the ability of the radiation solver to
operate in the free-streaming limit. A radiation front is
established by initializing one end of the computational domain with
a finite radiation field, and zero radiation field everywhere else.
The speed of propagation of the radiation front is keep in check by
the flux-limiters, to prevent it from exceeding <span class="math notranslate nohighlight">\(c\)</span>.</p>
</section>
<section id="diffusion-of-a-gaussian-pulse">
<h3>Diffusion of a Gaussian Pulse<a class="headerlink" href="#diffusion-of-a-gaussian-pulse" title="Link to this heading"></a></h3>
<p>The diffusion of a Gaussian pulse problem tests the diffusion term in
the radiation energy equation. The radiation energy density is
initialized at time <span class="math notranslate nohighlight">\(t = t_0\)</span> to a Gaussian distribution:</p>
<div class="math notranslate nohighlight">
\[E_R = (E_R)_0 \exp \left \{ - \frac{1}{4 D t_0} |r - r_0|^2 \right \}\]</div>
<p>As the radiation diffuses, the overall distribution will remain
Gaussian, with the time-dependent solution of:</p>
<div class="math notranslate nohighlight">
\[E_R = (E_R)_0 \frac{t_0}{t_0 + t} \exp \left \{ -\frac{1}{4 D (t_0 + t)} |r - r_0|^2 \right \}\]</div>
</section>
<section id="radiation-source-problem">
<h3>Radiation Source Problem<a class="headerlink" href="#radiation-source-problem" title="Link to this heading"></a></h3>
<p>The radiation source problem tests the coupling between the radiation
field and the gas energy through the radiation source term. The
problem begins with the radiation field and gas temperature out of
equilibrium. If the gas is too cool, then the radiation field will
heat it. If the gas is too hot, then it will radiate and cool. In
each case, the gas energy and radiation field will evolve until
thermal equilibrium is achieved.</p>
<p>Our implementation of this problem follows that of
<span id="id9">[<a class="reference internal" href="zreferences.html#id45" title="F. D. Swesty and E. S. Myra. A Numerical Algorithm for Modeling Multigroup Neutrino-Radiation Hydrodynamics in Two Spatial Dimensions. Astrophysical Journal Supplement, 181:1-52, March 2009. doi:10.1088/0067-0049/181/1/1.">67</a>]</span>.</p>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="_images/radiating_source.png"><img alt="radiatin source" src="_images/radiating_source.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Castro solution for radiating source test problem. Heating and
cooling solutions are shown as a function of time, compared to the
analytic solution. The gray photon solver was used.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="radiating-sphere">
<h3>Radiating Sphere<a class="headerlink" href="#radiating-sphere" title="Link to this heading"></a></h3>
<p>The radiating sphere (RadSphere) is a multigroup radiation
test problem. A hot sphere is centered at the origin in a spherical
geometry. The spectrum from this sphere follows a Planck
distribution. The ambient medium is at a much lower temperature. A
frequency-dependent opacity makes the domain optically thin for high
frequencies and optically thick for low frequency. At long times, the
solution will be a combination of the blackbody radiation from the
ambient medium plus the radiation that propagated from the hot sphere.
An analytic solution exists <span id="id10">[<a class="reference internal" href="zreferences.html#id46" title="F. Graziani. The prompt spectrum of a radiating sphere: benchmark solutions for diffusion and transport. In F. Graziani, editor, Computational Methods in Transport: Verification and Validation, number 62 in Lecture Notes in Computational Science and Engineering, pages 151-167. Springer, 2008.">42</a>]</span> which gives the
radiation energy as a function of energy group at a specified time and
distance from the radiating sphere.</p>
<p>Our implementation of this problem is in Exec/radiation_tests/RadSphere and
follows that of <span id="id11">[<a class="reference internal" href="zreferences.html#id45" title="F. D. Swesty and E. S. Myra. A Numerical Algorithm for Modeling Multigroup Neutrino-Radiation Hydrodynamics in Two Spatial Dimensions. Astrophysical Journal Supplement, 181:1-52, March 2009. doi:10.1088/0067-0049/181/1/1.">67</a>]</span>. The routine that computes
the analytic solution is provided as analytic.f90.</p>
<figure class="align-default" id="id21">
<a class="reference internal image-reference" href="_images/radiating_sphere.png"><img alt="radiating sphere" src="_images/radiating_sphere.png" style="width: 5in;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Castro solution for radiating sphere problem, showing the radiation
energy density as a function of energy group.  This test was run
with 64 photon energy groups.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="regression-testing">
<h2>Regression Testing<a class="headerlink" href="#regression-testing" title="Link to this heading"></a></h2>
<p>An automated regression test suite for Castro (or any AMReX-based
code) written in Python exists in the AMReX-Codes github organization.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="MAESTRO_restart.html" class="btn btn-neutral float-left" title="Restarting from Maestro" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="development.html" class="btn btn-neutral float-right" title="Development Best Practices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Castro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>