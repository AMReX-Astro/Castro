

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setting Up Your Own Problem &mdash; Castro 19.01
 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Parallel I/O" href="io.html" />
    <link rel="prev" title="Software Design" href="software.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Castro
          

          
          </a>

          
            
            
              <div class="version">
                19.01

              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Castro basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software Design</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting Up Your Own Problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#optional-files">Optional Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dimension-agnostic-problem-initialization">Dimension Agnostic Problem Initialization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Parallel I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Castro reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_conventions.html">Coding Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu_porting.html">Offloading a routine to GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="EOSNetwork.html">Microphysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertCheckpoint.html">Checkpoint Embiggener</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1"><a class="reference internal" href="Verification.html">Verification</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Castro</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Setting Up Your Own Problem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/creating_a_problem.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setting-up-your-own-problem">
<h1>Setting Up Your Own Problem<a class="headerlink" href="#setting-up-your-own-problem" title="Permalink to this headline">¶</a></h1>
<p>To define a new problem, we create a new directory in one
of the subdirectories of <code class="docutils literal notranslate"><span class="pre">Exec/</span></code>,
and place in it a <code class="docutils literal notranslate"><span class="pre">Prob_2d.f90</span></code> file (or 1d/3d,
depending on the dimensionality of the problem), a <code class="docutils literal notranslate"><span class="pre">probdata.f90</span></code>
file, the <code class="docutils literal notranslate"><span class="pre">inputs</span></code> and <code class="docutils literal notranslate"><span class="pre">probin</span></code> files, and a
<code class="docutils literal notranslate"><span class="pre">Make.package</span></code> file that tells the build system what problem-specific
routines exist. Finally, if you need custom boundary conditions, a
<code class="docutils literal notranslate"><span class="pre">bc_fill_2d.F90</span></code> (or 1d/3d) file is needed. The
simplest way to get started is to copy these files from an existing
problem. Here we describe how to customize your problem.</p>
<p>The purpose of these files is:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">probdata.f90</span></code>: this holds the <code class="docutils literal notranslate"><span class="pre">probdata_module</span></code> Fortran module
that allocates storage for all the problem-specific runtime parameters that
are used by the problem (including those that are read from the <code class="docutils literal notranslate"><span class="pre">probin</span></code>
file.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Prob_?d.f90</span></code>: this holds the main routines to
initialize the problem and grid and perform problem-specific boundary
conditions:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">probinit()</span></code>:</p>
<p>This routine is primarily responsible for reading in the
<code class="docutils literal notranslate"><span class="pre">probin</span></code> file (by defining the <code class="docutils literal notranslate"><span class="pre">&amp;fortin</span></code> namelist and
reading in an initial model (usually through the
<code class="docutils literal notranslate"><span class="pre">model_parser_module</span></code>—see the <code class="docutils literal notranslate"><span class="pre">toy_convect</span></code> problem
setup for an example). The parameters that are initialized
here are those stored in the <code class="docutils literal notranslate"><span class="pre">probdata_module</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">many problems set the value of the <code class="docutils literal notranslate"><span class="pre">center()</span></code> array
from <code class="docutils literal notranslate"><span class="pre">prob_params_module</span></code> here.  This is used to note the
center of the problem (which does not necessarily need to be
the center of the domain, e.g., for axisymmetric problems).
<code class="docutils literal notranslate"><span class="pre">center</span></code> is used in source terms (including rotation and
gravity) and in computing some of the derived variables (like
angular momentum).</p>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ca_initdata()</span></code>:</p>
<p>This routine will initialize the state data for a single grid.
The inputs to this routine are:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">level</span></code>: the level of refinement of the grid we are filling</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">time</span></code>: the simulation time</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">lo()</span></code>, <code class="docutils literal notranslate"><span class="pre">hi()</span></code>: the integer indices of the box’s
<em>valid data region</em> lower left and upper right corners. These
integers refer to a global index space for the level and
identify where in the computational domain the box lives.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nscal</span></code>: the number of scalar quantities—this is not typically
used in Castro.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">state_l1</span></code>, <code class="docutils literal notranslate"><span class="pre">state_l2</span></code>, (<code class="docutils literal notranslate"><span class="pre">state_l3</span></code>): the
integer indices of the lower left corner of the box in each
coordinate direction. These are for the box as allocated in memory,
so they include any ghost cells as well as the valid data regions.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">state_h1</span></code>, <code class="docutils literal notranslate"><span class="pre">state_h2</span></code>, (<code class="docutils literal notranslate"><span class="pre">state_h3</span></code>): the
integer indices of the upper right corner of the box in each
coordinate direction. These are for the box as allocated in memory,
so they include any ghost cells as well as the valid data regions.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">state()</span></code>: the main state array. This is dimensioned as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">state</span><span class="p">(</span><span class="n">state_l1</span><span class="p">:</span><span class="n">state_h1</span><span class="p">,</span><span class="n">state_l2</span><span class="p">:</span><span class="n">state_h2</span><span class="p">,</span><span class="n">NVAR</span><span class="p">)</span>
</pre></div>
</div>
<p>(in 2-d), where <code class="docutils literal notranslate"><span class="pre">NVAR</span></code> comes from the <code class="docutils literal notranslate"><span class="pre">meth_params_module</span></code>.</p>
<p>When accessing this array, we use the index keys provided by
meth_params_module (e.g., <code class="docutils literal notranslate"><span class="pre">URHO</span></code>) to refer to specific
quantities</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">delta()</span></code>: this is an array containing the zone width (<span class="math notranslate nohighlight">\(\Delta x\)</span>)
in each coordinate direction: <span class="math notranslate nohighlight">\(\mathtt{delta(1)} = \Delta x\)</span>,
<span class="math notranslate nohighlight">\(\mathtt{delta(2)} = \Delta y\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">xlo()</span></code>, <code class="docutils literal notranslate"><span class="pre">xhi()</span></code>: these are the physical coordinates of the
lower left and upper right corners of the <em>valid region</em>
of the box. These can be used to compute the coordinates of the
cell-centers of a zone as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="n">j</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">hi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">xlo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">delta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">dble</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">lo</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">d0</span><span class="p">)</span>
   <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method works fine for the problem
initialization stuff, but for routines that implement
tiling, as discussed below, <code class="docutils literal notranslate"><span class="pre">lo</span></code> and <code class="docutils literal notranslate"><span class="pre">xlo</span></code> may not
refer to the same corner, and instead coordinates should
be computed using <code class="docutils literal notranslate"><span class="pre">problo()</span></code> from the
<code class="docutils literal notranslate"><span class="pre">prob_params_module</span></code>.</p>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bc_fill_?d.F90</span></code>:</p>
<p>These routines handle how Castro fills ghostcells
<em>at physical boundaries</em> for specific data. Most problem
setups won’t need to do anything special here, and inclusion
of this file is optional–only use it if you need to set
specific boundary conditions.</p>
<p>These routines are registered in <code class="docutils literal notranslate"><span class="pre">Castro_setup.cpp</span></code>, and
called as needed. By default, they just
pass the arguments through to <code class="docutils literal notranslate"><span class="pre">filcc</span></code>, which handles all of
the generic boundary conditions (like reflecting, extrapolation,
etc.). The specific ‘fill’ routines can then supply the
problem-specific boundary conditions, which are typically just
Dirichlet boundary conditions (usually this means looking to see
if the <code class="docutils literal notranslate"><span class="pre">bc()</span></code> flag at a boundary is <code class="docutils literal notranslate"><span class="pre">EXT_DIR</span></code>). The
problem-specific code implementing these specific conditions
should <em>follow</em> the <code class="docutils literal notranslate"><span class="pre">filcc</span></code> call.</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ca_hypfill</span></code>:
This handles the boundary filling for the hyperbolic system.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ca_denfill</span></code>: At times, we need to fill just the density
(always assumed to be the first element in the hyperbolic state)
instead of the entire state. When the fill patch routine is called
with <code class="docutils literal notranslate"><span class="pre">first_comp</span></code> = <code class="docutils literal notranslate"><span class="pre">Density</span></code> and <code class="docutils literal notranslate"><span class="pre">num_comp</span></code> = 1, then we
use <code class="docutils literal notranslate"><span class="pre">ca_denfill</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ca_hypfill</span></code>.</p>
<p>(Note: it seems that this may be used for more than just
density, but it is only used for tagging and the plotfile)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ca_grav?fill</span></code>: These routines fill will the ghostcells
of the gravitational acceleration grids with the gravitational
acceleration.</p>
<p>Note: for constant gravity, these routines will never be called.
For one of the Poisson-type gravities, you only need to do
something special here if you are implementing an Interior
boundary type (which you can test for by comparing
<code class="docutils literal notranslate"><span class="pre">bc(:,:,:)</span></code> to <code class="docutils literal notranslate"><span class="pre">EXT_DIR</span></code>.</p>
<p>For the other standard physical boundary types, the ghost cell
filling will be handled automatically by the default <code class="docutils literal notranslate"><span class="pre">filcc</span></code>
call in these routines.</p>
<p>The gravitational acceleration in the ghost cells is used during
the hydrodynamics portion of the code in predicting the
interface states.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ca_reactfill</span></code>: This handles boundary filling for
any <code class="docutils literal notranslate"><span class="pre">Reactions_Type</span></code> <a href="#id1"><span class="problematic" id="id2">``</span></a>MultiFAB``s, which are sometimes used to interface
with the nuclear burning module. It stores the normal state data
in addition to components for the energy release and species change.</p>
</li>
</ul>
<p>These routines take the following arguments:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">adv_l1</span></code>, <code class="docutils literal notranslate"><span class="pre">adv_l2</span></code>, (<code class="docutils literal notranslate"><span class="pre">adv_l3</span></code>): the indicies of
the lower left corner of the box holding the data we are working on.
These indices refer to the entire box, including ghost cells.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">adv_h1</span></code>, <code class="docutils literal notranslate"><span class="pre">adv_h2</span></code>, (<code class="docutils literal notranslate"><span class="pre">adv_h3</span></code>): the indicies of
the upper right corner of the box holding the data we are working on.
These indices refer to the entire box, including ghost cells.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">adv()</span></code>: the array of data whose ghost cells we are filling.
Depending on the routine, this may have an additional index refering
to the variable.</p>
<p>This is dimensioned as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">adv</span><span class="p">(</span><span class="n">adv_l1</span><span class="p">:</span><span class="n">adv_h1</span><span class="p">,</span><span class="n">adv_l2</span><span class="p">:</span><span class="n">adv_h2</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">domlo()</span></code>, <code class="docutils literal notranslate"><span class="pre">domhi()</span></code>: the integer indices of the lower
left and upper right corners of the valid region of the <em>entire
domain</em>. These are used to test against to see if we are filling
physical boundary ghost cells.</p>
<p>This changes according to refinement level: level-0 will
range from 0 to <code class="docutils literal notranslate"><span class="pre">castro.max_grid_size</span></code>,
and level-n will range from 0 to
<span class="math notranslate nohighlight">\(\mathtt{castro.max\_grid\_size} \cdot \prod_n \mathtt{castro.ref\_ratio(n)}\)</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">delta()</span></code>: is the zone width in each coordinate direction,
as in <code class="docutils literal notranslate"><span class="pre">initdata()</span></code> above.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">xlo()</span></code>: this is the physical coordinate of the lower
left corner of the box we are filling—including the ghost cells.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this is different than how <code class="docutils literal notranslate"><span class="pre">xlo()</span></code> was defined in
<code class="docutils literal notranslate"><span class="pre">initdata()</span></code> above.</p>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">time</span></code>: the simulation time</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bc()</span></code>: an array that holds the type of boundary conditions
to enforce at the physical boundaries for <code class="docutils literal notranslate"><span class="pre">adv</span></code>.</p>
<p>Sometimes it appears of the form <code class="docutils literal notranslate"><span class="pre">bc(:,:)</span></code> and sometimes
<code class="docutils literal notranslate"><span class="pre">bc(:,:,:)</span></code>—the last index of the latter holds the variable
index, i.e., density, pressure, species, etc.</p>
<p>The first index is the coordinate direction and the second index
is the domain face (1 is low, 2 is hi), so
<code class="docutils literal notranslate"><span class="pre">bc(1,1)</span></code> is the lower <span class="math notranslate nohighlight">\(x\)</span> boundary type, <code class="docutils literal notranslate"><span class="pre">bc(1,2)</span></code> is
the upper <span class="math notranslate nohighlight">\(x\)</span> boundary type, <code class="docutils literal notranslate"><span class="pre">bc(2,1)</span></code> is the lower
<span class="math notranslate nohighlight">\(y\)</span> boundary type, etc.</p>
<p>To interpret the array values, we test against the quantities
defined in <code class="docutils literal notranslate"><span class="pre">bc_types.fi</span></code> included in each subroutine,
for example, <code class="docutils literal notranslate"><span class="pre">EXT_DIR</span></code>, <code class="docutils literal notranslate"><span class="pre">FOEXTRAP</span></code>, <span class="math notranslate nohighlight">\(\ldots\)</span>. The
meaning of these are explained below.</p>
</li>
</ul>
</li>
</ul>
<div class="section" id="optional-files">
<h2>Optional Files<a class="headerlink" href="#optional-files" title="Permalink to this headline">¶</a></h2>
<p>The follow problem-specific files are optional. There are stubs for
each of these in the main source tree.</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Problem.f90</span></code> :</p>
<p>This provides two routines, <code class="docutils literal notranslate"><span class="pre">problem_checkpoint</span></code> and
<code class="docutils literal notranslate"><span class="pre">problem_restart</span></code> that can be used to add information to the
checkpoint files and read it in upon restart. This is useful for
some global problem-specific quantities. For instance, the
wdmerger <a class="footnote-reference" href="#id4" id="id3">[5]</a> problem uses this
to store center of mass position and velocity information in the
checkpoint files that are used for runtime diagnostics.</p>
<p>The name of the checkpoint directory is passed in as an argument.
<code class="docutils literal notranslate"><span class="pre">Problem_F.H</span></code> provides the C++ interfaces for these routines.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">problem_tagging_?d.F90</span></code>, <code class="docutils literal notranslate"><span class="pre">problem_tagging_nd.F90</span></code></p>
<p>This implements problem-specific tagging for refinement, through a
subroutine <code class="docutils literal notranslate"><span class="pre">set_problem_tags</span></code>. The full hydrodynamic state
(State_Type) is passed in, and the problem can mark zones for
refinement by setting the tag variable for a zone to
set. An example is provided by the <code class="docutils literal notranslate"><span class="pre">toy_convect</span></code>
problem which refines a rectangular region (fuel layer) based on
a density parameter and the H mass fraction.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Problem_Derive_F.H</span></code>, <code class="docutils literal notranslate"><span class="pre">Problem_Derives.H</span></code>, <code class="docutils literal notranslate"><span class="pre">problem_derive_nd.f90</span></code></p>
<p>Together, these provide a mechanism to create derived quantities
that can be stored in the plotfile. <code class="docutils literal notranslate"><span class="pre">Problem_Derives.H</span></code>
provides the C++ code that defines these new plot variables. It
does this by adding them to the <code class="docutils literal notranslate"><span class="pre">derive_lst</span></code>—a list of
derived variables that Castro knows about. When adding new
variables, a descriptive name, Fortran routine that does the
deriving, and component of <code class="docutils literal notranslate"><span class="pre">StateData</span></code>&nbsp;are specified.</p>
<p>The Fortran routine that does the deriving is put in the
problem-specific <code class="docutils literal notranslate"><span class="pre">problem_derive_nd.f90</span></code> (and a prototype for
C++ is put in <code class="docutils literal notranslate"><span class="pre">Problem_Derives.H</span></code>). A example is provided by
the <code class="docutils literal notranslate"><span class="pre">reacting_bubble</span></code> problem, which derives several new
quantities (perturbations against a background one-dimensional
model, in this case).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Prob.cpp</span></code>, <code class="docutils literal notranslate"><span class="pre">Problem.H</span></code>, <code class="docutils literal notranslate"><span class="pre">Problem_F.H</span></code></p>
<p>These files provide problem-specific routines for computing global
diagnostic information through the sum_integrated_quantities
functionality that is part of the <code class="docutils literal notranslate"><span class="pre">Castro</span></code> class.</p>
<p>An example is provided by <code class="docutils literal notranslate"><span class="pre">toy_flame</span></code>, where an estimate
of the flame speed is computed by integrating the mass of fuel on
the grid.</p>
</li>
</ul>
</div>
<div class="section" id="dimension-agnostic-problem-initialization">
<h2>Dimension Agnostic Problem Initialization<a class="headerlink" href="#dimension-agnostic-problem-initialization" title="Permalink to this headline">¶</a></h2>
<p>Most of the problem setups have separate implementations for 1-, 2-,
and 3D. A new method exists that allows you to write just a single
set of files for any dimensionality (this is called the <em>dimension
agnostic</em> format). To use this mode, set
<code class="docutils literal notranslate"><span class="pre">DIMENSION_AGNOSTIC</span></code> = <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> in your <code class="docutils literal notranslate"><span class="pre">GNUmakefile</span></code>.
Then write you problem initialization in <code class="docutils literal notranslate"><span class="pre">Prob_nd.F90</span></code>.
Analogous routines exist for tagging and boundary conditions. See the
<code class="docutils literal notranslate"><span class="pre">rotating_torus</span></code> and <code class="docutils literal notranslate"><span class="pre">Noh</span></code> problem setups for an
example.</p>
<span class="target" id="software-io"></span><table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[5]</a></td><td>available separately at
<a class="reference external" href="https://github.com/BoxLib-Codes/wdmerger">https://github.com/BoxLib-Codes/wdmerger</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="io.html" class="btn btn-neutral float-right" title="Parallel I/O" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="software.html" class="btn btn-neutral" title="Software Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Castro development tem

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"kth": "{{k_\\mathrm{th}}}", "gcc": "{\\mathrm{g~cm^{-3}}}", "cms": "{\\mathrm{cm~s^{-1}}}", "presunit": "{\\mathrm{dyn~cm^{-2}}}", "accelunit": "{\\mathrm{cm~s^{-2}}}", "ergg": "{\\mathrm{erg~g^{-1}}}", "Ab": "{{\\bf A}}", "eb": "{{\\bf e}}", "Fb": "{{\\bf F}}", "gb": "{{\\bf g}}", "Hb": "{{\\bf H}}", "ib": "{{\\bf i}}", "Ib": "{{\\bf I}}", "Kb": "{{\\bf K}}", "lb": "{{\\bf l}}", "Lb": "{{\\bf L}}", "nb": "{{\\bf n}}", "Pb": "{{\\bf P}}", "Qb": "{{\\bf Q}}", "rb": "{{\\bf r}}", "Rb": "{{\\bf R}}", "Sb": "{{\\bf S}}", "ub": "{{\\bf u}}", "Ub": "{{\\bf U}}", "xb": "{{\\bf x}}", "dt": "{\\Delta t}", "omegadot": "{\\dot\\omega}", "inp": "{{\\rm in}}", "outp": "{{\\rm out}}", "sync": "{{\\rm sync}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\half}", "nph": "{{n+\\myhalf}}", "kpp": "{\\ensuremath{\\kappa_{\\mathrm{P}}}}", "kpr": "{\\ensuremath{\\kappa_{\\mathrm{R}}}}", "kpf": "{\\ensuremath{\\kappa_{\\mathrm{F}}}}", "vb": "{\\boldsymbol{v}}", "vbt": "{\\widetilde{\\vb}}", "rbt": "{\\widetilde{\\rb}}", "ob": "{\\boldsymbol{\\omega}}", "nablab": "{\\boldsymbol{\\nabla}}"}}})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>