

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting Up Your Own Problem &mdash; Castro  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=2e394b92" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Outputting" href="io.html" />
    <link rel="prev" title="Timestepping and Retries" href="timestepping.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            Castro
              <img src="_static/castro_logo_hot_200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="./creating_a_problem.html">main</a> | <a href="./dev/creating_a_problem.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Castro basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction to Castro</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi_plus_x.html">Running Options: CPUs and GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="FlowChart.html">Flowchart</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Programming Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="problem_setups.html">Distributed Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="timestepping.html">Timestepping and Retries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting Up Your Own Problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#runtime-parameters">Runtime Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problem-initialization">Problem Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-files">Optional Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-parser">Model Parser</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Outputting</a></li>
<li class="toctree-l1"><a class="reference internal" href="regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Castro reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_system.html">Build System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="hse.html">Hydrostatic Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="EOS.html">Equation of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactions.html">Reactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="mhd.html">MHD</a></li>
<li class="toctree-l1"><a class="reference internal" href="gravity.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion.html">Thermal Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponge.html">Sponge</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="AMR.html">Adaptive Mesh Refinement</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertCheckpoint.html">Checkpoint Embiggener</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_consistent_field.html">Self-Consistent Field Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAESTRO_restart.html">Restarting from Maestro</a></li>
<li class="toctree-l1"><a class="reference internal" href="Verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Best Practices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="classlist.html">Class list</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Castro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setting Up Your Own Problem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/creating_a_problem.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setting-up-your-own-problem">
<h1>Setting Up Your Own Problem<a class="headerlink" href="#setting-up-your-own-problem" title="Link to this heading"></a></h1>
<p>Castro problems are organized loosely into groups describing their
intent (e.g., science, hydro tests, …).  These groups are
sub-directories under the <code class="docutils literal notranslate"><span class="pre">Castro/Exec/</span></code> directory.  Each problem is
then placed in a sub-directory of the appropriate group (for example,
<code class="docutils literal notranslate"><span class="pre">Castro/Exec/hydro_tests/Sedov</span></code> holds the Sedov test problem).</p>
<p>To create a new problem, you will create a new directory under one
of the groups and place in it the following files:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GNUmakefile</span></code> : the makefile for this problem.  This will tell
Castro what options to use and what network and EOS to build.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">problem_initialize.H</span></code> and
<code class="docutils literal notranslate"><span class="pre">problem_initialize_state_data.H</span></code> : this holds the problem
initialization routines.  MHD and radiation problems require
an additional file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_prob_params</span></code> (optional) : a list of runtime parameters that
you problem will read.  These parameters are controlled by the
set in the inputs file as <code class="docutils literal notranslate"><span class="pre">problem.param</span></code> where <code class="docutils literal notranslate"><span class="pre">param</span></code> is
one of the parameters listed in <code class="docutils literal notranslate"><span class="pre">_prob_params</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Make.package</span></code> : this is a makefile fragment that is included
during the build process.  It tells the build system about any
problem-specific files that need to be compiled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inputs</span></code> : this is the main inputs file that controls Castro and
AMReX’s behavior.</p></li>
</ul>
</div></blockquote>
<p>The best way to get started writing a new problem is to copy an
existing problem setup into a new directory.</p>
<section id="runtime-parameters">
<span id="index-0"></span><h2>Runtime Parameters<a class="headerlink" href="#runtime-parameters" title="Link to this heading"></a></h2>
<p>The problem-specific runtime parameters are defined in <code class="docutils literal notranslate"><span class="pre">_prob_params</span></code>.
This has the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>name       datatype    default      namelist?     size
</pre></div>
</div>
<p>Here:</p>
<ul class="simple">
<li><p><cite>name</cite> is the name of the variable to put into <code class="docutils literal notranslate"><span class="pre">probdata_module</span></code></p></li>
<li><p><cite>datatype</cite> is one of <code class="docutils literal notranslate"><span class="pre">real</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">character</span></code>, or
<code class="docutils literal notranslate"><span class="pre">logical</span></code>.</p></li>
<li><p><cite>default</cite> is the default value of the runtime parameter.  It may be
overridden at runtime by reading from the namelist.</p></li>
<li><p><cite>namelist</cite> indicates if the variable should be able to be set as
a runtime parameter.  If it is empty or marked with
<code class="docutils literal notranslate"><span class="pre">n</span></code>, then the variable will still be creates in the <code class="docutils literal notranslate"><span class="pre">problem</span></code> namespace,
but it will not be able to be set via the commandline or inputs file.
A common usage of this is to define global variables that might be set
at problem initialization that are used elsewhere in Castro.</p></li>
<li><p><cite>size</cite> is for arrays, and gives their size.  It can be any integer
or variable that is known to the <code class="docutils literal notranslate"><span class="pre">probdata_module</span></code>.  If you need a
variable from a different module to specify the size (for example,
<code class="docutils literal notranslate"><span class="pre">nspec</span></code> from <code class="docutils literal notranslate"><span class="pre">network</span></code>), then you express the size as a tuple:
<code class="docutils literal notranslate"><span class="pre">(nspec,</span> <span class="pre">network)</span></code> and the appropriate use statement will be
added.</p></li>
</ul>
<p>The variables will all be initialized for the GPU as well.</p>
</section>
<section id="problem-initialization">
<h2>Problem Initialization<a class="headerlink" href="#problem-initialization" title="Link to this heading"></a></h2>
<p>Here we describe the main problem initialization routines.</p>
<ul id="index-1">
<li><p><code class="docutils literal notranslate"><span class="pre">initialize_problem()</span></code></p>
<p>This C++ routine is primarily responsible for doing any one-time
initialization for the problem (like reading in an
initial model through the <code class="docutils literal notranslate"><span class="pre">model_parser.H</span></code> functionality—see the
<code class="docutils literal notranslate"><span class="pre">toy_convect</span></code> problem setup for an example.</p>
<p>This routine can also postprocess any of the parameters defined
in the <code class="docutils literal notranslate"><span class="pre">_prob_params</span></code> file, which are defined in <code class="docutils literal notranslate"><span class="pre">problem</span></code> namespace.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>many problems set the value of the <code class="docutils literal notranslate"><span class="pre">problem::center[]</span></code> array
from the <code class="docutils literal notranslate"><span class="pre">problem</span></code> namespace.  This is used to note the
center of the problem (which does not necessarily need to be
the center of the domain, e.g., for axisymmetric problems).
<code class="docutils literal notranslate"><span class="pre">center</span></code> is used in source terms (including rotation and
gravity) and in computing some of the derived variables (like
angular momentum).</p>
</div>
<p>If you need coordinate information, it can be obtained
by constructing a <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> object using <code class="docutils literal notranslate"><span class="pre">DefaultGeometry()</span></code>
and accessing its <code class="docutils literal notranslate"><span class="pre">ProbLo()</span></code> and <code class="docutils literal notranslate"><span class="pre">ProbHi()</span></code> methods.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">problem_initialize_state_data()</span></code>:</p>
<p>This routine will initialize the state data in a given zone.
The arguments passed are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span></code>: the index of the zone to fill the data in</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code>: an array containing the simulation state data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GeomData</span></code>: a <code class="docutils literal notranslate"><span class="pre">GeometryData</span></code> object that can be used for obtaining
<code class="docutils literal notranslate"><span class="pre">dx</span></code>, <code class="docutils literal notranslate"><span class="pre">problo</span></code>, <code class="docutils literal notranslate"><span class="pre">probhi</span></code>, etc.</p></li>
</ul>
<p>Filling data is done by simply writing to <code class="docutils literal notranslate"><span class="pre">state(i,j,k,URHO)</span></code>, etc.</p>
</li>
</ul>
</section>
<section id="boundary-conditions">
<span id="create-bcs"></span><h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading"></a></h2>
<p id="index-2">Standard boundary conditions, including outflow (zero-gradient), periodic,
and symmetry (reflect) are handled by AMReX directly.  Castro has a special
hydrostatic boundary condition that can be used for the lower boundary.  It
is accessed by setting the <code class="docutils literal notranslate"><span class="pre">castro.lo_bc</span></code> flag to 1 in the vertical coordinate
direction, e.g., for 2-d as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">castro</span><span class="o">.</span><span class="n">lo_bc</span>       <span class="o">=</span>  <span class="mi">0</span>   <span class="mi">1</span>
</pre></div>
</div>
<p>The flag value 1 is traditionally named “inflow” by AMReX, but generally means that
the boundary implementation is left to the user.  To tell Castro to use the
hydrostatic boundary condition here, we set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">castro</span><span class="o">.</span><span class="n">yl_ext_bc_type</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">castro</span><span class="o">.</span><span class="n">hse_interp_temp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">castro</span><span class="o">.</span><span class="n">hse_reflect_vels</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The first parameter tells Castro to use the HSE boundary condition for the lower
y direction.
In filling the ghost cells, hydrostatic equilibrium will be integrated
from the last interior zone into the boundary.  We need one more
equation for this integration, so we either interpolate the density or
temperature into the ghost cells, depending on the value of
<code class="docutils literal notranslate"><span class="pre">castro.hse_interp_temp</span></code>.  Finally, <code class="docutils literal notranslate"><span class="pre">castro.hse_reflect_vels</span></code>
determines how we treat the velocity.  The default is to give is a
zero gradient, but in tests we’ve found that reflecting the velocity
while integrating the HSE profile can be better.  For modeling a
plane-parallel hydrostatic atmosphere, using the hydrostatic boundary
conditions instead of a simple symmetry boundary is essential when
using the standard CTU PPM solver.</p>
<p id="index-3">A different special boundary condition, based on outflow, is available at
the upper boundary.  This works together with the <code class="docutils literal notranslate"><span class="pre">model_parser</span></code>
module to fill the ghost cells at the upper boundary with the initial
model data.  You set this as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">castro</span><span class="o">.</span><span class="n">hi_bc</span> <span class="o">=</span> <span class="mi">2</span> <span class="mi">2</span>

<span class="n">castro</span><span class="o">.</span><span class="n">fill_ambient_bc</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">castro</span><span class="o">.</span><span class="n">ambient_fill_dir</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">castro</span><span class="o">.</span><span class="n">ambient_outflow_vel</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">ambient_fill_dir</span></code> is the 0-based direction to fill using an
ambient state defined by the problem setup.  In this example, we will
override the outflow (2) boundary condition in the y-direction.  That
problem setup needs to fill the <code class="docutils literal notranslate"><span class="pre">ambient_state[:]</span></code> array defined in
<code class="docutils literal notranslate"><span class="pre">ambient.H</span></code>.  An example of using this boundary is in the
<code class="docutils literal notranslate"><span class="pre">flame_wave</span></code> problem.</p>
<p>The implementations of these boundary conditions is found in
<code class="docutils literal notranslate"><span class="pre">Castro/Source/problems/Castro_bc_fill_nd.cpp</span></code>.</p>
</section>
<section id="optional-files">
<h2>Optional Files<a class="headerlink" href="#optional-files" title="Link to this heading"></a></h2>
<p>The follow problem-specific files are optional. There are stubs for
each of these in the main source tree.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">problem_checkpoint.H</span></code>, <code class="docutils literal notranslate"><span class="pre">problem_restart.H</span></code> :</p>
<p>These provides two routines, respectively <code class="docutils literal notranslate"><span class="pre">problem_checkpoint</span></code> and
<code class="docutils literal notranslate"><span class="pre">problem_restart</span></code> that can be used to add information to the
checkpoint files and read it in upon restart. This is useful for
some global problem-specific quantities. For instance, the
<code class="docutils literal notranslate"><span class="pre">wdmerger</span></code> problem uses this to store center of mass position and
velocity information in the checkpoint files that are used for
runtime diagnostics.</p>
<p>The name of the checkpoint directory is passed in as an argument.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">problem_tagging.H</span></code></p>
<p>This implements problem-specific tagging for refinement, through a
the function <code class="docutils literal notranslate"><span class="pre">problem_tagging</span></code>. The full hydrodynamic state (State_Type)
is passed in, and the problem can mark zones for refinement by setting the
tag variable for a zone to set. An example is provided by the <code class="docutils literal notranslate"><span class="pre">toy_convect</span></code>
problem which refines a rectangular region (fuel layer) based on
a density parameter and the H mass fraction.</p>
</li>
<li id="problem-derives"><p><code class="docutils literal notranslate"><span class="pre">Problem_Derives.H</span></code>, <code class="docutils literal notranslate"><span class="pre">Problem_Derive.H</span></code>, and <code class="docutils literal notranslate"><span class="pre">Problem_Derive.cpp</span></code></p>
<p>Together, these provide a mechanism to create derived quantities
that can be stored in the plotfile. <code class="docutils literal notranslate"><span class="pre">Problem_Derives.H</span></code>
provides the C++ code that defines these new plot variables. It
does this by adding them to the <code class="docutils literal notranslate"><span class="pre">derive_lst</span></code>—a list of
derived variables that Castro knows about. When adding new
variables, a descriptive name, a C++ routine that does the
deriving, and component of <code class="docutils literal notranslate"><span class="pre">StateData</span></code> are specified.</p>
<p>The other two files provide the header and implementation of the
function that computes the derived variable.  A example is provided
by the <code class="docutils literal notranslate"><span class="pre">reacting_bubble</span></code> problem, which derives several new
quantities (perturbations against a background one-dimensional
model, in this case).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Prob.cpp</span></code>, <code class="docutils literal notranslate"><span class="pre">Problem.H</span></code></p>
<p>These files provide problem-specific routines for computing global
diagnostic information through the sum_integrated_quantities
functionality that is part of the <code class="docutils literal notranslate"><span class="pre">Castro</span></code> class.</p>
<p>An example is provided by <code class="docutils literal notranslate"><span class="pre">toy_flame</span></code>, where an estimate
of the flame speed is computed by integrating the mass of fuel on
the grid.</p>
</li>
</ul>
</section>
<section id="model-parser">
<h2>Model Parser<a class="headerlink" href="#model-parser" title="Link to this heading"></a></h2>
<p id="index-4">Many problem setups begin with a 1-d initial model that is mapped onto
the grid.  The <code class="docutils literal notranslate"><span class="pre">model_parser.H</span></code> provides the functions that read in
the initial model and map it on the Castro grid.  To enable this, add:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">USE_MODEL_PARSER</span> <span class="o">=</span> <span class="n">TRUE</span>
</pre></div>
</div>
<p>to the problem <code class="docutils literal notranslate"><span class="pre">GNUmakefile</span></code>.  There are 2 other parameters that can
be set in the makefile to control the initial model storage:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MAX_NPTS_MODEL</span></code>: is the maximum number of data points in the
1-d initial model.  This needs to be known at compile time so we
can make the data managed for GPUs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NUM_MODELS</span></code>: this is the number of different initial models we
want to managed.  Typically we only want 1, but some problems,
like <code class="docutils literal notranslate"><span class="pre">flame_wave</span></code> use 2, applied to different portions of the
domain.</p></li>
</ul>
</div></blockquote>
<p>The general form of the initial model is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># npts = 896</span>
<span class="c1"># num of variables = 6</span>
<span class="c1"># density</span>
<span class="c1"># temperature</span>
<span class="c1"># pressure</span>
<span class="c1"># carbon-12</span>
<span class="c1"># oxygen-16</span>
<span class="c1"># magnesium-24</span>
<span class="mf">195312.5000</span>  <span class="mf">5437711139.</span>  <span class="mf">8805500.952</span>   <span class="mf">.4695704813E+28</span>  <span class="mf">0.3</span>  <span class="mf">0.7</span>  <span class="mi">0</span>
<span class="mf">585937.5000</span>  <span class="mf">5410152416.</span>  <span class="mf">8816689.836</span>  <span class="mf">0.4663923963E+28</span>  <span class="mf">0.3</span>  <span class="mf">0.7</span>  <span class="mi">0</span>
</pre></div>
</div>
<p>The first line gives the number of points in the initial model, the
next gives the number of variables, followed by the variable names
(one per line), and then the data.  The data begins with the
coordinate and then the variables in the model, with one data point
per line.</p>
<p>When the model is read, the variables listed in the file are matched
to the ones that Castro knows about.  If the variable is recognized,
then it is stored in the model data, otherwise, it is ignored.</p>
<p>The data can then be mapped onto the grid using the <code class="docutils literal notranslate"><span class="pre">interpolate()</span></code>
function, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Real</span> <span class="n">dens</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">model</span><span class="p">::</span><span class="n">idens</span><span class="p">);</span>
</pre></div>
</div>
<p>This fills <code class="docutils literal notranslate"><span class="pre">dens</span></code> with the density at the position <code class="docutils literal notranslate"><span class="pre">height</span></code>.  In
addition to density, you can specify temperature (<code class="docutils literal notranslate"><span class="pre">model::itemp</span></code>),
pressure (<code class="docutils literal notranslate"><span class="pre">model::ipres</span></code>), species (indexed from <code class="docutils literal notranslate"><span class="pre">model::ispec</span></code>),
or an auxiliary quantity (indexed from <code class="docutils literal notranslate"><span class="pre">model::iaux</span></code>).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="timestepping.html" class="btn btn-neutral float-left" title="Timestepping and Retries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="io.html" class="btn btn-neutral float-right" title="Outputting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Castro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>