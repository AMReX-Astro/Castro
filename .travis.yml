dist: bionic

matrix:
  include:
    - language: python
      python:
        - "3.7-dev"
      before_install:
        - export PATH=$(echo $PATH | tr ':' "\n" | sed '/\/opt\/python/d' | tr "\n" ":" | sed "s|::|:|g")
      #  - pwd
      #  - cd ~/; git clone https://github.com/amrex-codes/amrex
      #  - cd ~/; git clone https://github.com/amrex-codes/regression_testing
      addons:
        apt:
            packages:
            - g++
            - gfortran
            - libgmp-dev
            - libmpfr-dev
            - pandoc
            - doxygen
      install:
        - pip install -r requirements.txt
      before_script:
        - export AMREX_HOME=~/amrex
      script:
        - ls -l
        - pwd
      # after_success:
        - ./deploy_docs.sh
      # deploy:
      #   provider: pages
      #   skip-cleanup: true
      #   github-token: $GITHUB_TOKEN
      #   keep-history: true
      #   on:
      #     branch: master

    - language: cpp
      compiler: 
        - clang
      before install:
        - cd ~/; git clone https://github.com/amrex-codes/amrex
        - cd ~/amrex; git checkout development
        - cd ~/; git clone https://github.com/starkiller-astro/Microphysics.git
        - cd ~/Microphysics; git checkout development
        - cd $TRAVIS_BUILD_DIR
      addons:
        apt:
          packages:
          - g++
          - gfortran
          - libgmp-dev
          - libmpfr-dev
      before_script:
        - export AMREX_HOME=~/amrex
        - export MICROPHYSICS_HOME=~/Microphysics
        - export CASTRO_HOME=$TRAVIS_BUILD_DIR
      script:
        - cd $TRAVIS_BUILD_DIR/Exec/science/flame_wave; scan-build -enable-checker security.FloatLoopCounter -enable-checker security.insecureAPI.UncheckedReturn make -j 2 
