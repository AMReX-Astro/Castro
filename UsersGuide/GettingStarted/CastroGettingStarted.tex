
\section{Downloading the Code}

CASTRO is built on top of the BoxLib framework.  In order to run CASTRO, you must download
two separate git modules.

\vspace{.1in}

\noindent First, make sure git is installed on your machine -- and we recommend version 1.7.x or higher.

\vspace{.1in}

\begin{enumerate}

\item Download the BoxLib repository by typing 

\noindent git clone https://ccse.lbl.gov/pub/Downloads/BoxLib.git 

\noindent This will create a directory called BoxLib on your machine.  Put this somewhere out of the way and 
set the environment variable, {\bf BOXLIB\_HOME}, on your machine to the path name where
you have put BoxLib.    You will want to periodically update BoxLib by typing 

\noindent git pull

in the BoxLib directory.  

\item Now download the CASTRO repository by typing 

\noindent git clone https://ccse.lbl.gov/pub/Downloads/Castro.git 

\end{enumerate}

%\clearpage

\section{Building the Code}

\begin{enumerate}

\item From the directory in which you checked out the Castro git repo, type

cd Castro/Exec/Sedov

This will put you into a directory in which you can run the Sedov problem in 1-d, 2-d or 3-d.
\item In Sedov, edit the GNUmakefile, and set

DIM = 2 (for example)

COMP = your favorite C++ compiler

FCOMP = your favorite Fortran compiler (which must compile F90)

DEBUG = FALSE

We like COMP = gcc and FCOMP = gfortran.  If you want to try other compilers and they don't work, 
please let us know.  

To build a serial (single-processor) code, set {\tt USE\_MPI = FALSE}.
This will compile the code without the MPI library.  If you want to do
a parallel run, then you would set {\tt USE\_MPI = TRUE}.  In this
case, the build system will need to know about your MPI installation.
This can be done by editing the makefiles in the BoxLib tree, but a
simple method is to set the shell environment variable {\tt
  BOXLIB\_USE\_MPI\_WRAPPERS=1}.  If this is set, then the build
system will fall back to using the local MPI compiler wrappers
(e.g.\ mpic++ and mpif90) to do the build.

\item Now type "make". The resulting executable will look something like 
"Castro2d.Linux.gcc.gfortran.ex", which means this is a 2-d version of the code, 
made on a Linux machine, with COMP = gcc and FCOMP = gfortran.

\end{enumerate}

\section{Running the Code}

\begin{enumerate}

\item Type "Castro2d.Linux.gcc.gfortran.ex inputs.2d.cyl\_in\_cartcoords" 
This will run the 2-d cylindrical Sedov problem in Cartesian (x-y coordinates). 
You can see other possible options, which should be clear by the names of the inputs files.

\item You will notice that running the code generates directories that look like 
plt00000, plt00020, etc, and chk00000, chk00020, etc. These are "plotfiles" and 
"checkpoint" files. The plotfiles are used for visualization, the checkpoint files are 
used for restarting the code.

\end{enumerate}

\section{Visualization of the Results}

\begin{enumerate}

\item To visualize the plotfiles, you can use a freely available visualization package
like VisIt, or you can try ``Amrvis.'' To get Amrvis, type

\noindent git clone https://ccse.lbl.gov/pub/Downloads/Amrvis.git 

\noindent Then cd into Amrvis, ddit the GNUmakefile there to set DIM = 2, and again set COMP and FCOMP to 
compilers that you have. Leave DEBUG = FALSE. Then type "make".  This will make an 
executable that looks like "amrvis2d...ex".

If you want to build amrvis with DIM = 3, you must first download and build volpack.  Type

\noindent git clone https://ccse.lbl.gov/pub/Downloads/volpack.git 

\noindent Then cd into volpack and type make.

\noindent Note: This requires the OSF/Motif libraries and headers. If you don't have these 
you will need to install the development version of motif through your package manager. 
lesstif gives some functionality and will allow you to build the amrvis executable, 
but amrvis will not run properly.

\noindent Note: On most Linux distributions, motif library is provided by the openmotif package, 
and its header files (like Xm.h) are provided by openmotif-devel. If those packages are not 
installed, then use the package management tool to install them, which varies from distribution 
to distribution, but is straightforward. I can provide detailed instructions if anyone needs them.

You may then want to create an alias to amrvis2d, for example

alias amrvis2d /tmp/Amrvis/amrvis2d...ex

\item Return to the Castro/Exec/Sedov directory. 
Type "amrvis2d plt00152" to see a single plotfile, or "amrvis2d -a plt*", 
which will animate the sequence of plotfiles. Try playing around with this -- note you can change which 
variable you are looking at, you can select a region and click "Dataset" (under View) in order to look at 
the actual numbers, etc. You can also export the pictures in several different formats -- under "File", see "Export".

Please know that we do have a number of conversion routines to other formats (such as matlab), 
but it is hard to describe them all. If you would like to display the data in another format, 
please let us know (again, asalmgren@lbl.gov) and we will point you to whatever we have that can help.

\end{enumerate}

You have now completed a brief introduction to CASTRO. 
